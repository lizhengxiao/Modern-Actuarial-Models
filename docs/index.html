<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>现代精算统计模型</title>
  <meta name="description" content="The output format is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="现代精算统计模型" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The output format is bookdown::gitbook." />
  <meta name="github-repo" content="sxpyggy/Modern-Actuarial-Models" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="现代精算统计模型" />
  
  <meta name="twitter:description" content="The output format is bookdown::gitbook." />
  

<meta name="author" content="Modern Actuarial Models" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  

<link rel="next" href="cnn.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>



<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">现代精算统计模型</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>👨‍🏫 欢迎</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#答疑"><i class="fa fa-check"></i>🤔 答疑</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#课程安排"><i class="fa fa-check"></i>🗓️ 课程安排</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="cnn.html"><a href="cnn.html"><i class="fa fa-check"></i><b>1</b> 卷积神经网络</a><ul>
<li class="chapter" data-level="1.1" data-path="cnn.html"><a href="cnn.html#基本组件"><i class="fa fa-check"></i><b>1.1</b> 基本组件</a><ul>
<li class="chapter" data-level="1.1.1" data-path="cnn.html"><a href="cnn.html#卷积层-convolution"><i class="fa fa-check"></i><b>1.1.1</b> 卷积层 (Convolution)</a></li>
<li class="chapter" data-level="1.1.2" data-path="cnn.html"><a href="cnn.html#池化层-pooling"><i class="fa fa-check"></i><b>1.1.2</b> 池化层 (Pooling)</a></li>
<li class="chapter" data-level="1.1.3" data-path="cnn.html"><a href="cnn.html#全连接层-dense"><i class="fa fa-check"></i><b>1.1.3</b> 全连接层 (Dense)</a></li>
<li class="chapter" data-level="1.1.4" data-path="cnn.html"><a href="cnn.html#批标准化层-batch-normalization"><i class="fa fa-check"></i><b>1.1.4</b> 批标准化层 (Batch Normalization)</a></li>
<li class="chapter" data-level="1.1.5" data-path="cnn.html"><a href="cnn.html#扁平化-flatten"><i class="fa fa-check"></i><b>1.1.5</b> 扁平化 (Flatten)</a></li>
<li class="chapter" data-level="1.1.6" data-path="cnn.html"><a href="cnn.html#输出神经元"><i class="fa fa-check"></i><b>1.1.6</b> 输出神经元</a></li>
<li class="chapter" data-level="1.1.7" data-path="cnn.html"><a href="cnn.html#激活函数-activation"><i class="fa fa-check"></i><b>1.1.7</b> 激活函数 (Activation)</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="cnn.html"><a href="cnn.html#特性"><i class="fa fa-check"></i><b>1.2</b> 特性</a><ul>
<li class="chapter" data-level="1.2.1" data-path="cnn.html"><a href="cnn.html#平移不变性-shift-invariant"><i class="fa fa-check"></i><b>1.2.1</b> 平移不变性 (Shift Invariant)</a></li>
<li class="chapter" data-level="1.2.2" data-path="cnn.html"><a href="cnn.html#旋转"><i class="fa fa-check"></i><b>1.2.2</b> 旋转</a></li>
<li class="chapter" data-level="1.2.3" data-path="cnn.html"><a href="cnn.html#尺度"><i class="fa fa-check"></i><b>1.2.3</b> 尺度</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="cnn.html"><a href="cnn.html#案例分析"><i class="fa fa-check"></i><b>1.3</b> 案例分析</a><ul>
<li class="chapter" data-level="1.3.1" data-path="cnn.html"><a href="cnn.html#human-mortality-database-hmd"><i class="fa fa-check"></i><b>1.3.1</b> <span>Human Mortality Database (HMD)</span></a></li>
<li class="chapter" data-level="1.3.2" data-path="cnn.html"><a href="cnn.html#mnist-dataset"><i class="fa fa-check"></i><b>1.3.2</b> MNIST dataset</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/sxpyggy/Modern-Actuarial-Models/tree/modern-actuarial-models" target="blank">GitHub 仓库</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">现代精算统计模型</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">现代精算统计模型</h1>
<p class="author"><em>Modern Actuarial Models</em></p>
<p class="date"><em>2021-01-10 16:52:16</em></p>
</div>
<div id="欢迎" class="section level1 unnumbered">
<h1>👨‍🏫 欢迎</h1>
<p>《现代精算统计模型》主要讲述如何使用统计学习和机器学习算法，提升传统的精算统计模型或者解决新的精算问题。这门课主要参考瑞士精算师协会发布的<a href="https://actuarialdatascience.org">“精算数据科学”</a>，该教程的主要目的是“为精算师提供一个对数据科学全面且易懂的介绍”，该教程提供了多篇方法性文章并开源代码，这样“读者可以相对容易地把这些数据科学方法用在自己的数据上”。</p>
<p>我们建议大家仔细阅读以下文献，尝试并理解<a href="https://github.com/JSchelldorfer/ActuarialDataScience">所有代码</a>。此网站将作为该课程的辅助，为大家答疑，总结文献，并对文献中的方法做扩展。该网站由授课老师高光远和助教张玮钰管理，欢迎大家反馈意见到助教、微信群、或邮箱 <a href="mailto:guangyuan.gao@ruc.edu.cn" class="email">guangyuan.gao@ruc.edu.cn</a>。</p>
<div id="答疑" class="section level2 unnumbered">
<h2>🤔 答疑</h2>
<p>我定期把同学们的普遍疑问在这里解答，欢迎提问！</p>
<p><strong>👉 Tensorflow for Apple M1</strong> (2020/12/23)</p>
<p>购买Apple M1的同学需要用这个<a href="https://github.com/apple/tensorflow_macos">pre-release tensorflow</a>，从pypi下载的tensorflow暂不支持Apple M1</p>
<p><strong>👉 NLP</strong> (2020/12/18)</p>
<p>数据</p>
<p><img src="plots/7/data.png" width="50%" style="display: block; margin: auto;" /></p>
<p>这个数据第<span class="math inline">\(i\)</span>行<span class="math inline">\(j\)</span>列表示，在第<span class="math inline">\(i\)</span>个评论中第<span class="math inline">\(j\)</span>个词的排名(依照总出现频率)，所以每一行还保持了句子中词语的先后顺序。每一行都是一个时间序列数据（样本）。</p>
<p>LSTM</p>
<p><img src="plots/7/lstm.png" width="50%"  style="display: block; margin: auto;" /></p>
<ul>
<li><p><code>input</code>维度是<code>batch size * length * 1</code>，即以上所示的.csv矩阵文档。</p></li>
<li><p><code>embedding_3</code> 作用就是把<code>input</code>的最后一个维度爆炸到256，参数个数为<code>vocab_size* embedding dimension</code>，可以看作把400个高频词映射到256维空间。</p></li>
<li><p><code>embedding_3</code>和<code>lstm_2</code>输出维度中，有两个<code>none</code>,其中第一个表示<code>batch size</code>, 第二个表示<code>sequence length</code>。因为LSTM在时间维度上循环使用参数，所以<code>sequence length</code>不影响参数的个数。</p></li>
<li><p><code>sequence length</code>不影响参数个数，对于不同的句子长度如100或者150，该模型都不需要调整，(应该)可以直接载入数据训练。</p></li>
<li><p><code>lstm_3</code> 只有一个<code>none</code>, 表示<code>batch size</code>, 我们要求<code>lstm_3</code>不返回整个sequence只看最近的状态。</p></li>
</ul>
<p><strong>👉 Reproducible results using Keras</strong> (2020/12/11)</p>
<p>使用Keras复现结果的方法。</p>
<p><a href="https://cran.r-project.org/web/packages/keras/vignettes/faq.html" class="uri">https://cran.r-project.org/web/packages/keras/vignettes/faq.html</a></p>
<p><img src="plots/reproducible.png" width="50%"  style="display: block; margin: auto;" /></p>
<p><strong>👉 为什么不直接用relu解决vanishing gradient 而设计复杂的lstm gru</strong> (2020/12/11)</p>
<ul>
<li><p>relu值域在0到无穷，不如tanh和sigmoid稳健，后两种可以认为把极大极小值都截断了。</p></li>
<li><p>relu是线性变换，可能描述不了非线性效应。我最常用tanh。</p></li>
<li><p>当然，使用relu会明显提升计算速度，因为relu的导数容易计算。</p></li>
</ul>
<p>另参见<a href="https://datascience.stackexchange.com/questions/61358/relu-for-combating-the-problem-of-vanishing-gradient-in-rnn#:~:text=For%20solving%20the%20problem%20of%20vanishing%20gradients%20in,In%20both%20of%20these%2C%20activation%20function%20is%20tanh.">stackexchange</a></p>
<p><strong>👉 xaringan</strong> (2020/12/06)</p>
<p>html格式的slides：
<a href="https://slides.yihui.org/xaringan/zh-CN.html#1" class="uri">https://slides.yihui.org/xaringan/zh-CN.html#1</a></p>
<p><strong>👉 samme.r</strong> (2020/11/27)</p>
<p>关于samme.r算法, 请参考下面文章中的exponential loss function.
<a href="https://web.stanford.edu/~hastie/Papers/samme.pdf" class="uri">https://web.stanford.edu/~hastie/Papers/samme.pdf</a></p>
<p>算法samme.r仅在以上draft中出现，正式发表时samme.r被删掉了，推测审稿人有异议。正式文章参考
<a href="http://ww.web.stanford.edu/~hastie/Papers/SII-2-3-A8-Zhu.pdf" class="uri">http://ww.web.stanford.edu/~hastie/Papers/SII-2-3-A8-Zhu.pdf</a></p>
<p><strong>👉 随机种子数</strong> (2020/11/20)</p>
<p>输入<code>RNGversion("3.5.0"); set.seed(100)</code>，使得你的随机种子数和paper的相同，模型结果相近。</p>
<p><strong>👉 MAC OS, Linux, WIN</strong> (2020/11/16)</p>
<p>据观察，在MAC OS和Linux系统下安装<code>keras</code>成功的比例较高。WIN系统下，Python各个包的依赖以及和R包的匹配有一定的问题，今天是通过更换镜像源解决了R中无法加载<code>tensorflow.keras</code>模块的问题，推测是TUNA源中WIN包依赖关系没有及时更新。</p>
<p>为了解决镜像源更新延迟、或者tensorflow版本过低的问题，这里共享WIN下经测试的<a href="https://www.jianguoyun.com/p/DcwPgUgQ3cTHBhi1-s0D">conda环境</a>配置。下载该文档，从该文档所在文件夹启动命令行，使用命令<code>conda env create --name &lt;env&gt; --file filename.yaml</code>，安装该conda环境。在R中使用<code>reticulate::use_condaenv("&lt;env&gt;",required=T)</code>关联该环境。</p>
<p>另外，可下载MAC OS系统下经测试的<a href="https://www.jianguoyun.com/p/DYethK4Q3cTHBhjr4s0D">conda环境</a>配置。可通过<code>conda env create --name &lt;env&gt; --file filename.yaml</code>安装。</p>
<p><strong>👉 CASdatasets</strong> (2020/11/13)</p>
<p>源文件在<a href="http://cas.uqam.ca/" class="uri">http://cas.uqam.ca/</a>，但下载速度很慢，我把它放在<a href="https://www.jianguoyun.com/p/DdFyh74Q3cTHBhio2M0D">坚果云共享</a>。下载后选择install from local archive file。</p>
<p><strong>👉 微信群</strong> (2020/11/08)</p>
<p><img src="plots/wechat.png" width="30%"  style="display: block; margin: auto;" /></p>
</div>
<div id="课程安排" class="section level2 unnumbered">
<h2>🗓️ 课程安排</h2>
<p><img src="plots/plan.png" width="90%"  style="display: block; margin: auto;" /></p>
<p>以下安排为初步计划，根据大家的需求和背景，我们可能要花更多的时间在某些重要的方法及其在精算上的应用。</p>
<ul>
<li><p>第10周：</p>
<p>准备工作。</p></li>
<li><p>第11周:</p>
<p>1 - French Motor Third-Party Liability Claims</p>
<p><a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3164764" class="uri">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3164764</a></p></li>
<li><p>机动</p>
<p>2 - Inisghts from Inside Neural Networks</p>
<p><a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3226852" class="uri">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3226852</a></p>
<p>3 - Nesting Classical Actuarial Models into Neural Networks</p>
<p><a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3320525" class="uri">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3320525</a></p></li>
<li><p>第12周：</p>
<p>4 - On Boosting: Theory and Applications</p>
<p><a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3402687" class="uri">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3402687</a></p></li>
<li><p>第13周：</p>
<p>5 - Unsupervised Learning: What is a Sports Car</p>
<p><a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3439358" class="uri">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3439358</a></p></li>
<li><p>第14周：</p>
<p>6 - Lee and Carter go Machine Learning: Recurrent Neural Networks</p>
<p><a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3441030" class="uri">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3441030</a></p></li>
<li><p>第15周：</p>
<p>7 - The Art of Natural Language Processing: Classical, Modern and Contemporary Approaches to Text Document Classification</p>
<p><a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3547887" class="uri">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3547887</a></p></li>
<li><p>第16周：</p>
<p>8 - Peeking into the Black Box: An Actuarial Case Study for Interpretable Machine Learning</p>
<p><a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3595944" class="uri">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3595944</a></p></li>
<li><p>第17周：</p>
<p>9 - Convolutional neural network case studies: (1) Anomalies in Mortality Rates (2) Image Recognition</p>
<p><a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3656210" class="uri">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3656210</a></p></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="cnn.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": "github"
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "fixed"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
