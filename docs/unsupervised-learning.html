<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 æ— ç›‘ç£å­¦ä¹ æ–¹æ³• | ç°ä»£ç²¾ç®—ç»Ÿè®¡æ¨¡å‹</title>
  <meta name="description" content="The output format is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="5 æ— ç›‘ç£å­¦ä¹ æ–¹æ³• | ç°ä»£ç²¾ç®—ç»Ÿè®¡æ¨¡å‹" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The output format is bookdown::gitbook." />
  <meta name="github-repo" content="sxpyggy/Modern-Actuarial-Models" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 æ— ç›‘ç£å­¦ä¹ æ–¹æ³• | ç°ä»£ç²¾ç®—ç»Ÿè®¡æ¨¡å‹" />
  
  <meta name="twitter:description" content="The output format is bookdown::gitbook." />
  

<meta name="author" content="Modern Actuarial Models" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="boosting.html"/>
<link rel="next" href="rnn.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ç°ä»£ç²¾ç®—ç»Ÿè®¡æ¨¡å‹</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>ğŸ‘¨â€ğŸ« æ¬¢è¿</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ç­”ç–‘"><i class="fa fa-check"></i>ğŸ¤” ç­”ç–‘</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#è¯¾ç¨‹å®‰æ’"><i class="fa fa-check"></i>ğŸ—“ï¸ è¯¾ç¨‹å®‰æ’</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i>ç®€ä»‹</a></li>
<li class="chapter" data-level="1" data-path="pre.html"><a href="pre.html"><i class="fa fa-check"></i><b>1</b> å‡†å¤‡å·¥ä½œ</a><ul>
<li class="chapter" data-level="1.1" data-path="pre.html"><a href="pre.html#å¸¸ç”¨é“¾æ¥"><i class="fa fa-check"></i><b>1.1</b> å¸¸ç”¨é“¾æ¥</a></li>
<li class="chapter" data-level="1.2" data-path="pre.html"><a href="pre.html#å…‹éš†ä»£ç "><i class="fa fa-check"></i><b>1.2</b> å…‹éš†ä»£ç </a></li>
<li class="chapter" data-level="1.3" data-path="pre.html"><a href="pre.html#r-interface-to-keras"><i class="fa fa-check"></i><b>1.3</b> R interface to Keras</a><ul>
<li class="chapter" data-level="1.3.1" data-path="pre.html"><a href="pre.html#rè‡ªåŠ¨å®‰è£…"><i class="fa fa-check"></i><b>1.3.1</b> Rè‡ªåŠ¨å®‰è£…</a></li>
<li class="chapter" data-level="1.3.2" data-path="pre.html"><a href="pre.html#ä½¿ç”¨reticulateå…³è”condaç¯å¢ƒ"><i class="fa fa-check"></i><b>1.3.2</b> ä½¿ç”¨reticulateå…³è”condaç¯å¢ƒ</a></li>
<li class="chapter" data-level="1.3.3" data-path="pre.html"><a href="pre.html#æŒ‡å®šcondaå®‰è£…"><i class="fa fa-check"></i><b>1.3.3</b> æŒ‡å®šcondaå®‰è£…</a></li>
<li class="chapter" data-level="1.3.4" data-path="pre.html"><a href="pre.html#ä½¿ç”¨reticulateå®‰è£…"><i class="fa fa-check"></i><b>1.3.4</b> ä½¿ç”¨reticulateå®‰è£…</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="pre.html"><a href="pre.html#r-interface-to-python"><i class="fa fa-check"></i><b>1.4</b> R interface to Python</a><ul>
<li class="chapter" data-level="1.4.1" data-path="pre.html"><a href="pre.html#reticulate-å¸¸è§å‘½ä»¤"><i class="fa fa-check"></i><b>1.4.1</b> reticulate å¸¸è§å‘½ä»¤</a></li>
<li class="chapter" data-level="1.4.2" data-path="pre.html"><a href="pre.html#åˆ‡æ¢rå…³è”çš„condaç¯å¢ƒ"><i class="fa fa-check"></i><b>1.4.2</b> åˆ‡æ¢Rå…³è”çš„condaç¯å¢ƒ</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="pre.html"><a href="pre.html#python"><i class="fa fa-check"></i><b>1.5</b> Python</a><ul>
<li class="chapter" data-level="1.5.1" data-path="pre.html"><a href="pre.html#condaç¯å¢ƒ"><i class="fa fa-check"></i><b>1.5.1</b> Condaç¯å¢ƒ</a></li>
<li class="chapter" data-level="1.5.2" data-path="pre.html"><a href="pre.html#å¸¸ç”¨çš„condaå‘½ä»¤"><i class="fa fa-check"></i><b>1.5.2</b> å¸¸ç”¨çš„Condaå‘½ä»¤</a></li>
<li class="chapter" data-level="1.5.3" data-path="pre.html"><a href="pre.html#tensorflowpytorch-gpu-version"><i class="fa fa-check"></i><b>1.5.3</b> Tensorflow/Pytorch GPU version</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="french.html"><a href="french.html"><i class="fa fa-check"></i><b>2</b> è½¦é™©ç´¢èµ”é¢‘ç‡é¢„æµ‹</a><ul>
<li class="chapter" data-level="2.1" data-path="french.html"><a href="french.html#èƒŒæ™¯ä»‹ç»"><i class="fa fa-check"></i><b>2.1</b> èƒŒæ™¯ä»‹ç»</a></li>
<li class="chapter" data-level="2.2" data-path="french.html"><a href="french.html#é¢„æµ‹æ¨¡å‹æ¦‚è¿°"><i class="fa fa-check"></i><b>2.2</b> é¢„æµ‹æ¨¡å‹æ¦‚è¿°</a></li>
<li class="chapter" data-level="2.3" data-path="french.html"><a href="french.html#ç‰¹å¾å·¥ç¨‹"><i class="fa fa-check"></i><b>2.3</b> ç‰¹å¾å·¥ç¨‹</a><ul>
<li class="chapter" data-level="2.3.1" data-path="french.html"><a href="french.html#æˆªæ–­"><i class="fa fa-check"></i><b>2.3.1</b> æˆªæ–­</a></li>
<li class="chapter" data-level="2.3.2" data-path="french.html"><a href="french.html#ç¦»æ•£åŒ–"><i class="fa fa-check"></i><b>2.3.2</b> ç¦»æ•£åŒ–</a></li>
<li class="chapter" data-level="2.3.3" data-path="french.html"><a href="french.html#è®¾å®šåŸºç¡€æ°´å¹³"><i class="fa fa-check"></i><b>2.3.3</b> è®¾å®šåŸºç¡€æ°´å¹³</a></li>
<li class="chapter" data-level="2.3.4" data-path="french.html"><a href="french.html#åå˜é‡å˜å½¢"><i class="fa fa-check"></i><b>2.3.4</b> åå˜é‡å˜å½¢</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="french.html"><a href="french.html#è®­ç»ƒé›†-éªŒè¯é›†-æµ‹è¯•é›†"><i class="fa fa-check"></i><b>2.4</b> è®­ç»ƒé›†-éªŒè¯é›†-æµ‹è¯•é›†</a></li>
<li class="chapter" data-level="2.5" data-path="french.html"><a href="french.html#æ³Šæ¾åå·®æŸå¤±å‡½æ•°"><i class="fa fa-check"></i><b>2.5</b> æ³Šæ¾åå·®æŸå¤±å‡½æ•°</a></li>
<li class="chapter" data-level="2.6" data-path="french.html"><a href="french.html#æ³Šæ¾å›å½’æ¨¡å‹"><i class="fa fa-check"></i><b>2.6</b> æ³Šæ¾å›å½’æ¨¡å‹</a></li>
<li class="chapter" data-level="2.7" data-path="french.html"><a href="french.html#æ³Šæ¾å¯åŠ æ¨¡å‹"><i class="fa fa-check"></i><b>2.7</b> æ³Šæ¾å¯åŠ æ¨¡å‹</a></li>
<li class="chapter" data-level="2.8" data-path="french.html"><a href="french.html#æ³Šæ¾å›å½’æ ‘"><i class="fa fa-check"></i><b>2.8</b> æ³Šæ¾å›å½’æ ‘</a></li>
<li class="chapter" data-level="2.9" data-path="french.html"><a href="french.html#éšæœºæ£®æ—"><i class="fa fa-check"></i><b>2.9</b> éšæœºæ£®æ—</a></li>
<li class="chapter" data-level="2.10" data-path="french.html"><a href="french.html#æ³Šæ¾æå‡æ ‘"><i class="fa fa-check"></i><b>2.10</b> æ³Šæ¾æå‡æ ‘</a></li>
<li class="chapter" data-level="2.11" data-path="french.html"><a href="french.html#æ¨¡å‹æ¯”è¾ƒ"><i class="fa fa-check"></i><b>2.11</b> æ¨¡å‹æ¯”è¾ƒ</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="nn.html"><a href="nn.html"><i class="fa fa-check"></i><b>3</b> ç¥ç»ç½‘ç»œ</a><ul>
<li class="chapter" data-level="3.1" data-path="nn.html"><a href="nn.html#å»ºç«‹ç¥ç»ç½‘ç»œçš„ä¸€èˆ¬æ­¥éª¤"><i class="fa fa-check"></i><b>3.1</b> å»ºç«‹ç¥ç»ç½‘ç»œçš„ä¸€èˆ¬æ­¥éª¤</a><ul>
<li class="chapter" data-level="3.1.1" data-path="nn.html"><a href="nn.html#æ˜ç¡®ç›®æ ‡å’Œæ•°æ®ç±»å‹"><i class="fa fa-check"></i><b>3.1.1</b> æ˜ç¡®ç›®æ ‡å’Œæ•°æ®ç±»å‹</a></li>
<li class="chapter" data-level="3.1.2" data-path="nn.html"><a href="nn.html#æ•°æ®é¢„å¤„ç†"><i class="fa fa-check"></i><b>3.1.2</b> æ•°æ®é¢„å¤„ç†</a></li>
<li class="chapter" data-level="3.1.3" data-path="nn.html"><a href="nn.html#é€‰å–åˆé€‚çš„ç¥ç»ç½‘ç»œç±»å‹"><i class="fa fa-check"></i><b>3.1.3</b> é€‰å–åˆé€‚çš„ç¥ç»ç½‘ç»œç±»å‹</a></li>
<li class="chapter" data-level="3.1.4" data-path="nn.html"><a href="nn.html#å»ºç«‹ç¥ç»ç½‘ç»œå…¨è¿æ¥ç¥ç»ç½‘ç»œ"><i class="fa fa-check"></i><b>3.1.4</b> å»ºç«‹ç¥ç»ç½‘ç»œï¼ˆå…¨è¿æ¥ç¥ç»ç½‘ç»œï¼‰</a></li>
<li class="chapter" data-level="3.1.5" data-path="nn.html"><a href="nn.html#è®­ç»ƒç¥ç»ç½‘ç»œ"><i class="fa fa-check"></i><b>3.1.5</b> è®­ç»ƒç¥ç»ç½‘ç»œ</a></li>
<li class="chapter" data-level="3.1.6" data-path="nn.html"><a href="nn.html#è°ƒå‚"><i class="fa fa-check"></i><b>3.1.6</b> è°ƒå‚</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="nn.html"><a href="nn.html#æ•°æ®é¢„å¤„ç†-1"><i class="fa fa-check"></i><b>3.2</b> æ•°æ®é¢„å¤„ç†</a></li>
<li class="chapter" data-level="3.3" data-path="nn.html"><a href="nn.html#ç¥ç»ç½‘ç»œæå‡æ¨¡å‹-combined-actuarial-neural-network"><i class="fa fa-check"></i><b>3.3</b> ç¥ç»ç½‘ç»œæå‡æ¨¡å‹ ï¼ˆcombined actuarial neural networkï¼‰</a></li>
<li class="chapter" data-level="3.4" data-path="nn.html"><a href="nn.html#ç¥ç»ç½‘ç»œç»“æ„"><i class="fa fa-check"></i><b>3.4</b> ç¥ç»ç½‘ç»œç»“æ„</a><ul>
<li class="chapter" data-level="3.4.1" data-path="nn.html"><a href="nn.html#ç»“æ„å‚æ•°"><i class="fa fa-check"></i><b>3.4.1</b> ç»“æ„å‚æ•°</a></li>
<li class="chapter" data-level="3.4.2" data-path="nn.html"><a href="nn.html#è¾“å…¥å±‚"><i class="fa fa-check"></i><b>3.4.2</b> è¾“å…¥å±‚</a></li>
<li class="chapter" data-level="3.4.3" data-path="nn.html"><a href="nn.html#embedding-layer"><i class="fa fa-check"></i><b>3.4.3</b> Embedding layer</a></li>
<li class="chapter" data-level="3.4.4" data-path="nn.html"><a href="nn.html#éšè—å±‚"><i class="fa fa-check"></i><b>3.4.4</b> éšè—å±‚</a></li>
<li class="chapter" data-level="3.4.5" data-path="nn.html"><a href="nn.html#è¾“å‡ºå±‚"><i class="fa fa-check"></i><b>3.4.5</b> è¾“å‡ºå±‚</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="nn.html"><a href="nn.html#è®­ç»ƒç¥ç»ç½‘ç»œ-1"><i class="fa fa-check"></i><b>3.5</b> è®­ç»ƒç¥ç»ç½‘ç»œ</a></li>
<li class="chapter" data-level="3.6" data-path="nn.html"><a href="nn.html#æ€»ç»“"><i class="fa fa-check"></i><b>3.6</b> æ€»ç»“</a></li>
<li class="chapter" data-level="3.7" data-path="nn.html"><a href="nn.html#å…¶å®ƒæ¨¡å‹"><i class="fa fa-check"></i><b>3.7</b> å…¶å®ƒæ¨¡å‹</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="boosting.html"><a href="boosting.html"><i class="fa fa-check"></i><b>4</b> æå‡æ–¹æ³• (Boosting)</a><ul>
<li class="chapter" data-level="4.1" data-path="boosting.html"><a href="boosting.html#adaboost"><i class="fa fa-check"></i><b>4.1</b> AdaBoost</a></li>
<li class="chapter" data-level="4.2" data-path="boosting.html"><a href="boosting.html#logit-boost-real-discrete-gentle-adaboost"><i class="fa fa-check"></i><b>4.2</b> Logit Boost (real, discrete, gentle AdaBoost)</a></li>
<li class="chapter" data-level="4.3" data-path="boosting.html"><a href="boosting.html#adaboost.m1"><i class="fa fa-check"></i><b>4.3</b> AdaBoost.M1</a></li>
<li class="chapter" data-level="4.4" data-path="boosting.html"><a href="boosting.html#samme-stage-wise-additive-modeling-using-a-multi-class-exponential-loss-function"><i class="fa fa-check"></i><b>4.4</b> SAMME (Stage-wise Additive Modeling using a Multi-class Exponential loss function)</a></li>
<li class="chapter" data-level="4.5" data-path="boosting.html"><a href="boosting.html#samme.r-multi-class-real-adaboost"><i class="fa fa-check"></i><b>4.5</b> SAMME.R (multi-class real AdaBoost)</a></li>
<li class="chapter" data-level="4.6" data-path="boosting.html"><a href="boosting.html#gradient-boosting"><i class="fa fa-check"></i><b>4.6</b> Gradient Boosting</a></li>
<li class="chapter" data-level="4.7" data-path="boosting.html"><a href="boosting.html#newton-boosting"><i class="fa fa-check"></i><b>4.7</b> Newton Boosting</a></li>
<li class="chapter" data-level="4.8" data-path="boosting.html"><a href="boosting.html#xgboost"><i class="fa fa-check"></i><b>4.8</b> XGBoost</a></li>
<li class="chapter" data-level="4.9" data-path="boosting.html"><a href="boosting.html#case-study"><i class="fa fa-check"></i><b>4.9</b> Case study</a><ul>
<li class="chapter" data-level="4.9.1" data-path="boosting.html"><a href="boosting.html#æ•°æ®æè¿°"><i class="fa fa-check"></i><b>4.9.1</b> æ•°æ®æè¿°</a></li>
<li class="chapter" data-level="4.9.2" data-path="boosting.html"><a href="boosting.html#æ•°æ®é¢„å¤„ç†-2"><i class="fa fa-check"></i><b>4.9.2</b> æ•°æ®é¢„å¤„ç†</a></li>
<li class="chapter" data-level="4.9.3" data-path="boosting.html"><a href="boosting.html#ç‰¹å¾å·¥ç¨‹-1"><i class="fa fa-check"></i><b>4.9.3</b> ç‰¹å¾å·¥ç¨‹</a></li>
<li class="chapter" data-level="4.9.4" data-path="boosting.html"><a href="boosting.html#å»ºæ¨¡æµç¨‹"><i class="fa fa-check"></i><b>4.9.4</b> å»ºæ¨¡æµç¨‹</a></li>
<li class="chapter" data-level="4.9.5" data-path="boosting.html"><a href="boosting.html#æ¨¡å‹åº¦é‡giniç³»æ•°"><i class="fa fa-check"></i><b>4.9.5</b> æ¨¡å‹åº¦é‡â€”â€”Giniç³»æ•°</a></li>
<li class="chapter" data-level="4.9.6" data-path="boosting.html"><a href="boosting.html#å»ºç«‹adaboostæ¨¡å‹"><i class="fa fa-check"></i><b>4.9.6</b> å»ºç«‹AdaBoostæ¨¡å‹</a></li>
<li class="chapter" data-level="4.9.7" data-path="boosting.html"><a href="boosting.html#å»ºç«‹xgboostæ¨¡å‹"><i class="fa fa-check"></i><b>4.9.7</b> å»ºç«‹XGBoostæ¨¡å‹</a></li>
<li class="chapter" data-level="4.9.8" data-path="boosting.html"><a href="boosting.html#ç»“è®º"><i class="fa fa-check"></i><b>4.9.8</b> ç»“è®º</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="boosting.html"><a href="boosting.html#appendix-commonly-used-python-code-for-py-beginners"><i class="fa fa-check"></i><b>4.10</b> Appendix: Commonly used Python code (for py-beginners)</a><ul>
<li class="chapter" data-level="4.10.1" data-path="boosting.html"><a href="boosting.html#pythonæ ‡å‡†æ•°æ®ç±»å‹"><i class="fa fa-check"></i><b>4.10.1</b> Pythonæ ‡å‡†æ•°æ®ç±»å‹</a></li>
<li class="chapter" data-level="4.10.2" data-path="boosting.html"><a href="boosting.html#pythonå†…ç½®å‡½æ•°"><i class="fa fa-check"></i><b>4.10.2</b> Pythonå†…ç½®å‡½æ•°</a></li>
<li class="chapter" data-level="4.10.3" data-path="boosting.html"><a href="boosting.html#numpyåŒ…"><i class="fa fa-check"></i><b>4.10.3</b> numpyåŒ…</a></li>
<li class="chapter" data-level="4.10.4" data-path="boosting.html"><a href="boosting.html#pandasåŒ…"><i class="fa fa-check"></i><b>4.10.4</b> pandasåŒ…</a></li>
<li class="chapter" data-level="4.10.5" data-path="boosting.html"><a href="boosting.html#matplotlibåŒ…"><i class="fa fa-check"></i><b>4.10.5</b> MatplotlibåŒ…</a></li>
<li class="chapter" data-level="4.10.6" data-path="boosting.html"><a href="boosting.html#å¸¸ç”¨æ•™ç¨‹ç½‘å€"><i class="fa fa-check"></i><b>4.10.6</b> å¸¸ç”¨æ•™ç¨‹ç½‘å€</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html"><i class="fa fa-check"></i><b>5</b> æ— ç›‘ç£å­¦ä¹ æ–¹æ³•</a><ul>
<li class="chapter" data-level="5.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#æ•°æ®é¢„å¤„ç†-3"><i class="fa fa-check"></i><b>5.1</b> æ•°æ®é¢„å¤„ç†</a></li>
<li class="chapter" data-level="5.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#ä¸»æˆåˆ†åˆ†æ"><i class="fa fa-check"></i><b>5.2</b> ä¸»æˆåˆ†åˆ†æ</a></li>
<li class="chapter" data-level="5.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#è‡ªç¼–ç "><i class="fa fa-check"></i><b>5.3</b> è‡ªç¼–ç </a><ul>
<li class="chapter" data-level="5.3.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#æ¨¡å‹è®­ç»ƒ"><i class="fa fa-check"></i><b>5.3.1</b> æ¨¡å‹è®­ç»ƒ</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#k-means-clustering"><i class="fa fa-check"></i><b>5.4</b> K-means clustering</a></li>
<li class="chapter" data-level="5.5" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#k-medoids-clustering-pam"><i class="fa fa-check"></i><b>5.5</b> K-medoids clustering (PAM)</a></li>
<li class="chapter" data-level="5.6" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#gaussian-mixture-modelsgmms"><i class="fa fa-check"></i><b>5.6</b> Gaussian mixture models(GMMs)</a></li>
<li class="chapter" data-level="5.7" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#ä¸‰ç§èšç±»æ–¹æ³•è¯„ä»·"><i class="fa fa-check"></i><b>5.7</b> ä¸‰ç§èšç±»æ–¹æ³•è¯„ä»·</a></li>
<li class="chapter" data-level="5.8" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#t-sne"><i class="fa fa-check"></i><b>5.8</b> t-SNE</a></li>
<li class="chapter" data-level="5.9" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#umap"><i class="fa fa-check"></i><b>5.9</b> UMAP</a></li>
<li class="chapter" data-level="5.10" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#som"><i class="fa fa-check"></i><b>5.10</b> SOM</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="rnn.html"><a href="rnn.html"><i class="fa fa-check"></i><b>6</b> å¾ªç¯ç¥ç»ç½‘ç»œä¸æ­»äº¡ç‡é¢„æµ‹</a><ul>
<li class="chapter" data-level="6.1" data-path="rnn.html"><a href="rnn.html#lee-carter-model"><i class="fa fa-check"></i><b>6.1</b> Lee-Carter Model</a></li>
<li class="chapter" data-level="6.2" data-path="rnn.html"><a href="rnn.html#æ™®é€šå¾ªç¯ç¥ç»ç½‘ç»œrecurrent-neural-network"><i class="fa fa-check"></i><b>6.2</b> æ™®é€šå¾ªç¯ç¥ç»ç½‘ç»œï¼ˆrecurrent neural networkï¼‰</a></li>
<li class="chapter" data-level="6.3" data-path="rnn.html"><a href="rnn.html#é•¿çŸ­æœŸè®°å¿†ç¥ç»ç½‘ç»œlong-short-term-memory"><i class="fa fa-check"></i><b>6.3</b> é•¿çŸ­æœŸè®°å¿†ç¥ç»ç½‘ç»œï¼ˆLong short-term memoryï¼‰</a><ul>
<li class="chapter" data-level="6.3.1" data-path="rnn.html"><a href="rnn.html#æ¿€æ´»å‡½æ•°activation-functions"><i class="fa fa-check"></i><b>6.3.1</b> æ¿€æ´»å‡½æ•°ï¼ˆActivation functionsï¼‰</a></li>
<li class="chapter" data-level="6.3.2" data-path="rnn.html"><a href="rnn.html#gates-and-cell-state"><i class="fa fa-check"></i><b>6.3.2</b> Gates and cell state</a></li>
<li class="chapter" data-level="6.3.3" data-path="rnn.html"><a href="rnn.html#output-function"><i class="fa fa-check"></i><b>6.3.3</b> Output Function</a></li>
<li class="chapter" data-level="6.3.4" data-path="rnn.html"><a href="rnn.html#time-distributed-layer"><i class="fa fa-check"></i><b>6.3.4</b> Time-distributed Layer</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="rnn.html"><a href="rnn.html#é—¨æ§å¾ªç¯ç¥ç»ç½‘ç»œgated-recurrent-unit"><i class="fa fa-check"></i><b>6.4</b> é—¨æ§å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆGated Recurrent Unitï¼‰</a><ul>
<li class="chapter" data-level="6.4.1" data-path="rnn.html"><a href="rnn.html#gates"><i class="fa fa-check"></i><b>6.4.1</b> Gates</a></li>
<li class="chapter" data-level="6.4.2" data-path="rnn.html"><a href="rnn.html#neuron-activations"><i class="fa fa-check"></i><b>6.4.2</b> Neuron Activations</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="rnn.html"><a href="rnn.html#æ¡ˆä¾‹åˆ†æcase-study"><i class="fa fa-check"></i><b>6.5</b> æ¡ˆä¾‹åˆ†æï¼ˆCase studyï¼‰</a><ul>
<li class="chapter" data-level="6.5.1" data-path="rnn.html"><a href="rnn.html#æ•°æ®æè¿°-1"><i class="fa fa-check"></i><b>6.5.1</b> æ•°æ®æè¿°</a></li>
<li class="chapter" data-level="6.5.2" data-path="rnn.html"><a href="rnn.html#æ­»äº¡ç‡çƒ­åŠ›å›¾"><i class="fa fa-check"></i><b>6.5.2</b> æ­»äº¡ç‡çƒ­åŠ›å›¾</a></li>
<li class="chapter" data-level="6.5.3" data-path="rnn.html"><a href="rnn.html#lee-carter-æ¨¡å‹"><i class="fa fa-check"></i><b>6.5.3</b> Lee-Carter æ¨¡å‹</a></li>
<li class="chapter" data-level="6.5.4" data-path="rnn.html"><a href="rnn.html#åˆè¯•rnn"><i class="fa fa-check"></i><b>6.5.4</b> åˆè¯•RNN</a></li>
<li class="chapter" data-level="6.5.5" data-path="rnn.html"><a href="rnn.html#rnn-1"><i class="fa fa-check"></i><b>6.5.5</b> RNN</a></li>
<li class="chapter" data-level="6.5.6" data-path="rnn.html"><a href="rnn.html#å¼•å…¥æ€§åˆ«åå˜é‡"><i class="fa fa-check"></i><b>6.5.6</b> å¼•å…¥æ€§åˆ«åå˜é‡</a></li>
<li class="chapter" data-level="6.5.7" data-path="rnn.html"><a href="rnn.html#ç¨³å¥æ€§"><i class="fa fa-check"></i><b>6.5.7</b> ç¨³å¥æ€§</a></li>
<li class="chapter" data-level="6.5.8" data-path="rnn.html"><a href="rnn.html#é¢„æµ‹ç»“æœå›¾"><i class="fa fa-check"></i><b>6.5.8</b> é¢„æµ‹ç»“æœå›¾</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="nlp.html"><a href="nlp.html"><i class="fa fa-check"></i><b>7</b> è‡ªç„¶è¯­è¨€å¤„ç†</a><ul>
<li class="chapter" data-level="7.1" data-path="nlp.html"><a href="nlp.html#é¢„å¤„ç†"><i class="fa fa-check"></i><b>7.1</b> é¢„å¤„ç†</a></li>
<li class="chapter" data-level="7.2" data-path="nlp.html"><a href="nlp.html#bag-of-words"><i class="fa fa-check"></i><b>7.2</b> Bag of words</a></li>
<li class="chapter" data-level="7.3" data-path="nlp.html"><a href="nlp.html#bag-of-part-of-speech"><i class="fa fa-check"></i><b>7.3</b> Bag of part-of-speech</a></li>
<li class="chapter" data-level="7.4" data-path="nlp.html"><a href="nlp.html#word-embeddings"><i class="fa fa-check"></i><b>7.4</b> Word embeddings</a><ul>
<li class="chapter" data-level="7.4.1" data-path="nlp.html"><a href="nlp.html#neural-probabilistic-language-model"><i class="fa fa-check"></i><b>7.4.1</b> Neural probabilistic language model</a></li>
<li class="chapter" data-level="7.4.2" data-path="nlp.html"><a href="nlp.html#word2vec"><i class="fa fa-check"></i><b>7.4.2</b> word2vec</a></li>
<li class="chapter" data-level="7.4.3" data-path="nlp.html"><a href="nlp.html#global-vectors-for-word-representation"><i class="fa fa-check"></i><b>7.4.3</b> Global vectors for word representation</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="nlp.html"><a href="nlp.html#pre-trained-word-embeddings"><i class="fa fa-check"></i><b>7.5</b> Pre-trained word embeddings</a></li>
<li class="chapter" data-level="7.6" data-path="nlp.html"><a href="nlp.html#ç¥ç»ç½‘ç»œ"><i class="fa fa-check"></i><b>7.6</b> ç¥ç»ç½‘ç»œ</a><ul>
<li class="chapter" data-level="7.6.1" data-path="nlp.html"><a href="nlp.html#lstm"><i class="fa fa-check"></i><b>7.6.1</b> LSTM</a></li>
<li class="chapter" data-level="7.6.2" data-path="nlp.html"><a href="nlp.html#gru"><i class="fa fa-check"></i><b>7.6.2</b> GRU</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="nlp.html"><a href="nlp.html#case-study-1"><i class="fa fa-check"></i><b>7.7</b> Case study</a><ul>
<li class="chapter" data-level="7.7.1" data-path="nlp.html"><a href="nlp.html#å‡½æ•°è¯´æ˜"><i class="fa fa-check"></i><b>7.7.1</b> å‡½æ•°è¯´æ˜</a></li>
<li class="chapter" data-level="7.7.2" data-path="nlp.html"><a href="nlp.html#å¯èƒ½é‡åˆ°çš„é—®é¢˜"><i class="fa fa-check"></i><b>7.7.2</b> å¯èƒ½é‡åˆ°çš„é—®é¢˜</a></li>
<li class="chapter" data-level="7.7.3" data-path="nlp.html"><a href="nlp.html#ç»“æœæ¯”è¾ƒ"><i class="fa fa-check"></i><b>7.7.3</b> ç»“æœæ¯”è¾ƒ</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="nlp.html"><a href="nlp.html#ç»“è®º-1"><i class="fa fa-check"></i><b>7.8</b> ç»“è®º</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/sxpyggy/Modern-Actuarial-Models/tree/modern-actuarial-models" target="blank">GitHub ä»“åº“</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ç°ä»£ç²¾ç®—ç»Ÿè®¡æ¨¡å‹</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="unsupervised-learning" class="section level1">
<h1><span class="header-section-number">5</span> æ— ç›‘ç£å­¦ä¹ æ–¹æ³•</h1>
<p><em>æ¢è¯‘ä¸­ã€æ–¹æ˜æ…§ã€ç‹æ™—ã€é«˜å…‰è¿œ</em></p>
<p>å¤§å­¦åŠä»¥åç”Ÿæ´»ä¸­æœ€å¸¸ç”¨çš„å­¦ä¹ æ–¹æ³•ã€‚</p>
<p>åœ¨æ— ç›‘ç£å­¦ä¹ ä¸­ï¼Œ æˆ‘ä»¬å¯ä»¥é™ä½æ•°æ®ï¼ˆåå˜é‡ï¼Œç‰¹å¾ï¼‰ç»´åº¦ã€æ ¹æ®ç‰¹å¾çš„ç›¸ä¼¼åº¦å¯¹æ ·æœ¬è¿›è¡Œèšç±»ã€è®¾è®¡å¯è§†åŒ–å·¥å…·æ­ç¤ºé«˜ç»´æ•°æ®çš„ç‰¹æ€§ã€‚æ— ç›‘ç£å­¦ä¹ ä¸è€ƒè™‘å“åº”å˜é‡ï¼Œä»…è€ƒè™‘ç‰¹å¾çš„ç›¸ä¼¼æ€§ã€‚</p>
<p>æœ¬ç« å°†è€ƒè™‘ä»¥ä¸‹å‡ ç§æ–¹æ³•ï¼š</p>
<ul>
<li><p><strong>é™ç»´</strong>ï¼š</p>
<ul>
<li><p>ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰</p></li>
<li><p>è‡ªç¼–ç ï¼Œç“¶é¢ˆç¥ç»ç½‘ç»œï¼ˆBNNï¼‰</p></li>
</ul></li>
<li><p><strong>èšç±»</strong>ï¼š</p>
<ul>
<li><p>åˆ†å±‚èšç±»ï¼šä¸éœ€äº‹å…ˆæŒ‡å®šèšç±»ä¸ªæ•°</p>
<ul>
<li><p>è‡ªä¸‹è€Œä¸Šï¼šåˆå§‹<span class="math inline">\(n\)</span>ç±»ï¼Œå†å°†ç›¸è·æœ€è¿‘çš„ä¸¤ç±»åˆå¹¶ï¼Œå»ºç«‹ä¸€ä¸ªæ–°çš„ç±»ï¼Œç›´åˆ°æœ€ååˆå¹¶æˆ<span class="math inline">\(1\)</span>ç±»ï¼›</p></li>
<li><p>è‡ªä¸Šè€Œä¸‹ï¼šåˆå§‹<span class="math inline">\(1\)</span>ç±»ï¼Œå†å°†ç›¸è·æœ€è¿œçš„æ ·æœ¬åˆ†è£‚æˆä¸¤ç±»ï¼Œç›´åˆ°æœ€ååˆ†è£‚æˆ<span class="math inline">\(n\)</span>ä¸ªç±»ã€‚</p></li>
</ul></li>
<li><p>åŸºäºè´¨å¿ƒçš„èšç±»: K-means, K-medoids</p></li>
<li><p>åŸºäºåˆ†å¸ƒçš„èšç±»: Gaussian mixture models (GMMs)</p></li>
</ul></li>
<li><p><strong>å¯è§†åŒ–é«˜ç»´æ•°æ®</strong>ï¼š</p>
<ul>
<li><p>å˜åˆ†è‡ªåŠ¨ç¼–ç å™¨ï¼ˆVAEï¼‰</p></li>
<li><p><span class="math inline">\(t\)</span>åˆ†å¸ƒéšæœºé‚»è¿‘åµŒå…¥ï¼ˆ<span class="math inline">\(t\)</span>-SNEï¼‰ï¼Œ</p></li>
<li><p>ç»Ÿä¸€æµå½¢é€¼è¿‘å’ŒæŠ•å½±ï¼ˆUMAPï¼‰ï¼Œ</p></li>
<li><p>è‡ªç»„ç»‡æ˜ å°„ï¼ˆSOMï¼‰</p></li>
<li><p>Kohonenå›¾ã€‚</p></li>
</ul></li>
</ul>
<div id="æ•°æ®é¢„å¤„ç†-3" class="section level2">
<h2><span class="header-section-number">5.1</span> æ•°æ®é¢„å¤„ç†</h2>
<p>æ•°æ®ä¸­å„ä¸ªå˜é‡çš„è¯´æ˜å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr class="header">
<th align="center">å˜é‡</th>
<th align="center">ç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">brand</td>
<td align="center">factor</td>
<td>43ä¸ªæ±½è½¦å“ç‰Œ</td>
</tr>
<tr class="even">
<td align="center">type</td>
<td align="center">factor</td>
<td>96ä¸ªæ°´å¹³</td>
</tr>
<tr class="odd">
<td align="center">model</td>
<td align="center">factor</td>
<td>113ä¸ªæ°´å¹³</td>
</tr>
<tr class="even">
<td align="center">seats</td>
<td align="center">int</td>
<td>åº§ä½æ•°</td>
</tr>
<tr class="odd">
<td align="center">max_power</td>
<td align="center">int</td>
<td>å‘åŠ¨æœºæœ€å¤§åŠŸç‡(kW),å–å¯¹æ•°</td>
</tr>
<tr class="even">
<td align="center">max_torque</td>
<td align="center">num</td>
<td>æœ€å¤§è½¬çŸ©(Nm),å–å¯¹æ•°</td>
</tr>
<tr class="odd">
<td align="center">cubic_capacity</td>
<td align="center">int</td>
<td>å®¹é‡(cm<span class="math inline">\(^3\)</span>),å–å¯¹æ•°</td>
</tr>
<tr class="even">
<td align="center">weight</td>
<td align="center">int</td>
<td>è½¦é‡(kg)ï¼Œå–å¯¹æ•°</td>
</tr>
<tr class="odd">
<td align="center">max_engine_speed</td>
<td align="center">int</td>
<td>å‘åŠ¨æœºæœ€å¤§è½¬é€Ÿ(rpm)</td>
</tr>
<tr class="even">
<td align="center">seconds_to_100</td>
<td align="center">int</td>
<td>è¾¾åˆ°100km/hæ‰€éœ€è¦ç§’æ•°</td>
</tr>
<tr class="odd">
<td align="center">top_speed</td>
<td align="center">int</td>
<td>æœ€å¤§è¡Œé©¶é€Ÿåº¦(km/h)</td>
</tr>
<tr class="even">
<td align="center">sports_car</td>
<td align="center">int</td>
<td>è·‘è½¦</td>
</tr>
<tr class="odd">
<td align="center">tau</td>
<td align="center">num</td>
<td>ä¸“å®¶è¯„åˆ†</td>
</tr>
</tbody>
</table>
<p>Figure <a href="unsupervised-learning.html#fig:pairs">5.3</a> æ˜¾ç¤ºäº†å„ä¸ªå˜é‡ï¼ˆå–å¯¹æ•°åï¼‰çš„æ•£ç‚¹å›¾ï¼ŒQ-Qå›¾ï¼ŒåŠç›¸å…³ç³»æ•°ã€‚</p>
<div class="figure" style="text-align: center"><span id="fig:pairs1"></span>
<img src="plots/5/log.png" alt="æ•£ç‚¹å›¾" width="40%" />
<p class="caption">
Figure 5.1: æ•£ç‚¹å›¾
</p>
</div>
<p><span class="math inline">\(\tau\)</span>ä¸ºä¸“å®¶æå‡ºçš„è¯„åˆ†æ–¹ç¨‹ï¼Œæ®æ­¤è¯„åˆ†å¯ä»¥å¤§æ¦‚åˆ¤æ–­è¯¥è½¦æ˜¯å¦ä¸ºè·‘è½¦ï¼š</p>
<p><span class="math display">\[\tau=\frac{\text{weight}}{\frac{\text{max_power}}{0.735499}}\text{seats}^{\frac{1}{3}}\left(\frac{\text{cubic_capacity}}{1000}\right)^{\frac{1}{4}}\]</span>
å¦‚æœæŠŠå¸¸æ•°é¡¹æå‡ºï¼Œå¯å¾—åˆ°å¦‚ä¸‹ç­‰ä»·çš„è¯„åˆ†<span class="math inline">\(\tau^+\)</span>:</p>
<p><span class="math display">\[\tau^+=\frac{\text{weight}}{\text{max_power}}\text{seats}^{\frac{1}{3}}\text{cubic_capacity}^{\frac{1}{4}}\]</span></p>
<p>ä¸“å®¶æŠŠ<span class="math inline">\(\tau&lt;17\)</span>æˆ–<span class="math inline">\(\tau^+&lt;129.9773\)</span>çš„æ±½è½¦å®šä¹‰ä¸ºè·‘è½¦ã€‚</p>
</div>
<div id="ä¸»æˆåˆ†åˆ†æ" class="section level2">
<h2><span class="header-section-number">5.2</span> ä¸»æˆåˆ†åˆ†æ</h2>
<p>Ingenbleek-Lemaire (1988) çš„ç›®æ ‡æ˜¯åˆ©ç”¨ä¸»æˆåˆ†åˆ†ææ¥å¯¹æ•°æ®è¿›è¡Œé™ç»´ï¼Œæ ¹æ®é€‰å–çš„ä¸»æˆåˆ†æ¥åŒºåˆ†è·‘è½¦å’Œæ™®é€šè½¦ï¼Œå¹¶å°è¯•è¾¾åˆ°å’Œä¸“å®¶é€‰æ‹©ä¸€æ ·çš„æ•ˆæœã€‚</p>
<p>PCAé€‚ç”¨äºé«˜æ–¯åˆ†å¸ƒï¼Œè‹¥å˜é‡æ˜¾è‘—ä¸ç¬¦åˆé«˜æ–¯åˆ†å¸ƒï¼Œéœ€è¦å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ï¼ˆæ¯”å¦‚å–å¯¹æ•°æˆ–å…¶ä»–æ–¹æ³•ï¼‰ã€‚
Ingenbleek-Lemaire (1988) æ„é€ äº†ä»¥ä¸‹5ä¸ªè¿‘ä¼¼æœä»é«˜æ–¯åˆ†å¸ƒçš„å˜é‡ä»¥ä¾¿è¿›è¡Œåç»­åˆ†æã€‚</p>
<p><span class="math display">\[x_1^*=\ln\left(\frac{\text{weight}}{\text{max_power}}\right)\]</span>
<span class="math display">\[x_2^*=\ln\left(\frac{\text{max_power}}{\text{cubic_capacity}}\right)\]</span>
<span class="math display">\[x_3^*=\ln\left(\text{max_torque}\right)\]</span>
<span class="math display">\[x_4^*=\ln\left(\text{max_engine_speed}\right)\]</span> <span class="math display">\[x_5^*=log\left(\text{cubic_capacity}\right)\]</span></p>
<p>Figure (fig:pairs2) å±•ç¤ºäº†ä»¥ä¸Š5ä¸ªå˜é‡çš„ç›¸å…³æ€§ã€‚</p>
<div class="figure" style="text-align: center"><span id="fig:pairs2"></span>
<img src="plots/5/x1-x5scatter.png" alt="æ•£ç‚¹å›¾" width="40%"  />
<p class="caption">
Figure 5.2: æ•£ç‚¹å›¾
</p>
</div>
<p>ä¸»æˆåˆ†åˆ†æå¯ä»¥é™ä½é«˜ç»´æ•°æ®çš„ç»´æ•°ï¼Œä½¿ç›¸å¯¹äºåŸå§‹æ•°æ®çš„é‡æ„è¯¯å·®æœ€å°ã€‚å¦‚æœåº”ç”¨æˆåŠŸï¼Œå®ƒå‡å°‘äº†ç‰¹å¾ç©ºé—´çš„ç»´æ•°ï¼Œå¹¶ä¸”å®ƒå¯¹äº(ç²¾ç®—)å›å½’å»ºæ¨¡ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºå®ƒæä¾›äº†å°‘é‡çš„ä¸ç›¸å…³çš„è§£é‡Šå˜é‡ã€‚</p>
<p>å‡è®¾æ ·æœ¬é‡ä¸º<span class="math inline">\(n\)</span>çš„æ ·æœ¬æœ‰<span class="math inline">\(q\)</span>ä¸ªç‰¹å¾<span class="math inline">\(\mathbf{x}_1^*,\ldots,\mathbf{x}^*_n\in\mathbb{R}^q\)</span>ã€‚å…¶è®¾è®¡çŸ©é˜µä¸º
<span class="math display">\[\mathbf{X}^*=(\mathbf{x}_1^*,\ldots,\mathbf{x}^*_n)^\intercal\in\mathbb{R}^{n\times q}.\]</span>
æŠŠè®¾è®¡çŸ©é˜µçš„æ¯åˆ—è¿›è¡Œæ ‡å‡†åŒ–ï¼Œå¾—åˆ°
<span class="math display">\[\mathbf{X}=(x_{i,j})_{1\le i \le n,1\le j\le q}\in\mathbb{R}^{n\times q}.\]</span>
å…¶ä¸­ï¼Œç¬¬<span class="math inline">\(i\)</span>è¡Œæ˜¯æ ·æœ¬<span class="math inline">\(i\)</span>çš„ç‰¹å¾<span class="math inline">\(\mathbf{x}_i\in\mathbb{R}^q, 1\le i\le n\)</span>, ç¬¬<span class="math inline">\(j\)</span>åˆ—æ˜¯ç¬¬<span class="math inline">\(j\)</span>ä¸ªç‰¹å¾<span class="math inline">\(x_j\in\mathbb{R}^n\)</span>.</p>
<p>çŸ©é˜µ<span class="math inline">\(\mathbf{X}\)</span>çš„ç§©ä¸º<span class="math inline">\(q\le n\)</span>ï¼Œå¯ä»¥æ‰¾åˆ°<span class="math inline">\(q\)</span>ä¸ªæ­£äº¤çš„<span class="math inline">\(q\)</span>ç»´åŸºå‘é‡<span class="math inline">\(\mathbf{v}_1,\ldots,\mathbf{v}_q\in\mathbb{R}^q\)</span>, ä½¿å¾—<span class="math inline">\(\mathbf{v}_1\)</span>ä¸º<span class="math inline">\(\mathbf{X}\)</span>æ³¢åŠ¨æœ€å¤§çš„æ–¹å‘ï¼Œ<span class="math inline">\(\mathbf{v}_2\)</span>ä¸ºä¸<span class="math inline">\(\mathbf{v}_1\)</span>æ­£äº¤æ–¹å‘ä¸Šçš„<span class="math inline">\(\mathbf{X}\)</span>æ³¢åŠ¨æœ€å¤§çš„æ–¹å‘ï¼Œä¾æ¬¡ç±»æ¨ã€‚</p>
<p>ç”¨æ•°å­¦å…¬å¼è¡¨ç¤ºå¦‚ä¸‹ï¼š
<span class="math display">\[\mathbf{v}_1=\underset{||\omega||_2=1}{\arg \max}||\mathbf{X}\omega||_2^2=\underset{\omega^\intercal\omega=1}{\arg \max} (\omega^\intercal\mathbf{X}^\intercal\mathbf{X}\omega)\]</span></p>
<p><span class="math display">\[\mathbf{v}_2=\underset{||\omega||_2=1}{\arg \max}||\mathbf{X}\omega||_2^2 ~~~\text{ subject to } \mathbf{v}_1^\intercal\omega=0.\]</span></p>
<p><span class="math display">\[\ldots\]</span></p>
<p>ä¸»æˆåˆ†åˆ†æå¯é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼å®ç°</p>
<ul>
<li><p>æ±‚<span class="math inline">\(\mathbf{X}^\intercal \mathbf{X}\)</span>æˆ–è€…<span class="math inline">\(\mathbf{X}\)</span>çš„åæ–¹å·®çŸ©é˜µ<span class="math inline">\(\mathbf{\Sigma}\)</span>çš„ç‰¹å¾å‘é‡å’Œç‰¹å¾å€¼ã€‚æ˜“çŸ¥<span class="math inline">\(\mathbf{X}^\intercal \mathbf{X}=n\times\mathbf{\Sigma}\)</span>ï¼Œæ‰€ä»¥å®ƒä»¬çš„ç‰¹å¾å‘é‡ç›¸åŒã€‚ç¬¬ä¸€ä¸ªç‰¹å¾å‘é‡å³ä¸º<span class="math inline">\(\mathbf{v}_1\)</span>ï¼Œç¬¬äºŒä¸ªç‰¹å¾å‘é‡ä¸º<span class="math inline">\(\mathbf{v}_2\)</span>ã€‚å‰ä¸¤ä¸ªä¸»æˆåˆ†ä¸º<span class="math inline">\(\mathbf{X}\mathbf{v}_1,\mathbf{X}\mathbf{v}_2\)</span></p></li>
<li><p>å¯¹<span class="math inline">\(\mathbf{X}\)</span>è¿›è¡Œå¥‡å¼‚å€¼ï¼ˆsingular value decompositionï¼‰åˆ†è§£:<span class="math display">\[\mathbf{X}=U\Lambda V^\intercal.\]</span>å…¶ä¸­ï¼Œå¯¹è§’çŸ©é˜µ<span class="math inline">\(\Lambda=\text{diag}(\lambda_1,\ldots,\lambda_q)\)</span>çš„å…ƒç´ ä¸º<span class="math inline">\(\mathbf{X}^\intercal \mathbf{X}\)</span>çš„ç‰¹å¾å€¼ï¼Œ<span class="math inline">\(V\)</span>ä¸º<span class="math inline">\(\mathbf{X}^\intercal \mathbf{X}\)</span>çš„ç‰¹å¾å‘é‡ã€‚ä¸»æˆåˆ†å¯ä»¥é€šè¿‡<span class="math inline">\(\mathbf{X}V\)</span>æ±‚å¾—ã€‚</p></li>
</ul>
<p>åˆ©ç”¨å‰<span class="math inline">\(p\)</span>ä¸ªä¸»æˆåˆ†å¯ä»¥é‡æ„è®¾è®¡çŸ©é˜µçš„è¿‘ä¼¼å€¼<span class="math display">\[\mathbf{X}_p=U\text{diag}(\lambda_1,\ldots,\lambda_p,0,\ldots,0)V^{\intercal}.\]</span></p>
<p>è¯¥è¿‘ä¼¼å€¼ä¸ºä»¥ä¸‹æå€¼é—®é¢˜çš„æ ¹<span class="math display">\[\underset{B\in\mathbb{R}^{n\times q}}{\arg \min}||\mathbf{X}-B||^2 ~~\text{subject to rank}(B)\le q,\]</span></p>
<p>å³çŸ©é˜µ<span class="math inline">\(\mathbf{X}_p\)</span>æ˜¯æ‰€æœ‰ç§©ä¸º<span class="math inline">\(p\)</span>çš„çŸ©é˜µä¸­ï¼Œä¸åŸå§‹è®¾è®¡çŸ©é˜µ<span class="math inline">\(\mathbf{X}\)</span>é‡ç»„å¹³æ–¹è¯¯å·®(FèŒƒæ•°)æœ€å°çš„çŸ©é˜µã€‚</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="unsupervised-learning.html#cb65-1"></a><span class="co"># standardize matrix</span></span>
<span id="cb65-2"><a href="unsupervised-learning.html#cb65-2"></a>X &lt;-<span class="st"> </span>X01<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">colMeans</span>(X01<span class="op">^</span><span class="dv">2</span>))[<span class="kw">col</span>(X01)]</span>
<span id="cb65-3"><a href="unsupervised-learning.html#cb65-3"></a></span>
<span id="cb65-4"><a href="unsupervised-learning.html#cb65-4"></a><span class="co"># eigenvectors and eigenvalues</span></span>
<span id="cb65-5"><a href="unsupervised-learning.html#cb65-5"></a>X1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(X)</span>
<span id="cb65-6"><a href="unsupervised-learning.html#cb65-6"></a><span class="kw">nrow</span>(X1)</span>
<span id="cb65-7"><a href="unsupervised-learning.html#cb65-7"></a>A &lt;-<span class="st">  </span><span class="kw">t</span>(X1) <span class="op">%*%</span><span class="st"> </span>X1</span>
<span id="cb65-8"><a href="unsupervised-learning.html#cb65-8"></a>A</span>
<span id="cb65-9"><a href="unsupervised-learning.html#cb65-9"></a><span class="kw">sum</span>(<span class="kw">eigen</span>(A)<span class="op">$</span>value)<span class="op">/</span><span class="dv">5</span></span>
<span id="cb65-10"><a href="unsupervised-learning.html#cb65-10"></a><span class="kw">sqrt</span>(<span class="kw">eigen</span>(A)<span class="op">$</span>value)      <span class="co"># singular values</span></span>
<span id="cb65-11"><a href="unsupervised-learning.html#cb65-11"></a><span class="kw">sqrt</span>(<span class="kw">eigen</span>(A)<span class="op">$</span>value<span class="op">/</span><span class="kw">nrow</span>(X1))   <span class="co"># scaled eigenvalues</span></span>
<span id="cb65-12"><a href="unsupervised-learning.html#cb65-12"></a><span class="kw">eigen</span>(A)<span class="op">$</span>vector</span>
<span id="cb65-13"><a href="unsupervised-learning.html#cb65-13"></a>A1&lt;-<span class="kw">cor</span>(X1)</span>
<span id="cb65-14"><a href="unsupervised-learning.html#cb65-14"></a>A1<span class="op">*</span><span class="kw">nrow</span>(X1)</span>
<span id="cb65-15"><a href="unsupervised-learning.html#cb65-15"></a><span class="kw">sqrt</span>(<span class="kw">eigen</span>(A1)<span class="op">$</span>value)  </span>
<span id="cb65-16"><a href="unsupervised-learning.html#cb65-16"></a><span class="kw">eigen</span>(A1)<span class="op">$</span>vector</span>
<span id="cb65-17"><a href="unsupervised-learning.html#cb65-17"></a><span class="kw">eigen</span>(A1)<span class="op">$</span>value</span>
<span id="cb65-18"><a href="unsupervised-learning.html#cb65-18"></a></span>
<span id="cb65-19"><a href="unsupervised-learning.html#cb65-19"></a><span class="co"># singular value decomposition</span></span>
<span id="cb65-20"><a href="unsupervised-learning.html#cb65-20"></a>SVD &lt;-<span class="st"> </span><span class="kw">svd</span>(X1)</span>
<span id="cb65-21"><a href="unsupervised-learning.html#cb65-21"></a>SVD<span class="op">$</span>d                       <span class="co"># singular values</span></span>
<span id="cb65-22"><a href="unsupervised-learning.html#cb65-22"></a><span class="kw">rbind</span>(SVD<span class="op">$</span>v[,<span class="dv">1</span>],SVD<span class="op">$</span>v[,<span class="dv">2</span>])  <span class="co"># first two right singular vectors</span></span>
<span id="cb65-23"><a href="unsupervised-learning.html#cb65-23"></a></span>
<span id="cb65-24"><a href="unsupervised-learning.html#cb65-24"></a><span class="co"># PCA with package PCA</span></span>
<span id="cb65-25"><a href="unsupervised-learning.html#cb65-25"></a>t.pca &lt;-<span class="st"> </span><span class="kw">princomp</span>(X1,<span class="dt">cor=</span><span class="ot">TRUE</span>)</span>
<span id="cb65-26"><a href="unsupervised-learning.html#cb65-26"></a>t.pca<span class="op">$</span>loadings          </span>
<span id="cb65-27"><a href="unsupervised-learning.html#cb65-27"></a><span class="kw">summary</span>(t.pca)</span>
<span id="cb65-28"><a href="unsupervised-learning.html#cb65-28"></a><span class="kw">eigen</span>(A1)<span class="op">$</span>value<span class="op">/</span><span class="kw">sum</span>(<span class="kw">eigen</span>(A1)<span class="op">$</span>value)</span></code></pre></div>
<p>é€šè¿‡<code>summary(t.pca)</code>æˆ‘ä»¬å¯ä»¥å¾—åˆ°å‰ä¸¤ä¸ªä¸»æˆåˆ†çš„ç´¯è®¡è´¡çŒ®åº¦å·²ç»åˆ°<span class="math inline">\(92%\)</span>ï¼Œå‰ä¸¤ä¸ªä¸»æˆåˆ†æå–äº†åŸå§‹æ•°æ®çš„ç»å¤§éƒ¨åˆ†ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©2ä¸ªä¸»æˆåˆ†åº”è¯¥å¯ä»¥è¾ƒå¥½åœ°é‡æ„åŸå§‹æ•°æ®ã€‚</p>
<p>ä»¥ç¬¬ä¸€ä¸»æˆåˆ†ä¸ºä¾‹è¯´æ˜ç¬¬ä¸€ä¸»æˆåˆ†å’Œ<span class="math inline">\(x_1^*,\ldots,x_5^*\)</span>çš„å…³ç³»</p>
<pre class="{rï¼Œeval=f}"><code># PCA Sports Cars weights
alpha &lt;- SVD$v[,1]/sds
(alpha_star &lt;- c(alpha[1],alpha[2]-alpha[1], alpha[3], alpha[4], alpha[5]-alpha[2])/alpha[1])</code></pre>
<p><span class="math inline">\(y_1=\left&lt;\mathbf{v_1},\mathbf{x}\right&gt;=-0.558x_1+0.412x_2+0.539x_3+0.126x_4+0.461x_5\)</span>å› ä¸ºæ­¤å¤„çš„<span class="math inline">\(x_1,\ldots,x_5\)</span>æ¥è‡ªæ ‡å‡†è®¾è®¡çŸ©é˜µï¼Œæ‰€ä»¥æˆ‘ä»¬åšé€†å˜æ¢<span class="math inline">\(\alpha_lx_l^*=\alpha_l\left(\hat{\sigma_l}\frac{x_l^*-\hat{\mu_l}}{\hat{\sigma_l}}+\hat{\mu_l}\right)=\alpha_l\hat{\sigma_l}x_l+\alpha_l\hat{\mu_l}\)</span>,å…¶ä¸­<span class="math inline">\(\alpha_l\hat{\sigma_l}=\mathbf{v_{1,l}}\)</span>,ç”±æ­¤å¯å¾—åŸå§‹æ–¹ç¨‹ä¸º<span class="math inline">\(\frac{y^*}{\alpha_1}=log(\text{weight})-1.93log(\text{max_power})-0.65log(\text{max_torque})-0.64log(\text{max_engine_speed})+0.25log(\text{cubic_capacity})\)</span>å°†æ ·æœ¬å¸¦å…¥è®¡ç®—æˆ‘ä»¬å³å¯å¾—åˆ°ç¬¬ä¸€ä¸»æˆåˆ†çš„å¾—åˆ†ã€‚ç¬¬äºŒä¸»æˆåˆ†è®¡ç®—åŒä¸Šã€‚</p>
<pre class="{rï¼Œeval=f}"><code># scatter plot
switch_sign &lt;- -1           # switch sign of the first component to make svd and princomp compatible
tt.pca &lt;- t.pca$scores
tt.pca[,1] &lt;- switch_sign *tt.pca[,1]
pairs(tt.pca,diag.panel=panel.qq,upper.panel=panel.cor)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:pairs"></span>
<img src="plots/5/pcascatter.png" alt="ä¸»æˆåˆ†æ•£ç‚¹å›¾" width="40%"  />
<p class="caption">
Figure 5.3: ä¸»æˆåˆ†æ•£ç‚¹å›¾
</p>
</div>
<p>Figure 5.3:å¯¹è§’çº¿ä¸ºQ-Qå›¾ï¼Œå·¦ä¸‹éƒ¨åˆ†æ•£ç‚¹å›¾ï¼Œå³ä¸Šéƒ¨åˆ†ç›¸å…³ç³»æ•°å›¾ï¼ˆå„ä¸ªä¸»æˆåˆ†ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œæ‰€ä»¥ç›¸å…³ç³»æ•°ä¸º0ï¼‰</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="unsupervised-learning.html#cb68-1"></a><span class="co"># plot first two principal components</span></span>
<span id="cb68-2"><a href="unsupervised-learning.html#cb68-2"></a>dat3 &lt;-<span class="st"> </span>d.data </span>
<span id="cb68-3"><a href="unsupervised-learning.html#cb68-3"></a>dat3<span class="op">$</span>v1 &lt;-<span class="st"> </span>X1 <span class="op">%*%</span><span class="st"> </span>SVD<span class="op">$</span>v[,<span class="dv">1</span>]</span>
<span id="cb68-4"><a href="unsupervised-learning.html#cb68-4"></a>dat3<span class="op">$</span>v2 &lt;-<span class="st"> </span>X1 <span class="op">%*%</span><span class="st"> </span>SVD<span class="op">$</span>v[,<span class="dv">2</span>]</span>
<span id="cb68-5"><a href="unsupervised-learning.html#cb68-5"></a></span>
<span id="cb68-6"><a href="unsupervised-learning.html#cb68-6"></a><span class="co"># png(&quot;./plots/5/pca.png&quot;)</span></span>
<span id="cb68-7"><a href="unsupervised-learning.html#cb68-7"></a><span class="kw">plot</span>(<span class="dt">x=</span>dat3<span class="op">$</span>v1, <span class="dt">y=</span>dat3<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>,<span class="dv">7</span>), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>,<span class="dv">7</span>), <span class="dt">ylab=</span><span class="st">&quot;2nd principal component&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;1st principal component&quot;</span>, <span class="dt">main=</span><span class="kw">list</span>(<span class="st">&quot;principal components analysis&quot;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>), <span class="dt">cex.lab=</span><span class="fl">1.5</span>)</span>
<span id="cb68-8"><a href="unsupervised-learning.html#cb68-8"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(dat3<span class="op">$</span>tau<span class="op">&lt;</span><span class="dv">21</span>),]</span>
<span id="cb68-9"><a href="unsupervised-learning.html#cb68-9"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb68-10"><a href="unsupervised-learning.html#cb68-10"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(dat3<span class="op">$</span>tau<span class="op">&lt;</span><span class="dv">17</span>),]</span>
<span id="cb68-11"><a href="unsupervised-learning.html#cb68-11"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb68-12"><a href="unsupervised-learning.html#cb68-12"></a><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;tau&gt;=21&quot;</span>, <span class="st">&quot;17&lt;=tau&lt;21&quot;</span>, <span class="st">&quot;tau&lt;17 (sports car)&quot;</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">lwd=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">20</span>))</span>
<span id="cb68-13"><a href="unsupervised-learning.html#cb68-13"></a><span class="co">#dev.off()</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:2pcas"></span>
<img src="plots/5/pca.png" alt="ä¸»æˆåˆ†å¾—åˆ†å›¾" width="40%"  />
<p class="caption">
Figure 5.4: ä¸»æˆåˆ†å¾—åˆ†å›¾
</p>
</div>
<p>Figure 5.4:æ ·æœ¬(n=475)çš„ä¸»æˆåˆ†å¾—åˆ†å›¾ï¼Œå…¶ä¸­è“è‰²ç‚¹å’Œçº¢è‰²ç‚¹ä¹‹é—´æœ‰ä¸€ä¸ªè¶…å¹³é¢å°†è·‘è½¦å’Œæ™®é€šè½¦å¾ˆå¥½çš„åŒºåˆ†å¼€äº†ã€‚</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="unsupervised-learning.html#cb69-1"></a><span class="co"># reconstruction error</span></span>
<span id="cb69-2"><a href="unsupervised-learning.html#cb69-2"></a>reconstruction.PCA &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA</span>, <span class="kw">c</span>(<span class="dv">5</span>))</span>
<span id="cb69-3"><a href="unsupervised-learning.html#cb69-3"></a></span>
<span id="cb69-4"><a href="unsupervised-learning.html#cb69-4"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</span>
<span id="cb69-5"><a href="unsupervised-learning.html#cb69-5"></a>  Xp &lt;-<span class="st"> </span>SVD<span class="op">$</span>v[,<span class="dv">1</span><span class="op">:</span>p] <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(SVD<span class="op">$</span>v[,<span class="dv">1</span><span class="op">:</span>p]) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(X)</span>
<span id="cb69-6"><a href="unsupervised-learning.html#cb69-6"></a>  Xp &lt;-<span class="st"> </span><span class="kw">t</span>(Xp)</span>
<span id="cb69-7"><a href="unsupervised-learning.html#cb69-7"></a>  reconstruction.PCA[p] &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">sum</span>(<span class="kw">as.matrix</span>((X<span class="op">-</span>Xp)<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">nrow</span>(X))</span>
<span id="cb69-8"><a href="unsupervised-learning.html#cb69-8"></a>               }</span>
<span id="cb69-9"><a href="unsupervised-learning.html#cb69-9"></a><span class="kw">round</span>(reconstruction.PCA,<span class="dv">2</span>)               </span>
<span id="cb69-10"><a href="unsupervised-learning.html#cb69-10"></a></span>
<span id="cb69-11"><a href="unsupervised-learning.html#cb69-11"></a><span class="co"># biplot</span></span>
<span id="cb69-12"><a href="unsupervised-learning.html#cb69-12"></a>tt.pca &lt;-<span class="st"> </span>t.pca</span>
<span id="cb69-13"><a href="unsupervised-learning.html#cb69-13"></a>tt.pca<span class="op">$</span>scores[,<span class="dv">1</span>] &lt;-<span class="st">  </span>switch_sign <span class="op">*</span><span class="st"> </span>tt.pca<span class="op">$</span>scores[,<span class="dv">1</span>]</span>
<span id="cb69-14"><a href="unsupervised-learning.html#cb69-14"></a>tt.pca<span class="op">$</span>loadings[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span>] &lt;-<span class="st"> </span>switch_sign <span class="op">*</span><span class="st"> </span>tt.pca<span class="op">$</span>loadings[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span>] </span>
<span id="cb69-15"><a href="unsupervised-learning.html#cb69-15"></a><span class="kw">biplot</span>(tt.pca,<span class="dt">choices=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">scale=</span><span class="dv">0</span>, <span class="dt">expand=</span><span class="dv">2</span>, <span class="dt">xlab=</span><span class="st">&quot;1st principal component&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;2nd principal component&quot;</span>, <span class="dt">cex=</span><span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">1.5</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>,<span class="dv">7</span>), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>,<span class="dv">7</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:2pcas-2"></span>
<img src="plots/5/biplot.png" alt="çŸ¢é‡åˆ†è§£å›¾" width="40%"  />
<p class="caption">
Figure 5.5: çŸ¢é‡åˆ†è§£å›¾
</p>
</div>
<p>Figure 5.5:é»‘ç‚¹ä¹‹é—´çš„è·ç¦»è¡¨ç¤ºç›¸ä¼¼æ€§ã€‚çº¢è‰²çŸ¢é‡æ˜¯å‰ä¸¤ä¸ªæ ‡å‡†æ­£äº¤æƒå€¼å‘é‡<span class="math inline">\(\mathbf{v_1}\)</span>å’Œ<span class="math inline">\(\mathbf{v_2}\)</span>çš„åˆ†é‡ã€‚é•¿åº¦åæ˜ äº†å˜é‡çš„æ ‡å‡†å·®ï¼Œå¤¹è§’çš„ä½™å¼¦å€¼ç»™å‡ºäº†ç›¸åº”çš„ç›¸å…³æ€§ã€‚</p>
</div>
<div id="è‡ªç¼–ç " class="section level2">
<h2><span class="header-section-number">5.3</span> è‡ªç¼–ç </h2>
<p>PCAå¯¹å¼‚å¸¸å€¼å¾ˆæ•æ„Ÿï¼Œä¹Ÿæœ‰ç¨³å¥çš„PCAç‰ˆæœ¬ã€‚ä¾‹å¦‚ï¼ŒCrouxç­‰äººç»™å‡ºäº†ä¸€ä¸ªåŸºäºä¸­å€¼ç»å¯¹åå·®(MADs)çš„ç®—æ³•ï¼ŒRåŒ…ï¼špcaPPã€‚
ä¸»æˆåˆ†åˆ†æå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªè‡ªåŠ¨ç¼–ç å™¨ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ›´ä¸€èˆ¬åœ°ä»‹ç»è‡ªåŠ¨ç¼–ç å™¨ï¼Œä¾‹å¦‚BNNã€‚</p>
<p>è‡ªç¼–ç åŒ…å«ç¼–ç å’Œè§£ç ä¸¤ä¸ªé•œé¢å¯¹ç§°çš„æ˜ å°„ï¼š</p>
<ul>
<li><p>ç¼–ç : <span class="math inline">\(\varphi:\mathbb{R}^q\rightarrow\mathbb{R}^p\)</span></p></li>
<li><p>è§£ç : <span class="math inline">\(\psi:\mathbb{R}^p\rightarrow\mathbb{R}^q\)</span>
å…¶ä¸­<span class="math inline">\(p \le q\)</span>ï¼Œæˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªåº¦é‡å·®å¼‚çš„å‡½æ•°<span class="math inline">\(d(Â·,Â·)\)</span>ï¼Œå½“ä¸”ä»…å½“<span class="math inline">\(\mathbf{x}=\mathbf{y}\)</span>æ—¶<span class="math inline">\(d(x,y)=0\)</span>ï¼Œè‡ªç¼–ç å°±æ˜¯æ‰¾åˆ°ä¸€å¯¹<span class="math inline">\((\varphi,\psi)\)</span>ä½¿å¾—æœ‰<span class="math inline">\(\pi=\psi\circ\varphi\)</span>æ»¡è¶³<span class="math inline">\(d(\pi(\mathbf{x}),\mathbf{x})\)</span>æœ€å°ã€‚</p></li>
</ul>
<p>åœ¨PCAçš„ä¾‹å­ä¸­ï¼š</p>
<p><span class="math display">\[\varphi:\mathbb{R}^q\rightarrow\mathbb{R}^p,\mathbf{x}\mapsto\mathbf{y}=\varphi(\mathbf{x})=(\left&lt;\mathbf{v_1},\mathbf{x}\right&gt;,\ldots,\left&lt;\mathbf{v_p},\mathbf{x}\right&gt;)^T=(\mathbf{v_1},\ldots,\mathbf{v_p})^T\mathbf{x}.\]</span></p>
<p><span class="math display">\[\psi:\mathbb{R}^p\rightarrow\mathbb{R}^q,\mathbf{y}\mapsto\psi(\mathbf{y})=(\mathbf{v_1},\ldots,\mathbf{v_p})\mathbf{y}.\]</span></p>
<p><span class="math display">\[\pi(\mathbf{X}^T)=\psi\circ\varphi(\mathbf{x}^T)=(\mathbf{v_1},\ldots,\mathbf{v_p})(\mathbf{v_1},\ldots,\mathbf{v_p})^T\mathbf{X}^T=\mathbf{X_p}^T.\]</span></p>
<p><span class="math display">\[\sum_{i=1}^nd(\pi(\mathbf{x}_i),\mathbf{x}_i)=\sum_{i=1}^n\|\pi(\mathbf{x}_i-\mathbf{x}_i)\|_2^2=\|\mathbf{X}_p-\mathbf{X}\|_F^2.\]</span></p>
<p>æ­¤å¤„è¡¡é‡é‡æ„è¯¯å·®çš„ä¸ºé’ˆå¯¹çŸ©é˜µçš„æ¬§æ°è·ç¦»ï¼Œå³FèŒƒæ•°ã€‚</p>
<p>ä½œä¸ºéçº¿æ€§è‡ªç¼–ç å™¨çš„ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬è€ƒè™‘ç“¶é¢ˆç¥ç»ç½‘ç»œ(BNN)ã€‚ä¸ºäº†æˆåŠŸæ ¡å‡†ä¸€ä¸ªBNNï¼Œå®ƒçš„éšè—å±‚æ•°åº”è¯¥æ˜¯å¥‡æ•°<span class="math inline">\(d\)</span> (<span class="math inline">\(d\)</span>ç§°ä¸ºç¥ç»ç½‘ç»œçš„æ·±åº¦)ï¼Œå¹¶ä¸”ä¸­å¿ƒéšè—å±‚åº”è¯¥æ˜¯ä½ç»´çš„ï¼Œæœ‰<span class="math inline">\(p\)</span>ä¸ªéšè—ç¥ç»å…ƒï¼Œæ‰€æœ‰å‰©ä½™çš„éšè—å±‚åº”è¯¥æ˜¯å›´ç»•è¿™ä¸ªä¸­å¿ƒéšè—å±‚å¯¹ç§°çš„ã€‚å› æ­¤å¯¹äºæ·±åº¦<span class="math inline">\(d = 3\)</span>çš„BNNï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å›¾<a href="unsupervised-learning.html#fig:bnn-structure">5.6</a>å±•ç¤ºçš„ç¥ç»ç½‘ç»œç»“æ„</p>
<div class="figure" style="text-align: center"><span id="fig:bnn-structure"></span>
<img src="plots/5/bnn.png" alt="è‡ªç¼–ç  q=5,p=2" width="40%"  />
<p class="caption">
Figure 5.6: è‡ªç¼–ç  q=5,p=2
</p>
</div>
<p>ä¸€èˆ¬çš„ç¥ç»ç½‘ç»œæœ‰å¦‚ä¸‹ç»“æ„ï¼š</p>
<p><span class="math display">\[\pi:\mathbb{R}^{q_0}\rightarrow\mathbb{R}^{q_{d+1}=q_0},\mathbf{x}\mapsto\pi(\mathbf{x})=(\mathbf{z}^\left(d+1\right)\circ\mathbf{z}^\left(d\right)\circ\ldots\circ\mathbf{z}^\left(1\right))(\mathbf{x})\]</span></p>
<p><span class="math display">\[\mathbf{z}^\left(m\right):\mathbb{R}^{q_{m-1}}\rightarrow\mathbb{R}^{q_m},\mathbf{z}\mapsto\mathbf{z}^\left(m\right)(\mathbf{z})=\left(\phi\left(\left&lt;\mathbf{w}_1^{\left(m\right)},\mathbf{z}\right&gt;\right),\ldots,\phi\left(\left&lt;\mathbf{w}_{q_m}^{\left(m\right)},\mathbf{z}\right&gt;\right)\right)^T\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(\mathbf{w}_l^{\left(m\right)}\in\mathbb{R}^{q_{m-1}},1 \le l\le q_m\)</span>ä¸ºæƒé‡ï¼Œ<span class="math inline">\(\phi:\mathbb{R}\rightarrow\mathbb{R}\)</span>ä¸ºæ¿€æ´»å‡½æ•°ã€‚</p>
<p><span class="math display">\[\mathbf{z}^\left(d+1\right):\mathbb{R}^{q_{d}}\rightarrow\mathbb{R}^{q_{d+1}},\mathbf{z}\mapsto\mathbf{z}^\left(d+1\right)(\mathbf{z})=\left(\left&lt;\mathbf{w}_1^{\left(d+1\right)},\mathbf{z}\right&gt;,\ldots,\left&lt;\mathbf{w}_{q_{d+1}}^{\left(d+1\right)},\mathbf{z}\right&gt;\right)^T\]</span></p>
<p>æ€»å‚æ•°ä¸ªæ•°ä¸º<span class="math inline">\(r=\sum_{m=1}^{d+1}q_mq_{m-1}\)</span>ã€‚</p>
<ul>
<li><p>ä¸ç»å…¸çš„å‰é¦ˆç¥ç»ç½‘ç»œç›¸æ¯”ï¼Œæˆ‘ä»¬è¿™é‡Œæ²¡æœ‰æˆªè·é¡¹ï¼Œå› ä¸ºç‰¹å¾$_iå·²ç»è¢«æ ‡å‡†åŒ–ã€‚è¿™ç•¥å¾®é™ä½äº†ç½‘ç»œå‚æ•°çš„ç»´æ•°ã€‚</p></li>
<li><p>é€‰æ‹©è¾“å‡ºæ¿€æ´»ä¸ºçº¿æ€§æ¿€æ´»ï¼Œæ˜¯å› ä¸ºxçš„æ‰€æœ‰æˆä»½éƒ½åœ¨å®æ•°é¢†åŸŸä¸­ã€‚ä¸‹é¢æˆ‘ä»¬è¿˜å°†åº”ç”¨å…¶ä»–è¾“å‡ºæ¿€æ´»å‡½æ•°ã€‚</p></li>
<li><p>ä½œä¸ºéšå±‚çš„æ¿€æ´»å‡½æ•°ï¼Œæˆ‘ä»¬é€šå¸¸é€‰ç”¨åŒæ›²æ­£åˆ‡å‡½æ•°ã€‚å¦‚æœä¸€ä¸ªBNNåªæœ‰çº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œé‚£ä¹ˆä»–æ˜¯ç­‰ä»·äºPCAçš„ã€‚</p></li>
</ul>
<div id="æ¨¡å‹è®­ç»ƒ" class="section level3">
<h3><span class="header-section-number">5.3.1</span> æ¨¡å‹è®­ç»ƒ</h3>
<p>å…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<p>åœ¨æ­£å¼è¿›å…¥ç¥ç»ç½‘ä¹‹å‰ï¼Œæˆ‘ä»¬è¦å…ˆè¿›è¡Œæƒé‡é¢„è®­ç»ƒã€‚</p>
<div class="figure" style="text-align: center"><span id="fig:bnn-train"></span>
<img src="plots/5/bnn_train.png" alt="è‡ªç¼–ç è®­ç»ƒè¿‡ç¨‹" width="60%"  />
<p class="caption">
Figure 5.7: è‡ªç¼–ç è®­ç»ƒè¿‡ç¨‹
</p>
</div>
<ul>
<li><p>é¦–å…ˆæˆ‘ä»¬å…ˆå°†ä¸­é—´çš„éšè—å±‚æŠ˜å å¾—åˆ°å¦‚å›¾<a href="unsupervised-learning.html#fig:bnn-train">5.7</a>ä¸­é—´ç»“æ„çš„ç¥ç»ç½‘ç»œï¼Œæ®æ­¤æˆ‘ä»¬å¾—åˆ°æƒé‡ï¼š<span class="math inline">\(\mathbf{w}_1^{(1)}\ldots,\mathbf{w}_{q_1=7}^{(1)}\in\mathbb{R}^{q_0=5}\)</span>
å’Œ<span class="math inline">\(\mathbf{w}_1^{(d+1)}\ldots,\mathbf{w}_{q_{d+1}=5}^{(d+1)}\in\mathbb{R}^{q_d=7}\)</span></p></li>
<li><p>å†è®­ç»ƒéšè—å±‚å³å›¾<a href="unsupervised-learning.html#fig:bnn-train">5.7</a>ä¸­å³å›¾çš„æƒé‡ï¼Œå¾—åˆ°ï¼š<span class="math inline">\(\mathbf{w}_1^{(2)}\ldots,\mathbf{w}_{q_2=2}^{(2)}\in\mathbb{R}^{q_1=7}\)</span>
å’Œ<span class="math inline">\(\mathbf{w}_1^{(3)}\ldots,\mathbf{w}_{q_{3}=7}^{(3)}\in\mathbb{R}^{q_2=2}\)</span></p></li>
</ul>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="unsupervised-learning.html#cb70-1"></a>bottleneck<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="cf">function</span>(q00, q22){</span>
<span id="cb70-2"><a href="unsupervised-learning.html#cb70-2"></a>   Input &lt;-<span class="st"> </span><span class="kw">layer_input</span>(<span class="dt">shape =</span> <span class="kw">c</span>(q00), <span class="dt">dtype =</span> <span class="st">&#39;float32&#39;</span>, <span class="dt">name =</span> <span class="st">&#39;Input&#39;</span>)</span>
<span id="cb70-3"><a href="unsupervised-learning.html#cb70-3"></a>   </span>
<span id="cb70-4"><a href="unsupervised-learning.html#cb70-4"></a>   Output =<span class="st"> </span>Input <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb70-5"><a href="unsupervised-learning.html#cb70-5"></a><span class="st">          </span><span class="kw">layer_dense</span>(<span class="dt">units=</span>q22, <span class="dt">activation=</span><span class="st">&#39;tanh&#39;</span>, <span class="dt">use_bias=</span><span class="ot">FALSE</span>, <span class="dt">name=</span><span class="st">&#39;Bottleneck&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb70-6"><a href="unsupervised-learning.html#cb70-6"></a><span class="st">          </span><span class="kw">layer_dense</span>(<span class="dt">units=</span>q00, <span class="dt">activation=</span><span class="st">&#39;linear&#39;</span>, <span class="dt">use_bias=</span><span class="ot">FALSE</span>, <span class="dt">name=</span><span class="st">&#39;Output&#39;</span>)</span>
<span id="cb70-7"><a href="unsupervised-learning.html#cb70-7"></a></span>
<span id="cb70-8"><a href="unsupervised-learning.html#cb70-8"></a>   model &lt;-<span class="st"> </span><span class="kw">keras_model</span>(<span class="dt">inputs =</span> Input, <span class="dt">outputs =</span> Output)</span>
<span id="cb70-9"><a href="unsupervised-learning.html#cb70-9"></a>   </span>
<span id="cb70-10"><a href="unsupervised-learning.html#cb70-10"></a>   model <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">compile</span>(<span class="dt">optimizer =</span> <span class="kw">optimizer_nadam</span>(), <span class="dt">loss =</span> <span class="st">&#39;mean_squared_error&#39;</span>)</span>
<span id="cb70-11"><a href="unsupervised-learning.html#cb70-11"></a>   model</span>
<span id="cb70-12"><a href="unsupervised-learning.html#cb70-12"></a>   }</span>
<span id="cb70-13"><a href="unsupervised-learning.html#cb70-13"></a></span>
<span id="cb70-14"><a href="unsupervised-learning.html#cb70-14"></a>bottleneck<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="cf">function</span>(q00, q11, q22){   </span>
<span id="cb70-15"><a href="unsupervised-learning.html#cb70-15"></a>   Input &lt;-<span class="st"> </span><span class="kw">layer_input</span>(<span class="dt">shape =</span> <span class="kw">c</span>(q00), <span class="dt">dtype =</span> <span class="st">&#39;float32&#39;</span>, <span class="dt">name =</span> <span class="st">&#39;Input&#39;</span>)</span>
<span id="cb70-16"><a href="unsupervised-learning.html#cb70-16"></a>   </span>
<span id="cb70-17"><a href="unsupervised-learning.html#cb70-17"></a>   Encoder =<span class="st"> </span>Input <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb70-18"><a href="unsupervised-learning.html#cb70-18"></a><span class="st">          </span><span class="kw">layer_dense</span>(<span class="dt">units=</span>q11, <span class="dt">activation=</span><span class="st">&#39;tanh&#39;</span>, <span class="dt">use_bias=</span><span class="ot">FALSE</span>, <span class="dt">name=</span><span class="st">&#39;Layer1&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb70-19"><a href="unsupervised-learning.html#cb70-19"></a><span class="st">          </span><span class="kw">layer_dense</span>(<span class="dt">units=</span>q22, <span class="dt">activation=</span><span class="st">&#39;tanh&#39;</span>, <span class="dt">use_bias=</span><span class="ot">FALSE</span>, <span class="dt">name=</span><span class="st">&#39;Bottleneck&#39;</span>) </span>
<span id="cb70-20"><a href="unsupervised-learning.html#cb70-20"></a></span>
<span id="cb70-21"><a href="unsupervised-learning.html#cb70-21"></a>   Decoder =<span class="st"> </span>Encoder <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb70-22"><a href="unsupervised-learning.html#cb70-22"></a><span class="st">          </span><span class="kw">layer_dense</span>(<span class="dt">units=</span>q11, <span class="dt">activation=</span><span class="st">&#39;tanh&#39;</span>, <span class="dt">use_bias=</span><span class="ot">FALSE</span>, <span class="dt">name=</span><span class="st">&#39;Layer3&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb70-23"><a href="unsupervised-learning.html#cb70-23"></a><span class="st">          </span><span class="kw">layer_dense</span>(<span class="dt">units=</span>q00, <span class="dt">activation=</span><span class="st">&#39;linear&#39;</span>, <span class="dt">use_bias=</span><span class="ot">FALSE</span>, <span class="dt">name=</span><span class="st">&#39;Output&#39;</span>)</span>
<span id="cb70-24"><a href="unsupervised-learning.html#cb70-24"></a></span>
<span id="cb70-25"><a href="unsupervised-learning.html#cb70-25"></a>   model &lt;-<span class="st"> </span><span class="kw">keras_model</span>(<span class="dt">inputs =</span> Input, <span class="dt">outputs =</span> Decoder)</span>
<span id="cb70-26"><a href="unsupervised-learning.html#cb70-26"></a>   model <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">compile</span>(<span class="dt">optimizer =</span> <span class="kw">optimizer_nadam</span>(), <span class="dt">loss =</span> <span class="st">&#39;mean_squared_error&#39;</span>)</span>
<span id="cb70-27"><a href="unsupervised-learning.html#cb70-27"></a>   model</span>
<span id="cb70-28"><a href="unsupervised-learning.html#cb70-28"></a>   }</span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="unsupervised-learning.html#cb71-1"></a><span class="co"># bottleneck architecture</span></span>
<span id="cb71-2"><a href="unsupervised-learning.html#cb71-2"></a>q1 &lt;-<span class="st"> </span><span class="dv">7</span></span>
<span id="cb71-3"><a href="unsupervised-learning.html#cb71-3"></a>q2 &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb71-4"><a href="unsupervised-learning.html#cb71-4"></a>q0 &lt;-<span class="st"> </span><span class="kw">ncol</span>(X)</span>
<span id="cb71-5"><a href="unsupervised-learning.html#cb71-5"></a></span>
<span id="cb71-6"><a href="unsupervised-learning.html#cb71-6"></a><span class="co"># pre-training 1: merging layers 1 and 3 (skipping bottleneck)</span></span>
<span id="cb71-7"><a href="unsupervised-learning.html#cb71-7"></a>model<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">bottleneck.1</span>(q0, q1)</span>
<span id="cb71-8"><a href="unsupervised-learning.html#cb71-8"></a>model<span class="fl">.1</span></span>
<span id="cb71-9"><a href="unsupervised-learning.html#cb71-9"></a>epochs &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb71-10"><a href="unsupervised-learning.html#cb71-10"></a>batch_size &lt;-<span class="st"> </span><span class="kw">nrow</span>(X)</span>
<span id="cb71-11"><a href="unsupervised-learning.html#cb71-11"></a></span>
<span id="cb71-12"><a href="unsupervised-learning.html#cb71-12"></a><span class="co"># fit the merged model</span></span>
<span id="cb71-13"><a href="unsupervised-learning.html#cb71-13"></a>{t1 &lt;-<span class="st"> </span><span class="kw">proc.time</span>()</span>
<span id="cb71-14"><a href="unsupervised-learning.html#cb71-14"></a>  fit &lt;-<span class="st"> </span>model<span class="fl">.1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fit</span>(<span class="kw">as.matrix</span>(X), <span class="kw">as.matrix</span>(X), <span class="dt">epochs=</span>epochs, <span class="dt">batch_size=</span>batch_size, <span class="dt">verbose=</span><span class="dv">0</span>)</span>
<span id="cb71-15"><a href="unsupervised-learning.html#cb71-15"></a><span class="kw">proc.time</span>()<span class="op">-</span>t1}</span>
<span id="cb71-16"><a href="unsupervised-learning.html#cb71-16"></a></span>
<span id="cb71-17"><a href="unsupervised-learning.html#cb71-17"></a><span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(fit[[<span class="dv">2</span>]]<span class="op">$</span>loss)), <span class="dt">y=</span><span class="kw">sqrt</span>(fit[[<span class="dv">2</span>]]<span class="op">$</span>loss<span class="op">*</span>q0),  <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(<span class="kw">sqrt</span>(fit[[<span class="dv">2</span>]]<span class="op">$</span>loss<span class="op">*</span>q0))),<span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span>.<span class="dv">5</span>, <span class="dt">xlab=</span><span class="st">&#39;epochs&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Frobenius norm loss&#39;</span>, <span class="dt">main=</span><span class="st">&quot;gradient descent algorithm&quot;</span>) </span>
<span id="cb71-18"><a href="unsupervised-learning.html#cb71-18"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(<span class="fl">0.6124</span>), <span class="dt">col=</span><span class="st">&quot;orange&quot;</span>)</span>
<span id="cb71-19"><a href="unsupervised-learning.html#cb71-19"></a> </span>
<span id="cb71-20"><a href="unsupervised-learning.html#cb71-20"></a><span class="co"># neuron activations in the central layer </span></span>
<span id="cb71-21"><a href="unsupervised-learning.html#cb71-21"></a>zz &lt;-<span class="st"> </span><span class="kw">keras_model</span>(<span class="dt">inputs=</span>model<span class="fl">.1</span><span class="op">$</span>input, <span class="dt">outputs=</span><span class="kw">get_layer</span>(model<span class="fl">.1</span>, <span class="st">&#39;Bottleneck&#39;</span>)<span class="op">$</span>output)</span>
<span id="cb71-22"><a href="unsupervised-learning.html#cb71-22"></a>yy &lt;-<span class="st"> </span>zz <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">predict</span>(<span class="kw">as.matrix</span>(X))</span>
<span id="cb71-23"><a href="unsupervised-learning.html#cb71-23"></a></span>
<span id="cb71-24"><a href="unsupervised-learning.html#cb71-24"></a><span class="co"># pre-training 2: middlepart</span></span>
<span id="cb71-25"><a href="unsupervised-learning.html#cb71-25"></a>model<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">bottleneck.1</span>(q1, q2)</span>
<span id="cb71-26"><a href="unsupervised-learning.html#cb71-26"></a>model<span class="fl">.2</span></span>
<span id="cb71-27"><a href="unsupervised-learning.html#cb71-27"></a>epochs &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb71-28"><a href="unsupervised-learning.html#cb71-28"></a></span>
<span id="cb71-29"><a href="unsupervised-learning.html#cb71-29"></a><span class="co"># fit the merged model</span></span>
<span id="cb71-30"><a href="unsupervised-learning.html#cb71-30"></a>{t1 &lt;-<span class="st"> </span><span class="kw">proc.time</span>()</span>
<span id="cb71-31"><a href="unsupervised-learning.html#cb71-31"></a>  fit &lt;-<span class="st"> </span>model<span class="fl">.2</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fit</span>(<span class="kw">as.matrix</span>(yy), <span class="kw">as.matrix</span>(yy), <span class="dt">epochs=</span>epochs, <span class="dt">batch_size=</span>batch_size, <span class="dt">verbose=</span><span class="dv">0</span>)</span>
<span id="cb71-32"><a href="unsupervised-learning.html#cb71-32"></a><span class="kw">proc.time</span>()<span class="op">-</span>t1}</span>
<span id="cb71-33"><a href="unsupervised-learning.html#cb71-33"></a></span>
<span id="cb71-34"><a href="unsupervised-learning.html#cb71-34"></a><span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(fit[[<span class="dv">2</span>]]<span class="op">$</span>loss)), <span class="dt">y=</span><span class="kw">sqrt</span>(fit[[<span class="dv">2</span>]]<span class="op">$</span>loss<span class="op">*</span>q0),  <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(<span class="kw">sqrt</span>(fit[[<span class="dv">2</span>]]<span class="op">$</span>loss<span class="op">*</span>q0))),<span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span>.<span class="dv">5</span>, <span class="dt">xlab=</span><span class="st">&#39;epochs&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Frobenius norm loss&#39;</span>, <span class="dt">main=</span><span class="st">&quot;gradient descent algorithm&quot;</span>) </span></code></pre></div>
<p>é¢„è®­ç»ƒç»“æŸåï¼Œç”¨è¿™äº›é¢„å…ˆè®­ç»ƒå¥½çš„æƒå€¼å¯¹æ•´ä¸ªBNNè¿›è¡Œé‡æ„ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªé‡æ„è¯¯å·®ï¼ˆå¦‚ä¸‹ï¼‰åœ¨æ­¤æ¡ˆä¾‹ä¸­ï¼Œæ­¤å¤„çš„é‡æ„è¯¯å·®å¤§äºä½¿ç”¨PCAæ—¶å–ä¸¤ä¸ªä¸»æˆåˆ†çš„é‡æ„è¯¯å·®ã€‚</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="unsupervised-learning.html#cb72-1"></a><span class="co"># fitting the full model</span></span>
<span id="cb72-2"><a href="unsupervised-learning.html#cb72-2"></a>model<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw">bottleneck.3</span>(q0, q1, q2)</span>
<span id="cb72-3"><a href="unsupervised-learning.html#cb72-3"></a>model<span class="fl">.3</span></span>
<span id="cb72-4"><a href="unsupervised-learning.html#cb72-4"></a></span>
<span id="cb72-5"><a href="unsupervised-learning.html#cb72-5"></a><span class="co"># set weights</span></span>
<span id="cb72-6"><a href="unsupervised-learning.html#cb72-6"></a>weight<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw">get_weights</span>(model<span class="fl">.3</span>)</span>
<span id="cb72-7"><a href="unsupervised-learning.html#cb72-7"></a>weight<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">get_weights</span>(model<span class="fl">.1</span>)</span>
<span id="cb72-8"><a href="unsupervised-learning.html#cb72-8"></a>weight<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">get_weights</span>(model<span class="fl">.2</span>)</span>
<span id="cb72-9"><a href="unsupervised-learning.html#cb72-9"></a>weight<span class="fl">.3</span>[[<span class="dv">1</span>]] &lt;-<span class="st"> </span>weight<span class="fl">.1</span>[[<span class="dv">1</span>]]</span>
<span id="cb72-10"><a href="unsupervised-learning.html#cb72-10"></a>weight<span class="fl">.3</span>[[<span class="dv">4</span>]] &lt;-<span class="st"> </span>weight<span class="fl">.1</span>[[<span class="dv">2</span>]]</span>
<span id="cb72-11"><a href="unsupervised-learning.html#cb72-11"></a>weight<span class="fl">.3</span>[[<span class="dv">2</span>]] &lt;-<span class="st"> </span>weight<span class="fl">.2</span>[[<span class="dv">1</span>]]</span>
<span id="cb72-12"><a href="unsupervised-learning.html#cb72-12"></a>weight<span class="fl">.3</span>[[<span class="dv">3</span>]] &lt;-<span class="st"> </span>weight<span class="fl">.2</span>[[<span class="dv">2</span>]]</span>
<span id="cb72-13"><a href="unsupervised-learning.html#cb72-13"></a><span class="kw">set_weights</span>(model<span class="fl">.3</span>, weight<span class="fl">.3</span>)</span>
<span id="cb72-14"><a href="unsupervised-learning.html#cb72-14"></a>fit0 &lt;-<span class="st"> </span>model<span class="fl">.3</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">predict</span>(<span class="kw">as.matrix</span>(X))</span>
<span id="cb72-15"><a href="unsupervised-learning.html#cb72-15"></a></span>
<span id="cb72-16"><a href="unsupervised-learning.html#cb72-16"></a><span class="co"># reconstruction error of the pre-calibrated network</span></span>
<span id="cb72-17"><a href="unsupervised-learning.html#cb72-17"></a><span class="co"># note that this error may differ from the tutorial because we did not set a seed</span></span>
<span id="cb72-18"><a href="unsupervised-learning.html#cb72-18"></a><span class="kw">round</span>(<span class="kw">Frobenius.loss</span>(X,fit0),<span class="dv">4</span>)</span></code></pre></div>
<p>ä½¿ç”¨è¿™äº›é¢„å…ˆè®­ç»ƒå¥½çš„æƒå€¼ä½œä¸ºåˆå§‹åŒ–ï¼Œå°†æ¢¯åº¦ä¸‹é™ç®—æ³•åº”ç”¨äºæ•´ä¸ªBNNï¼Œä»¥è·å¾—BNNé™ç»´ã€‚</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="unsupervised-learning.html#cb73-1"></a><span class="co"># calibrate full bottleneck network</span></span>
<span id="cb73-2"><a href="unsupervised-learning.html#cb73-2"></a>epochs &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb73-3"><a href="unsupervised-learning.html#cb73-3"></a>batch_size &lt;-<span class="st"> </span><span class="kw">nrow</span>(X)</span>
<span id="cb73-4"><a href="unsupervised-learning.html#cb73-4"></a>{t1 &lt;-<span class="st"> </span><span class="kw">proc.time</span>()</span>
<span id="cb73-5"><a href="unsupervised-learning.html#cb73-5"></a>  fit &lt;-<span class="st"> </span>model<span class="fl">.3</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fit</span>(<span class="kw">as.matrix</span>(X), <span class="kw">as.matrix</span>(X), <span class="dt">epochs=</span>epochs, <span class="dt">batch_size=</span>batch_size, <span class="dt">verbose=</span><span class="dv">0</span>)</span>
<span id="cb73-6"><a href="unsupervised-learning.html#cb73-6"></a><span class="kw">proc.time</span>()<span class="op">-</span>t1}</span>
<span id="cb73-7"><a href="unsupervised-learning.html#cb73-7"></a></span>
<span id="cb73-8"><a href="unsupervised-learning.html#cb73-8"></a><span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(fit[[<span class="dv">2</span>]]<span class="op">$</span>loss)), <span class="dt">y=</span><span class="kw">sqrt</span>(fit[[<span class="dv">2</span>]]<span class="op">$</span>loss<span class="op">*</span>q0), <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(<span class="kw">sqrt</span>(fit[[<span class="dv">2</span>]]<span class="op">$</span>loss<span class="op">*</span>q0))),<span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span>.<span class="dv">5</span>, <span class="dt">xlab=</span><span class="st">&#39;epochs&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Frobenius norm loss&#39;</span>, <span class="dt">main=</span><span class="kw">list</span>(<span class="st">&quot;gradient descent algorithm&quot;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>), <span class="dt">cex.lab=</span><span class="fl">1.5</span>) </span>
<span id="cb73-9"><a href="unsupervised-learning.html#cb73-9"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(<span class="fl">0.6124</span>), <span class="dt">col=</span><span class="st">&quot;orange&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>) </span>
<span id="cb73-10"><a href="unsupervised-learning.html#cb73-10"></a><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;decrease GDM&quot;</span>, <span class="st">&quot;PCA(p=2)&quot;</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">lwd=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">19</span>,<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb73-11"><a href="unsupervised-learning.html#cb73-11"></a></span>
<span id="cb73-12"><a href="unsupervised-learning.html#cb73-12"></a><span class="co"># reconstruction error (slightly differs from 0.5611 because of missing seed)</span></span>
<span id="cb73-13"><a href="unsupervised-learning.html#cb73-13"></a>fit0 &lt;-<span class="st"> </span>model<span class="fl">.3</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">predict</span>(<span class="kw">as.matrix</span>(X))</span>
<span id="cb73-14"><a href="unsupervised-learning.html#cb73-14"></a><span class="kw">round</span>(<span class="kw">Frobenius.loss</span>(X,fit0),<span class="dv">4</span>)</span>
<span id="cb73-15"><a href="unsupervised-learning.html#cb73-15"></a></span>
<span id="cb73-16"><a href="unsupervised-learning.html#cb73-16"></a><span class="co"># read off the bottleneck activations</span></span>
<span id="cb73-17"><a href="unsupervised-learning.html#cb73-17"></a>encoder &lt;-<span class="st"> </span><span class="kw">keras_model</span>(<span class="dt">inputs=</span>model<span class="fl">.3</span><span class="op">$</span>input, <span class="dt">outputs=</span><span class="kw">get_layer</span>(model<span class="fl">.3</span>, <span class="st">&#39;Bottleneck&#39;</span>)<span class="op">$</span>output)</span>
<span id="cb73-18"><a href="unsupervised-learning.html#cb73-18"></a>y&lt;-<span class="st"> </span><span class="kw">predict</span>(encoder,<span class="kw">as.matrix</span>(X))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:gda"></span>
<img src="plots/5/gda.png" alt="é‡æ„è¯¯å·®å›¾" width="60%"  />
<p class="caption">
Figure 5.8: é‡æ„è¯¯å·®å›¾
</p>
</div>
<p>æˆ‘ä»¬è¯´æ˜äº†<span class="math inline">\(\mathbf{F}\)</span>èŒƒæ•°æŸå¤±å‡½æ•°åœ¨è¶…è¿‡10,000æ¬¡è¿­ä»£æ—¶çš„ä¸‹é™è¿‡ç¨‹ã€‚åœ¨å¤§çº¦2000æ¬¡è¿­ä»£åï¼ŒæŸå¤±ä½äº<span class="math inline">\(p=2\)</span>ä¸ªä¸»æˆåˆ†çš„PCA(å›¾<a href="unsupervised-learning.html#fig:gda">5.8</a>ä¸­æ©™è‰²çº¿åœ¨æ°´å¹³0.6124å¤„)ã€‚10,000æ¬¡è¿­ä»£åçš„æœ€ç»ˆé‡æ„è¯¯å·®ä¸º0.5428ã€‚</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="unsupervised-learning.html#cb74-1"></a><span class="co"># note that we may need sign switches to make it comparable to PCA</span></span>
<span id="cb74-2"><a href="unsupervised-learning.html#cb74-2"></a>y0 &lt;-<span class="st"> </span><span class="kw">max</span>(<span class="kw">abs</span>(y))<span class="op">*</span><span class="fl">1.1</span></span>
<span id="cb74-3"><a href="unsupervised-learning.html#cb74-3"></a><span class="kw">plot</span>(<span class="dt">x=</span>y[,<span class="dv">1</span>], <span class="dt">y=</span>y[,<span class="dv">2</span>], <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span>y0,y0), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span>y0,y0), <span class="dt">ylab=</span><span class="st">&quot;2nd bottleneck neuron&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;1st bottleneck neuron&quot;</span>, <span class="dt">main=</span><span class="kw">list</span>(<span class="st">&quot;bottleneck neural network autoencoder&quot;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>), <span class="dt">cex.lab=</span><span class="fl">1.5</span>)</span>
<span id="cb74-4"><a href="unsupervised-learning.html#cb74-4"></a>dat0 &lt;-<span class="st"> </span>y[<span class="kw">which</span>(d.data<span class="op">$</span>tau<span class="op">&lt;</span><span class="dv">21</span>),]</span>
<span id="cb74-5"><a href="unsupervised-learning.html#cb74-5"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0[,<span class="dv">1</span>], <span class="dt">y=</span>dat0[,<span class="dv">2</span>], <span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb74-6"><a href="unsupervised-learning.html#cb74-6"></a>dat0 &lt;-<span class="st"> </span>y[<span class="kw">which</span>(d.data<span class="op">$</span>tau<span class="op">&lt;</span><span class="dv">17</span>),]</span>
<span id="cb74-7"><a href="unsupervised-learning.html#cb74-7"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0[,<span class="dv">1</span>], <span class="dt">y=</span>dat0[,<span class="dv">2</span>], <span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb74-8"><a href="unsupervised-learning.html#cb74-8"></a><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;tau&gt;=21&quot;</span>, <span class="st">&quot;17&lt;=tau&lt;21&quot;</span>, <span class="st">&quot;tau&lt;17 (sports car)&quot;</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">lwd=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">20</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:bnns"></span>
<img src="plots/5/bnns.png" alt="BNN" width="60%"  />
<p class="caption">
Figure 5.9: BNN
</p>
</div>
<p>å›¾<a href="unsupervised-learning.html#fig:bnns">5.9</a>ä¸ºå¯¹æ ·æœ¬<span class="math inline">\((n=475)\)</span>çš„åˆ†ç±»æ•ˆæœï¼Œä¸PCAï¼ˆæ—‹è½¬ï¼‰å¾ˆåƒã€‚</p>
<div class="figure" style="text-align: center"><span id="fig:BPcamparison"></span>
<img src="plots/5/BPcamparison.png" alt="BNNä¸PCAé‡æ„è¯¯å·®å¯¹æ¯”å›¾" width="60%"  />
<p class="caption">
Figure 5.10: BNNä¸PCAé‡æ„è¯¯å·®å¯¹æ¯”å›¾
</p>
</div>
<p>ç”±å›¾<a href="unsupervised-learning.html#fig:BPcamparison">5.10</a>å¾—å‡ºç»“è®ºï¼šä¸¤ç§æ–¹æ³•éƒ½å¾—åˆ°äº†ç›¸ä¼¼çš„ç»“æœã€‚ä½†åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒBNNçš„é‡æ„è¯¯å·®è¾ƒå°ã€‚åœ¨å°‘æ•°æƒ…å†µä¸‹ï¼ŒBNNå¯ä»¥å¾—åˆ°æ›´å¥½çš„é‡å»ºç»“æœ(å³ä¸‹è§’çš„æ©™è‰²ç‚¹)ã€‚
é’ˆå¯¹è¿™ä¸ªä¾‹å­è€Œè¨€ï¼Œå±äºä½ç»´æ•°çš„é—®é¢˜ï¼Œä¸»æˆåˆ†åˆ†æé€šå¸¸å°±å¯ä»¥äº†ï¼Œå› ä¸ºéçº¿æ€§çš„éƒ¨åˆ†å¹¶æ²¡æœ‰å‘æŒ¥å…³é”®ä½œç”¨ã€‚</p>
</div>
</div>
<div id="k-means-clustering" class="section level2">
<h2><span class="header-section-number">5.4</span> K-means clustering</h2>
<p>K-meansèšç±»æ˜¯ä¸€ç§åŸºäºè´¨å¿ƒï¼ˆcentroid-basedï¼‰çš„èšç±»æ–¹æ³•ï¼Œå®ƒå°†<span class="math inline">\(n\)</span>ä¸ªæ ·æœ¬ç‚¹<span class="math inline">\(\mathbf{x}_i\in\mathcal{X}\subset\mathbb{R}^q\)</span>åˆ’åˆ†ä¸º<span class="math inline">\(K\)</span>ä¸ªä¸ç›¸äº¤çš„ç±»:<span class="math display">\[\mathcal{C}_K:\mathbb{R}^q\rightarrow\mathcal{K}=\{1,\ldots,K\},~~\mathbf{x}\mapsto\mathcal{C}_K(\mathbf{x})\]</span>ï¼Œä»¥ä¸Šç»™å‡ºäº†å¯¹ç‰¹å¾ç©ºé—´<span class="math inline">\(\mathcal{X}\)</span>çš„ä¸€ä¸ªåˆ†å‰²<span class="math inline">\((C_1,\ldots,C_K)\)</span>ï¼Œå…¶ä¸­<span class="math display">\[C_k=\{\mathbf{x}\in\mathcal{X};\mathcal{C}_K(\mathbf{x})=k\}\]</span></p>
<p>ç¡®å®š<span class="math inline">\(\mathcal{C}_K\)</span>çš„åŸåˆ™æ˜¯ä½¿æ€»ç±»å†…å·®å¼‚æœ€å°ï¼Œè¿™å¯ä»¥è½¬åŒ–ä¸ºè®¡ç®—ä½¿ç±»å†…ç¦»å·®å¹³æ–¹å’Œæ€»å’Œæœ€å°çš„ä¸€ä¸ªåˆ†å‰²ï¼Œæ‰€æ„é€ çš„ç›®æ ‡å‡½æ•°ä¸º ï¼š
<span class="math display">\[\underset{(C_1,\ldots,C_K)}{\arg \min}\sum_{k=1}^K\sum_{\mathbf{x}_i\in C_k\cap\mathcal{X}}d(\mathbf{\mu}_k,\mathbf{x}_i)=\underset{(C_1,\ldots,C_K)}{\arg \min}\sum_{k=1}^K\sum_{\mathbf{x}_i\in C_k\cap\mathcal{X}}||\mathbf{\mu}_k-\mathbf{x}_i||_2^2\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(\mathbf{\mu}_k\)</span>ä¸ºç±»å‡å€¼å‘é‡ï¼Œå› æ­¤ç›®æ ‡å‡½æ•°è¡¡é‡äº†ç±»å†…æ ·æœ¬ç‚¹å›´ç»•ç±»å‡å€¼å‘é‡çš„ç´§å¯†ç¨‹åº¦ï¼Œå…¶å€¼è¶Šå°æ„å‘³ç€ç±»å†…æ ·æœ¬ç›¸ä¼¼åº¦è¶Šé«˜ï¼Œèšç±»æ•ˆæœè¶Šå¥½ã€‚ä½†æ˜¯ä¸Šè¿°ç›®æ ‡å‡½æ•°å¹¶ä¸å®¹æ˜“æ‰¾åˆ°æœ€ä¼˜è§£ï¼Œè¿™éœ€è¦è€ƒè™‘<span class="math inline">\(n\)</span>ä¸ªæ ·æœ¬ç‚¹æ‰€æœ‰å¯èƒ½çš„ç±»åˆ’åˆ†ï¼Œå› æ­¤K-meansç®—æ³•é‡‡ç”¨äº†è´ªå¿ƒç­–ç•¥ï¼Œé€šè¿‡è¿­ä»£ä¼˜åŒ–æ¥è¿‘ä¼¼æ±‚è§£ä¸Šè¿°ç›®æ ‡å‡½æ•°ã€‚</p>
<p>K-meansç®—æ³•:</p>
<ol style="list-style-type: decimal">
<li><p>é€‰æ‹©åˆå§‹èšç±»ä¸­å¿ƒ<span class="math inline">\(\mathbf{\mu}_k^{(0)}\)</span>å’Œèšç±»ä¸ªæ•°<span class="math inline">\(K\)</span>ï¼›</p></li>
<li><p>è¿­ä»£(ç»ˆæ­¢æ¡ä»¶ï¼šé™¤éç±»å‡å€¼å‘é‡<span class="math inline">\(\mathbf{\mu}_k^{(t-1)}\)</span>ä¸å†æ›´æ–°æˆ–è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°)</p>
<p>(1)è®¡ç®—<span class="math inline">\(n\)</span>ä¸ªæ ·æœ¬ç‚¹<span class="math inline">\(x_i\)</span>ä¸å‰ä¸€è½®å‡å€¼å‘é‡<span class="math inline">\(\mathbf{\mu}_k^{(t)}\)</span>çš„è·ç¦»ï¼Œæ ¹æ®è·ç¦»æœ€è¿‘åŸåˆ™é‡æ–°åˆ†é…æ‰€æœ‰æ ·æœ¬ç‚¹ï¼Œå³<span class="math display">\[C_k^{(t)}(x_i)=\underset{\mathbf{k}\in\mathcal{K}}{\arg\min}||\mathbf{\mu}_k^{(t-1)}-\mathbf{x}_i||_2^2\]</span>
(2)åŸºäº<span class="math inline">\(C_k^{(t)}\)</span>æ›´æ–°ç±»å‡å€¼å‘é‡<span class="math inline">\(\mathbf{\mu}_k^{(t)}\)</span></p></li>
</ol>
<p>K-meansä¸­å­˜åœ¨çš„é—®é¢˜</p>
<ol style="list-style-type: decimal">
<li><p>å¯¹åˆå§‹èšç±»ä¸­å¿ƒæ•æ„Ÿã€‚é€‰æ‹©ä¸åŒçš„èšç±»ä¸­å¿ƒä¼šäº§ç”Ÿä¸åŒçš„èšç±»ç»“æœå’Œä¸åŒçš„å‡†ç¡®ç‡ï¼›è‹¥éšæœºæŒ‡å®šåˆå§‹èšç±»ä¸­å¿ƒï¼Œå½“åˆå§‹æŒ‡å®šçš„ä¸¤ä¸ªèšç±»ä¸­å¿ƒåœ¨åŒä¸€ç±»ä¸­æˆ–å¾ˆæ¥è¿‘ï¼Œèšç±»ç»“æœå¾ˆéš¾åŒºåˆ†ã€‚æ­¤å¤„å¯ä»¥ä½¿ç”¨ä¸€ç§ä¼˜åŒ–ç®—æ³•ï¼šå…ˆæŒ‡å®šk=2æ‰§è¡Œk-means(åˆå§‹èšç±»ä¸­å¿ƒéšæœºæŒ‡å®š)ï¼Œç»“æœå¾—åˆ°ä¸¤ä¸ªèšç±»ä¸­å¿ƒï¼ŒæŠŠå®ƒä»¬ä½œä¸ºk=3æ—¶çš„å…¶ä¸­ä¸¤ä¸ªåˆå§‹èšç±»ä¸­å¿ƒï¼Œå‰©ä¸‹ä¸€ä¸ªåˆå§‹èšç±»ä¸­å¿ƒéšæœºæŒ‡å®š(å¯ä»¥ä½¿ç”¨åˆ—å‡å€¼)ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p></li>
<li><p>K-meansèšç±»ç”±äºä½¿ç”¨ç±»å‡å€¼å‘é‡ä½œä¸ºèšç±»ä¸­å¿ƒï¼Œå› æ­¤å¯¹ç¦»ç¾¤ç‚¹éå¸¸æ•æ„Ÿ</p></li>
<li><p>å› ä¸ºK-meansç®—æ³•ä¸»è¦é‡‡ç”¨æ¬§å¼è·ç¦»å‡½æ•°åº¦é‡ç±»é—´ç›¸ä¼¼åº¦ï¼Œå¹¶ä¸”é‡‡ç”¨è¯¯å·®å¹³æ–¹å’Œä½œä¸ºç›®æ ‡å‡½æ•°ï¼Œå› æ­¤é€šå¸¸åªèƒ½å‘ç°æ•°æ®åˆ†å¸ƒæ¯”è¾ƒå‡åŒ€çš„çƒçŠ¶ç±»ã€‚</p></li>
</ol>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="unsupervised-learning.html#cb75-1"></a><span class="co"># initialize</span></span>
<span id="cb75-2"><a href="unsupervised-learning.html#cb75-2"></a>Kaverage &lt;-<span class="st"> </span><span class="kw">colMeans</span>(X)</span>
<span id="cb75-3"><a href="unsupervised-learning.html#cb75-3"></a>K0 &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb75-4"><a href="unsupervised-learning.html#cb75-4"></a>TWCD &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA</span>, <span class="kw">c</span>(K0))  <span class="co"># total within-cluster dissimilarity</span></span>
<span id="cb75-5"><a href="unsupervised-learning.html#cb75-5"></a>Classifier &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">1</span>, <span class="kw">c</span>(K0, <span class="kw">nrow</span>(X)))</span>
<span id="cb75-6"><a href="unsupervised-learning.html#cb75-6"></a>(TWCD[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">colSums</span>(<span class="kw">as.matrix</span>(X<span class="op">^</span><span class="dv">2</span>))))</span>
<span id="cb75-7"><a href="unsupervised-learning.html#cb75-7"></a></span>
<span id="cb75-8"><a href="unsupervised-learning.html#cb75-8"></a><span class="co"># run K-means algorithm</span></span>
<span id="cb75-9"><a href="unsupervised-learning.html#cb75-9"></a><span class="kw">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb75-10"><a href="unsupervised-learning.html#cb75-10"></a><span class="cf">for</span> (K <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>K0){ </span>
<span id="cb75-11"><a href="unsupervised-learning.html#cb75-11"></a>   <span class="cf">if</span> (K<span class="op">==</span><span class="dv">2</span>){(K_res &lt;-<span class="st"> </span><span class="kw">kmeans</span>(X,K) )}</span>
<span id="cb75-12"><a href="unsupervised-learning.html#cb75-12"></a>   <span class="cf">if</span> (K<span class="op">&gt;</span><span class="dv">2</span>){(K_res  &lt;-<span class="st"> </span><span class="kw">kmeans</span>(X,K_centers) )}</span>
<span id="cb75-13"><a href="unsupervised-learning.html#cb75-13"></a>   TWCD[K] &lt;-<span class="st"> </span><span class="kw">sum</span>(K_res<span class="op">$</span>withins)</span>
<span id="cb75-14"><a href="unsupervised-learning.html#cb75-14"></a>   Classifier[K,] &lt;-<span class="st"> </span>K_res<span class="op">$</span>cluster</span>
<span id="cb75-15"><a href="unsupervised-learning.html#cb75-15"></a>   K_centers &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA</span>, <span class="kw">c</span>(K<span class="op">+</span><span class="dv">1</span>, <span class="kw">ncol</span>(X)))</span>
<span id="cb75-16"><a href="unsupervised-learning.html#cb75-16"></a>   K_centers[K<span class="op">+</span><span class="dv">1</span>,] &lt;-<span class="st"> </span>Kaverage</span>
<span id="cb75-17"><a href="unsupervised-learning.html#cb75-17"></a>   K_centers[<span class="dv">1</span><span class="op">:</span>K,] &lt;-<span class="st"> </span>K_res<span class="op">$</span>centers </span>
<span id="cb75-18"><a href="unsupervised-learning.html#cb75-18"></a>                }</span>
<span id="cb75-19"><a href="unsupervised-learning.html#cb75-19"></a></span>
<span id="cb75-20"><a href="unsupervised-learning.html#cb75-20"></a><span class="co"># plot losses                </span></span>
<span id="cb75-21"><a href="unsupervised-learning.html#cb75-21"></a>xtitle &lt;-<span class="st"> &quot;decrease in total within-cluster dissimilarity &quot;</span></span>
<span id="cb75-22"><a href="unsupervised-learning.html#cb75-22"></a><span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>K0), <span class="dt">y=</span>TWCD, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">max</span>(TWCD)), <span class="dt">main=</span><span class="kw">list</span>(xtitle, <span class="dt">cex=</span><span class="fl">1.5</span>), <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>, <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">ylab=</span><span class="st">&quot;total within-cluster dissimilarity&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;hyperparameter K&quot;</span>, <span class="dt">cex.lab=</span><span class="fl">1.5</span>)</span>
<span id="cb75-23"><a href="unsupervised-learning.html#cb75-23"></a><span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>K0), <span class="dt">y=</span>TWCD, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">lty=</span><span class="dv">3</span>)</span>
<span id="cb75-24"><a href="unsupervised-learning.html#cb75-24"></a></span>
<span id="cb75-25"><a href="unsupervised-learning.html#cb75-25"></a><span class="co"># singular value decomposition</span></span>
<span id="cb75-26"><a href="unsupervised-learning.html#cb75-26"></a>SVD &lt;-<span class="st"> </span><span class="kw">svd</span>(<span class="kw">as.matrix</span>(X))</span>
<span id="cb75-27"><a href="unsupervised-learning.html#cb75-27"></a>pca &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb75-28"><a href="unsupervised-learning.html#cb75-28"></a>dat3 &lt;-<span class="st"> </span>d.data</span>
<span id="cb75-29"><a href="unsupervised-learning.html#cb75-29"></a>dat3<span class="op">$</span>v1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(X) <span class="op">%*%</span><span class="st"> </span>SVD<span class="op">$</span>v[,pca[<span class="dv">1</span>]]</span>
<span id="cb75-30"><a href="unsupervised-learning.html#cb75-30"></a>dat3<span class="op">$</span>v2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(X) <span class="op">%*%</span><span class="st"> </span>SVD<span class="op">$</span>v[,pca[<span class="dv">2</span>]]</span>
<span id="cb75-31"><a href="unsupervised-learning.html#cb75-31"></a></span>
<span id="cb75-32"><a href="unsupervised-learning.html#cb75-32"></a>lim0 &lt;-<span class="st"> </span><span class="dv">7</span></span>
<span id="cb75-33"><a href="unsupervised-learning.html#cb75-33"></a></span>
<span id="cb75-34"><a href="unsupervised-learning.html#cb75-34"></a><span class="kw">plot</span>(<span class="dt">x=</span>dat3<span class="op">$</span>v1, <span class="dt">y=</span>dat3<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;orange&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span>lim0,lim0), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span>lim0,lim0), <span class="dt">ylab=</span><span class="kw">paste</span>(<span class="st">&quot;principal component &quot;</span>, pca[<span class="dv">2</span>], <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),<span class="dt">xlab=</span><span class="kw">paste</span>(<span class="st">&quot;principal component &quot;</span>, pca[<span class="dv">1</span>], <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),, <span class="dt">main=</span><span class="kw">list</span>(<span class="st">&quot;K-means vs. PCA&quot;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>), <span class="dt">cex.lab=</span><span class="fl">1.5</span>)</span>
<span id="cb75-35"><a href="unsupervised-learning.html#cb75-35"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(Classifier[<span class="dv">4</span>,]<span class="op">==</span><span class="dv">4</span>),]</span>
<span id="cb75-36"><a href="unsupervised-learning.html#cb75-36"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb75-37"><a href="unsupervised-learning.html#cb75-37"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(Classifier[<span class="dv">4</span>,]<span class="op">==</span><span class="dv">1</span>),]</span>
<span id="cb75-38"><a href="unsupervised-learning.html#cb75-38"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb75-39"><a href="unsupervised-learning.html#cb75-39"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(Classifier[<span class="dv">4</span>,]<span class="op">==</span><span class="dv">3</span>),]</span>
<span id="cb75-40"><a href="unsupervised-learning.html#cb75-40"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;magenta&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb75-41"><a href="unsupervised-learning.html#cb75-41"></a><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;cluster 1&quot;</span>, <span class="st">&quot;cluster 2&quot;</span>, <span class="st">&quot;cluster 3&quot;</span>, <span class="st">&quot;cluster 4&quot;</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;magenta&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">lwd=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">20</span>))</span></code></pre></div>
</div>
<div id="k-medoids-clustering-pam" class="section level2">
<h2><span class="header-section-number">5.5</span> K-medoids clustering (PAM)</h2>
<p>K-meansç®—æ³•ä½¿ç”¨ç±»å‡å€¼å‘é‡ä½œä¸ºèšç±»ä¸­å¿ƒï¼Œå› æ­¤å¯¹ç¦»ç¾¤ç‚¹éå¸¸æ•æ„Ÿï¼Œå¦‚æœå…·æœ‰æå¤§å€¼ï¼Œå¯èƒ½å¤§å¹…åº¦åœ°æ‰­æ›²æ•°æ®çš„åˆ†å¸ƒã€‚K-mediodsç®—æ³•ä½¿ç”¨æ ·æœ¬ç‚¹ä½œä¸ºèšç±»ä¸­å¿ƒï¼Œä¿®æ­£èšç±»ä¸­å¿ƒæ˜¯è®¡ç®—å½“å‰ç±»éèšç±»ä¸­å¿ƒç‚¹åˆ°å…¶ä»–æ‰€æœ‰ç‚¹çš„æœ€å°å€¼æ¥æ›´æ–°èšç±»ä¸­å¿ƒï¼ŒåŒæ—¶å¯ä»¥ä½¿ç”¨Manhattanè·ç¦»ï¼Œå¯ä»¥æœ‰æ•ˆå‰Šå¼±ç¦»ç¾¤ç‚¹çš„å½±å“ã€‚æœ¬ä¾‹ä¸­K-medoidsèšç±»ä½¿ç”¨Manhattanè·ç¦»,(<span class="math inline">\(L1\)</span>èŒƒå¼å¯¹ç¦»ç¾¤ç‚¹çš„æƒ©ç½šæƒé‡æ¯”æ¬§å¼è·ç¦»å°)ï¼Œç»“æœæ˜¾ç¤ºå…¶èšç±»ä¸­å¿ƒè¦æ¯”K-meansèšç±»æ›´åŠ èšé›†ä¸€äº›ã€‚</p>
<p>PAMç®—æ³•ï¼š</p>
<ol style="list-style-type: decimal">
<li><p>é€‰æ‹©åˆå§‹èšç±»ä¸­å¿ƒ<span class="math inline">\(c_1,c_2,\ldots,c_k\in\mathcal{X}\)</span>å’Œèšç±»ä¸ªæ•°<span class="math inline">\(K\)</span>ï¼Œè®¡ç®—<span class="math inline">\(TWCD\)</span>ï¼›
<span class="math display">\[TWCD=\sum_{k=1}^K\sum_{x_i\in{C_k}\cap\mathcal{X}}d(c_k),x_i\]</span></p></li>
<li><p>è¿­ä»£(ç»ˆæ­¢æ¡ä»¶ï¼š<span class="math inline">\(TWCD\)</span>ä¸å†å‡å°‘)</p>
<p>(1)éå†æ¯ä¸ªéèšç±»ä¸­å¿ƒ<span class="math inline">\(x_i\)</span>æ›¿æ¢èšç±»ä¸­å¿ƒç‚¹<span class="math inline">\(c_k^{t-1}\)</span>ï¼Œæ ¹æ®è·ç¦»æœ€è¿‘åŸåˆ™é‡æ–°åˆ†é…å„æ ·æœ¬ç‚¹ï¼Œè®¡ç®—<span class="math inline">\(TWCD\)</span>;</p>
<p>(2)æ ¹æ®<span class="math inline">\(TWCD\)</span>æœ€å°åŸåˆ™æ›´æ–°èšç±»ä¸­å¿ƒ<span class="math inline">\(c_k^{t}\)</span>ã€‚</p></li>
</ol>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="unsupervised-learning.html#cb76-1"></a><span class="kw">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb76-2"><a href="unsupervised-learning.html#cb76-2"></a>(K_res &lt;-<span class="st"> </span><span class="kw">pam</span>(X, <span class="dt">k=</span><span class="dv">4</span>, <span class="dt">metric=</span><span class="st">&quot;manhattan&quot;</span>, <span class="dt">diss=</span><span class="ot">FALSE</span>))</span>
<span id="cb76-3"><a href="unsupervised-learning.html#cb76-3"></a></span>
<span id="cb76-4"><a href="unsupervised-learning.html#cb76-4"></a><span class="co"># plot K-medoids versus PCA</span></span>
<span id="cb76-5"><a href="unsupervised-learning.html#cb76-5"></a><span class="kw">plot</span>(<span class="dt">x=</span>dat3<span class="op">$</span>v1, <span class="dt">y=</span>dat3<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;orange&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span>lim0,lim0), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span>lim0,lim0), <span class="dt">ylab=</span><span class="kw">paste</span>(<span class="st">&quot;principal component &quot;</span>, pca[<span class="dv">2</span>], <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),<span class="dt">xlab=</span><span class="kw">paste</span>(<span class="st">&quot;principal component &quot;</span>, pca[<span class="dv">1</span>], <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),, <span class="dt">main=</span><span class="kw">list</span>(<span class="st">&quot;K-medoids vs. PCA&quot;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>), <span class="dt">cex.lab=</span><span class="fl">1.5</span>)</span>
<span id="cb76-6"><a href="unsupervised-learning.html#cb76-6"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(K_res<span class="op">$</span>cluster<span class="op">==</span><span class="dv">4</span>),]</span>
<span id="cb76-7"><a href="unsupervised-learning.html#cb76-7"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb76-8"><a href="unsupervised-learning.html#cb76-8"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(K_res<span class="op">$</span>cluster<span class="op">==</span><span class="dv">3</span>),]</span>
<span id="cb76-9"><a href="unsupervised-learning.html#cb76-9"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb76-10"><a href="unsupervised-learning.html#cb76-10"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(K_res<span class="op">$</span>cluster<span class="op">==</span><span class="dv">2</span>),]</span>
<span id="cb76-11"><a href="unsupervised-learning.html#cb76-11"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;magenta&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb76-12"><a href="unsupervised-learning.html#cb76-12"></a><span class="kw">points</span>(<span class="dt">x=</span>dat3[K_res<span class="op">$</span>id.med,<span class="st">&quot;v1&quot;</span>],<span class="dt">y=</span>dat3[K_res<span class="op">$</span>id.med,<span class="st">&quot;v2&quot;</span>], <span class="dt">col=</span><span class="st">&quot;black&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">cex=</span><span class="dv">2</span>)</span>
<span id="cb76-13"><a href="unsupervised-learning.html#cb76-13"></a><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;cluster 1&quot;</span>, <span class="st">&quot;cluster 2&quot;</span>, <span class="st">&quot;cluster 3&quot;</span>, <span class="st">&quot;cluster 4&quot;</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;magenta&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">lwd=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">20</span>))</span></code></pre></div>
</div>
<div id="gaussian-mixture-modelsgmms" class="section level2">
<h2><span class="header-section-number">5.6</span> Gaussian mixture models(GMMs)</h2>
<p>K-meanså‡è®¾æ•°æ®ç‚¹æ˜¯çƒçŠ¶çš„ï¼ŒGMMså‡è®¾æ•°æ®ç‚¹æ˜¯å‘ˆé«˜æ–¯åˆ†å¸ƒï¼Œæä¾›äº†æ›´å¤šçš„å¯èƒ½æ€§ã€‚å¯¹<span class="math inline">\(n\)</span>ç»´æ ·æœ¬ç©ºé—´<span class="math inline">\(\mathcal{X}\)</span>ä¸­çš„éšæœºå‘é‡<span class="math inline">\(x\)</span>ï¼Œè‹¥<span class="math inline">\(x\)</span>æœä»é«˜æ–¯åˆ†å¸ƒï¼Œ<span class="math inline">\(\mu\)</span>æ˜¯<span class="math inline">\(n\)</span>ç»´å‡å€¼å‘é‡ï¼Œ<span class="math inline">\(\Sigma\)</span>æ˜¯<span class="math inline">\(n\times n\)</span> çš„åæ–¹å·®çŸ©é˜µï¼Œå…¶æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºï¼š
<span class="math display">\[p(x|\mu,\Sigma)=\frac{1}{(2\pi)^{\frac{n}{2}}|\Sigma|^{\frac{1}{2}}}e^{-\frac{1}{2}(x-\mu)\Sigma^{-1}(x-\mu)}\]</span></p>
<p>ç”±æ­¤å¯å®šä¹‰é«˜æ–¯æ··åˆåˆ†å¸ƒï¼Œè¯¥åˆ†å¸ƒç”±<span class="math inline">\(k\)</span>ä¸ªæ··åˆæˆåˆ†ç»„æˆï¼Œæ¯ä¸ªæ··åˆæˆåˆ†å¯¹åº”ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒï¼Œå…¶ä¸­<span class="math inline">\(\mu_i\)</span>ä¸<span class="math inline">\(\Sigma_i\)</span>æ˜¯ç¬¬<span class="math inline">\(i\)</span>ä¸ªé«˜æ–¯æ··åˆæˆåˆ†çš„å‚æ•°ï¼Œ<span class="math inline">\(\alpha_i\)</span>ä¸ºç›¸åº”çš„æ··åˆç³»æ•°(<span class="math inline">\(\alpha_i&gt;0,\sum_{i=1}^k\alpha_i=1\)</span>)
<span class="math display">\[p_{\mathcal{M}}=\sum_{i=1}^k\alpha_i\times p(x|\mu_i,\Sigma_i)\]</span></p>
<p>è‹¥è®­ç»ƒé›†<span class="math inline">\(D={x_1,x_2,\dots,x_m}\)</span>ç”±ä¸Šè¿°è¿‡ç¨‹ç”Ÿæˆï¼Œä»¤éšæœºå˜é‡<span class="math inline">\(z_j\in{1,2,\dots,k}\)</span>è¡¨ç¤ºç”Ÿæˆæ ·æœ¬<span class="math inline">\(x_j\)</span>çš„é«˜æ–¯æ··åˆæˆåˆ†ï¼Œæ¢å¥è¯è¯´ï¼Œæ ·æœ¬<span class="math inline">\(x_j\)</span>å±äºç¬¬<span class="math inline">\(z_j\)</span>ä¸ªé«˜æ–¯åˆ†å¸ƒï¼Œ<span class="math inline">\(z_j\)</span>çš„å…ˆéªŒæ¦‚ç‡<span class="math inline">\(p(x_j=i)=\alpha_i(i=1,2,\dots,k)\)</span>ã€‚æ ¹æ®è´å¶æ–¯å®šç†ï¼Œåˆ™<span class="math inline">\(z_j\)</span>çš„åéªŒåˆ†å¸ƒ(è¡¨ç¤ºæ ·æœ¬<span class="math inline">\(x_j\)</span>ç”±ç¬¬<span class="math inline">\(i\)</span>ä¸ªé«˜æ–¯æ··åˆæˆåˆ†ç”Ÿæˆçš„åéªŒæ¦‚ç‡<span class="math inline">\(\gamma_ji\)</span>)ä¸ºï¼š
<span class="math display">\[\gamma_{ji}=p_{\mathcal{M}}(z_j=i|x_j)=\frac{p(z_j=i)\times p_{\mathcal{M}}(x_j|z_j=i)}{p_{\mathcal{M}}(x_j)}=\frac{a_i\times p(x_j|\mu_i,\Sigma_i)}{\sum_{i=1}^k\alpha_l\times p(x_j|\mu_l,\Sigma_l)}\]</span></p>
<p>å½“é«˜æ–¯æ··åˆæˆä¸å·²çŸ¥æ—¶ï¼Œé«˜æ–¯æ··åˆèšç±»å°†æŠŠæ ·æœ¬é›†<span class="math inline">\(D\)</span>åˆ’åˆ†ä¸º<span class="math inline">\(k\)</span>ä¸ªç±»<span class="math inline">\(C=\{C_1,C_2,\dots,C_k\}\)</span>ï¼Œåˆ™æ¯ä¸ªæ ·æœ¬<span class="math inline">\(x_j\)</span>çš„ç±»æ ‡è®°<span class="math inline">\(\gamma_j\)</span>ä½œå¦‚ä¸‹ç¡®å®šï¼š
<span class="math display">\[\gamma_j=\underset{i\in\{1,2,\dots,k\}}{\arg \min}\gamma_{ji}\]</span></p>
<p>å¯¹ç»™å®šæ ·æœ¬é›†<span class="math inline">\(D\)</span>ï¼Œå¯é‡‡ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡æ±‚è§£æ¨¡å‹å‚æ•°<span class="math inline">\(\{(\alpha_i,\mu_i,\Sigma_i)|1 \le i \le k\}\)</span>ï¼Œä¼¼ç„¶å‡½æ•°
<span class="math display">\[LL(D)=ln\left(\prod_{j=1}^m p_{\mathcal{M}(x_j)}\right)=\sum_{j=1}^m ln\left(\sum_{i=1}^k \alpha_i \times p(x_j|\mu_i,\Sigma_i) \right)\]</span></p>
<p>ä»¤<span class="math inline">\(\frac{\partial{LL(D)}}{\partial(\mu_i)}=0\)</span>ï¼Œå¾—åˆ°<span class="math inline">\(\mu_i=\frac{\sum_{j=1}^{m}\gamma_{ji}x_j}{\sum_{j=1}^m\gamma_{ji}}\)</span>
ä»¤<span class="math inline">\(\frac{\partial{LL(D)}}{\partial(\Sigma_i)}=0\)</span>ï¼Œå¾—åˆ°<span class="math inline">\(\Sigma_i=\frac{\sum_{j=1}^{m}\gamma_{ji}(x_j-\mu_i)(x_j-\mu_i)^T}{\sum_{j=1}^m\gamma_{ji}}\)</span>
å¯ä»¥çœ‹åˆ°å„æ··åˆæˆåˆ†çš„å‡å€¼<span class="math inline">\(\mu_i\)</span>å’Œåæ–¹å·®é˜µ<span class="math inline">\(\Sigma_i\)</span>å¯é€šè¿‡æ ·æœ¬åŠ æƒå¹³å‡æ¥ä¼°è®¡ï¼Œæ ·æœ¬æƒé‡æ˜¯æ¯ä¸ªæ ·æœ¬å±äºè¯¥æˆåˆ†çš„åéªŒæ¦‚ç‡ã€‚</p>
<p>å¯¹äºæ··åˆç³»æ•°<span class="math inline">\(\alpha_i\)</span>ï¼Œé™¤äº†è¦æœ€å¤§åŒ–<span class="math inline">\(LL(D)\)</span>ï¼Œè¿˜éœ€è¦æ»¡è¶³<span class="math inline">\(\alpha_i&gt;0,\sum_{i=1}^k\alpha_i=1\)</span>ï¼Œå¯ä»¥ä½¿ç”¨æ‹‰æ ¼æœ—æ—¥æ¡ä»¶æå€¼æ±‚è§£ï¼Œå…¶ä¸­<span class="math inline">\(\lambda\)</span>ä¸ºæ‹‰æ ¼æœ—æ—¥ä¹˜å­ã€‚
<span class="math display">\[LLF(D)=LL(D)=\lambda\left(\sum_{i=1}^k\alpha_i-1\right)\]</span></p>
<p>ä»¤<span class="math inline">\(\frac{\partial{LLF(D)}}{\partial(\alpha_i)}=0\)</span>ï¼Œå¾—åˆ°<span class="math inline">\(\alpha_i=\frac{\sum_{j=1}^{m}\gamma_{ji}}{m}\)</span>
å¯ä»¥çœ‹åˆ°å„é«˜æ–¯æˆåˆ†<span class="math inline">\(\alpha_i\)</span>çš„æ··åˆç³»æ•°ç”±æ ·æœ¬å±äºè¯¥æˆåˆ†çš„å¹³å‡åéªŒæ¦‚ç‡ç¡®å®šã€‚</p>
<p>å› ä¸º<span class="math inline">\(z_j\in\{1,2\dots,k\}\)</span>æ˜¯éšå˜é‡(LatentVariable)ï¼Œæ— æ³•è§‚æµ‹ï¼Œä¸€èˆ¬é‡‡ç”¨EMç®—æ³•è¿›è¡Œè¿­ä»£ä¼˜åŒ–ã€‚EMç®—æ³•ï¼š</p>
<ol style="list-style-type: decimal">
<li><p>ç¡®å®šåˆå§‹é«˜æ–¯æ··åˆåˆ†å¸ƒçš„æ¨¡å‹å‚æ•°<span class="math inline">\(\{(\alpha_i,\mu_i,\Sigma_i)|1 \le i \le k\}\)</span>å’Œèšç±»ä¸ªæ•°<span class="math inline">\(K\)</span>.</p></li>
<li><p>è¿­ä»£(ç»ˆæ­¢æ¡ä»¶ï¼šä¼¼ç„¶å‡½æ•°<span class="math inline">\(LL(D)\)</span>å¢é•¿å¾ˆå°‘ç”šè‡³ä¸å†å¢é•¿æˆ–è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°)</p>
<p>(1)æ ¹æ®å‚æ•°<span class="math inline">\(\Theta^{t-1}=\{(\alpha_i^{t-1},\mu_i^{t-1},\Sigma_i^{t-1})|1 \le i \le k\}\)</span>ç¡®å®š<span class="math inline">\(\gamma_{ji}\)</span>;</p>
<p>(2)æ ¹æ®<span class="math inline">\(\gamma_{ji}\)</span>æ›´æ–°å‚æ•°<span class="math inline">\(\Theta^{t}=\{(\alpha_i^t,\mu_i^t,\Sigma_i^t)|1 \le i \le k\}\)</span></p></li>
<li><p>æœ€åæ ¹æ®<span class="math inline">\(\gamma_j=\underset{i\in\{1,2,\dots,k\}}{\arg \min}\gamma_{ji}\)</span>ç¡®å®šå„æ ·æœ¬<span class="math inline">\(x_j\)</span>æ‰€å±ç±»</p></li>
</ol>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="unsupervised-learning.html#cb77-1"></a>seed &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb77-2"><a href="unsupervised-learning.html#cb77-2"></a><span class="kw">set.seed</span>(seed)</span>
<span id="cb77-3"><a href="unsupervised-learning.html#cb77-3"></a>K_res &lt;-<span class="st"> </span><span class="kw">GMM</span>(X, <span class="dt">gaussian_comps=</span><span class="dv">4</span>, <span class="dt">dist_mode=</span><span class="st">&quot;eucl_dist&quot;</span>, <span class="dt">seed_mode=</span><span class="st">&quot;random_subset&quot;</span>, <span class="dt">em_iter=</span><span class="dv">5</span>, <span class="dt">seed=</span>seed)</span>
<span id="cb77-4"><a href="unsupervised-learning.html#cb77-4"></a><span class="kw">summary</span>(K_res)</span>
<span id="cb77-5"><a href="unsupervised-learning.html#cb77-5"></a>clust &lt;-<span class="st"> </span><span class="kw">predict_GMM</span>(X, K_res<span class="op">$</span>centroids, K_res<span class="op">$</span>covariance_matrices, K_res<span class="op">$</span>weights)<span class="op">$</span>cluster_labels</span>
<span id="cb77-6"><a href="unsupervised-learning.html#cb77-6"></a></span>
<span id="cb77-7"><a href="unsupervised-learning.html#cb77-7"></a>pred &lt;-<span class="st"> </span><span class="kw">predict_GMM</span>(X, K_res<span class="op">$</span>centroids, K_res<span class="op">$</span>covariance_matrices, K_res<span class="op">$</span>weights)</span>
<span id="cb77-8"><a href="unsupervised-learning.html#cb77-8"></a><span class="kw">names</span>(pred)</span>
<span id="cb77-9"><a href="unsupervised-learning.html#cb77-9"></a></span>
<span id="cb77-10"><a href="unsupervised-learning.html#cb77-10"></a>pred<span class="op">$</span>cluster_labels[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb77-11"><a href="unsupervised-learning.html#cb77-11"></a>pred<span class="op">$</span>cluster_proba[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,]</span>
<span id="cb77-12"><a href="unsupervised-learning.html#cb77-12"></a></span>
<span id="cb77-13"><a href="unsupervised-learning.html#cb77-13"></a>K_res<span class="op">$</span>centroids</span>
<span id="cb77-14"><a href="unsupervised-learning.html#cb77-14"></a></span>
<span id="cb77-15"><a href="unsupervised-learning.html#cb77-15"></a><span class="co"># singular value decomposition</span></span>
<span id="cb77-16"><a href="unsupervised-learning.html#cb77-16"></a>SVD &lt;-<span class="st"> </span><span class="kw">svd</span>(<span class="kw">as.matrix</span>(X))</span>
<span id="cb77-17"><a href="unsupervised-learning.html#cb77-17"></a></span>
<span id="cb77-18"><a href="unsupervised-learning.html#cb77-18"></a>pca &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb77-19"><a href="unsupervised-learning.html#cb77-19"></a>dat3 &lt;-<span class="st"> </span>d.data</span>
<span id="cb77-20"><a href="unsupervised-learning.html#cb77-20"></a>dat3<span class="op">$</span>v1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(X) <span class="op">%*%</span><span class="st"> </span>SVD<span class="op">$</span>v[,pca[<span class="dv">1</span>]]</span>
<span id="cb77-21"><a href="unsupervised-learning.html#cb77-21"></a>dat3<span class="op">$</span>v2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(X) <span class="op">%*%</span><span class="st"> </span>SVD<span class="op">$</span>v[,pca[<span class="dv">2</span>]]</span>
<span id="cb77-22"><a href="unsupervised-learning.html#cb77-22"></a></span>
<span id="cb77-23"><a href="unsupervised-learning.html#cb77-23"></a>(kk1 &lt;-<span class="st"> </span>K_res<span class="op">$</span>centroids <span class="op">%*%</span><span class="st"> </span>SVD<span class="op">$</span>v[,pca[<span class="dv">1</span>]])</span>
<span id="cb77-24"><a href="unsupervised-learning.html#cb77-24"></a>(kk2 &lt;-<span class="st"> </span>K_res<span class="op">$</span>centroids <span class="op">%*%</span><span class="st"> </span>SVD<span class="op">$</span>v[,pca[<span class="dv">2</span>]])</span>
<span id="cb77-25"><a href="unsupervised-learning.html#cb77-25"></a></span>
<span id="cb77-26"><a href="unsupervised-learning.html#cb77-26"></a>lim0 &lt;-<span class="st"> </span><span class="dv">7</span></span>
<span id="cb77-27"><a href="unsupervised-learning.html#cb77-27"></a></span>
<span id="cb77-28"><a href="unsupervised-learning.html#cb77-28"></a><span class="kw">plot</span>(<span class="dt">x=</span>dat3<span class="op">$</span>v1, <span class="dt">y=</span>dat3<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;orange&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span>lim0,lim0), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span>lim0,lim0), <span class="dt">ylab=</span><span class="kw">paste</span>(<span class="st">&quot;principal component &quot;</span>, pca[<span class="dv">2</span>], <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),<span class="dt">xlab=</span><span class="kw">paste</span>(<span class="st">&quot;principal component &quot;</span>, pca[<span class="dv">1</span>], <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),, <span class="dt">main=</span><span class="kw">list</span>(<span class="st">&quot;GMM(diagonal) vs. PCA&quot;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>), <span class="dt">cex.lab=</span><span class="fl">1.5</span>)</span>
<span id="cb77-29"><a href="unsupervised-learning.html#cb77-29"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(clust<span class="op">==</span><span class="dv">0</span>),]</span>
<span id="cb77-30"><a href="unsupervised-learning.html#cb77-30"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb77-31"><a href="unsupervised-learning.html#cb77-31"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(clust<span class="op">==</span><span class="dv">3</span>),]</span>
<span id="cb77-32"><a href="unsupervised-learning.html#cb77-32"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb77-33"><a href="unsupervised-learning.html#cb77-33"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(clust<span class="op">==</span><span class="dv">1</span>),]</span>
<span id="cb77-34"><a href="unsupervised-learning.html#cb77-34"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;magenta&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb77-35"><a href="unsupervised-learning.html#cb77-35"></a><span class="kw">points</span>(<span class="dt">x=</span>kk1,<span class="dt">y=</span>kk2, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">cex=</span><span class="dv">2</span>)</span>
<span id="cb77-36"><a href="unsupervised-learning.html#cb77-36"></a><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;cluster 1&quot;</span>, <span class="st">&quot;cluster 2&quot;</span>, <span class="st">&quot;cluster 3&quot;</span>, <span class="st">&quot;cluster 4&quot;</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;magenta&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">lwd=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">20</span>))</span></code></pre></div>
</div>
<div id="ä¸‰ç§èšç±»æ–¹æ³•è¯„ä»·" class="section level2">
<h2><span class="header-section-number">5.7</span> ä¸‰ç§èšç±»æ–¹æ³•è¯„ä»·</h2>
<p>å›¾<a href="unsupervised-learning.html#fig:cluster-results">5.11</a>å±•ç¤ºäº†èšç±»çš„ç»“æœï¼ŒGMMsæœ€å¥½ã€‚</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="unsupervised-learning.html#cb78-1"></a><span class="kw">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb78-2"><a href="unsupervised-learning.html#cb78-2"></a><span class="co">#K-meansèšç±»(æ¬§å¼è·ç¦»)</span></span>
<span id="cb78-3"><a href="unsupervised-learning.html#cb78-3"></a>K_means &lt;-<span class="st"> </span><span class="kw">kmeans</span>(X, <span class="dv">4</span>)</span>
<span id="cb78-4"><a href="unsupervised-learning.html#cb78-4"></a><span class="co">#çš„K-medoidsèšç±»(æ›¼å“ˆé¡¿è·ç¦»)</span></span>
<span id="cb78-5"><a href="unsupervised-learning.html#cb78-5"></a>K_medoids &lt;-<span class="st"> </span><span class="kw">pam</span>(X, <span class="dt">k =</span> <span class="dv">4</span>, <span class="dt">metric =</span> <span class="st">&quot;manhattan&quot;</span>)</span>
<span id="cb78-6"><a href="unsupervised-learning.html#cb78-6"></a><span class="co">#GMMèšç±»(æ¬§å¼è·ç¦»)</span></span>
<span id="cb78-7"><a href="unsupervised-learning.html#cb78-7"></a>K_gmm &lt;-<span class="st"> </span><span class="kw">GMM</span>(X, <span class="dt">gaussian_comps =</span> <span class="dv">4</span>, <span class="dt">dist_mode =</span> <span class="st">&quot;eucl_dist&quot;</span>, </span>
<span id="cb78-8"><a href="unsupervised-learning.html#cb78-8"></a>             <span class="dt">seed_mode =</span> <span class="st">&quot;random_subset&quot;</span>, </span>
<span id="cb78-9"><a href="unsupervised-learning.html#cb78-9"></a>             <span class="dt">em_iter=</span> <span class="dv">5</span>,<span class="dt">seed =</span> <span class="dv">100</span>)</span>
<span id="cb78-10"><a href="unsupervised-learning.html#cb78-10"></a>clust &lt;-<span class="st"> </span><span class="kw">predict_GMM</span>(X, K_gmm<span class="op">$</span>centroids, </span>
<span id="cb78-11"><a href="unsupervised-learning.html#cb78-11"></a>                     K_gmm<span class="op">$</span>covariance_matrices, K_gmm<span class="op">$</span>weights)<span class="op">$</span>cluster_labels</span>
<span id="cb78-12"><a href="unsupervised-learning.html#cb78-12"></a><span class="co">#k-means</span></span>
<span id="cb78-13"><a href="unsupervised-learning.html#cb78-13"></a>cluster &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;cluster1&#39;</span>,<span class="st">&#39;cluster2&#39;</span>,<span class="st">&#39;cluster3&#39;</span>,<span class="st">&#39;cluster4&#39;</span>)</span>
<span id="cb78-14"><a href="unsupervised-learning.html#cb78-14"></a>cars &lt;-<span class="st"> </span><span class="cf">function</span>(x,y) <span class="kw">nrow</span>(dat3[<span class="kw">which</span>(y <span class="op">==</span><span class="st"> </span>x),])</span>
<span id="cb78-15"><a href="unsupervised-learning.html#cb78-15"></a>sports &lt;-<span class="st"> </span><span class="cf">function</span>(x,y) <span class="kw">nrow</span>(dat3[<span class="kw">which</span>(y <span class="op">==</span><span class="st"> </span>x <span class="op">&amp;</span><span class="st"> </span>dat3<span class="op">$</span>sports_car <span class="op">==</span><span class="st"> </span><span class="dv">1</span>),])</span>
<span id="cb78-16"><a href="unsupervised-learning.html#cb78-16"></a>K_means &lt;-<span class="st"> </span><span class="kw">cbind.data.frame</span>(cluster,</span>
<span id="cb78-17"><a href="unsupervised-learning.html#cb78-17"></a>                            <span class="st">&quot;cars&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="kw">cars</span>(K_means<span class="op">$</span>cluster,<span class="dv">2</span>),</span>
<span id="cb78-18"><a href="unsupervised-learning.html#cb78-18"></a>                                     <span class="kw">cars</span>(K_means<span class="op">$</span>cluster,<span class="dv">4</span>),</span>
<span id="cb78-19"><a href="unsupervised-learning.html#cb78-19"></a>                                     <span class="kw">cars</span>(K_means<span class="op">$</span>cluster,<span class="dv">3</span>),</span>
<span id="cb78-20"><a href="unsupervised-learning.html#cb78-20"></a>                                     <span class="kw">cars</span>(K_means<span class="op">$</span>cluster,<span class="dv">1</span>)),</span>
<span id="cb78-21"><a href="unsupervised-learning.html#cb78-21"></a>                            <span class="st">&quot;sports cars&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="kw">sports</span>(K_means<span class="op">$</span>cluster,<span class="dv">2</span>),</span>
<span id="cb78-22"><a href="unsupervised-learning.html#cb78-22"></a>                                            <span class="kw">sports</span>(K_means<span class="op">$</span>cluster,<span class="dv">4</span>),</span>
<span id="cb78-23"><a href="unsupervised-learning.html#cb78-23"></a>                                            <span class="kw">sports</span>(K_means<span class="op">$</span>cluster,<span class="dv">3</span>),</span>
<span id="cb78-24"><a href="unsupervised-learning.html#cb78-24"></a>                                            <span class="kw">sports</span>(K_means<span class="op">$</span>cluster,<span class="dv">1</span>)))</span>
<span id="cb78-25"><a href="unsupervised-learning.html#cb78-25"></a>K_medoids &lt;-<span class="st"> </span><span class="kw">cbind.data.frame</span>(cluster,</span>
<span id="cb78-26"><a href="unsupervised-learning.html#cb78-26"></a>                              <span class="st">&quot;cars&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="kw">cars</span>(K_medoids<span class="op">$</span>clustering,<span class="dv">4</span>),</span>
<span id="cb78-27"><a href="unsupervised-learning.html#cb78-27"></a>                                       <span class="kw">cars</span>(K_medoids<span class="op">$</span>clustering,<span class="dv">4</span>),</span>
<span id="cb78-28"><a href="unsupervised-learning.html#cb78-28"></a>                                       <span class="kw">cars</span>(K_medoids<span class="op">$</span>clustering,<span class="dv">2</span>),</span>
<span id="cb78-29"><a href="unsupervised-learning.html#cb78-29"></a>                                       <span class="kw">cars</span>(K_medoids<span class="op">$</span>clustering,<span class="dv">1</span>)),</span>
<span id="cb78-30"><a href="unsupervised-learning.html#cb78-30"></a>                              <span class="st">&quot;sports cars&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="kw">sports</span>(K_medoids<span class="op">$</span>clustering,<span class="dv">4</span>),</span>
<span id="cb78-31"><a href="unsupervised-learning.html#cb78-31"></a>                                              <span class="kw">sports</span>(K_medoids<span class="op">$</span>clustering,<span class="dv">3</span>),</span>
<span id="cb78-32"><a href="unsupervised-learning.html#cb78-32"></a>                                              <span class="kw">sports</span>(K_medoids<span class="op">$</span>clustering,<span class="dv">2</span>),</span>
<span id="cb78-33"><a href="unsupervised-learning.html#cb78-33"></a>                                              <span class="kw">sports</span>(K_medoids<span class="op">$</span>clustering,<span class="dv">1</span>)))</span>
<span id="cb78-34"><a href="unsupervised-learning.html#cb78-34"></a>GMMs &lt;-<span class="st"> </span><span class="kw">cbind.data.frame</span>(cluster,</span>
<span id="cb78-35"><a href="unsupervised-learning.html#cb78-35"></a>                         <span class="st">&quot;cars&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="kw">cars</span>(clust,<span class="dv">0</span>),<span class="kw">cars</span>(clust,<span class="dv">3</span>),</span>
<span id="cb78-36"><a href="unsupervised-learning.html#cb78-36"></a>                                  <span class="kw">cars</span>(clust,<span class="dv">1</span>),<span class="kw">cars</span>(clust,<span class="dv">2</span>)),</span>
<span id="cb78-37"><a href="unsupervised-learning.html#cb78-37"></a>                         <span class="st">&quot;sports cars&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="kw">sports</span>(clust,<span class="dv">0</span>),<span class="kw">sports</span>(clust,<span class="dv">3</span>),</span>
<span id="cb78-38"><a href="unsupervised-learning.html#cb78-38"></a>                                         <span class="kw">sports</span>(clust,<span class="dv">1</span>),<span class="kw">sports</span>(clust,<span class="dv">2</span>)))</span>
<span id="cb78-39"><a href="unsupervised-learning.html#cb78-39"></a>k_means &lt;-<span class="st"> </span>reshape2<span class="op">::</span><span class="kw">melt</span>(K_means, <span class="dt">id.vars =</span> <span class="st">&quot;cluster&quot;</span>,</span>
<span id="cb78-40"><a href="unsupervised-learning.html#cb78-40"></a>                          <span class="dt">variable.name =</span> <span class="st">&quot;k_means&quot;</span>)</span>
<span id="cb78-41"><a href="unsupervised-learning.html#cb78-41"></a>k_medoids &lt;-<span class="st"> </span>reshape2<span class="op">::</span><span class="kw">melt</span>(K_medoids, <span class="dt">id =</span> <span class="st">&quot;cluster&quot;</span>, </span>
<span id="cb78-42"><a href="unsupervised-learning.html#cb78-42"></a>                            <span class="dt">variable.name =</span> <span class="st">&quot;k_medoids&quot;</span>)</span>
<span id="cb78-43"><a href="unsupervised-learning.html#cb78-43"></a>GMMs &lt;-<span class="st"> </span>reshape2<span class="op">::</span><span class="kw">melt</span>(GMMs, <span class="dt">id =</span> <span class="st">&quot;cluster&quot;</span>, <span class="dt">variable.name =</span> <span class="st">&quot;GMMs&quot;</span>)</span>
<span id="cb78-44"><a href="unsupervised-learning.html#cb78-44"></a><span class="co">#ç»˜åˆ¶ä¸‰ç§èšç±»æ–¹æ³•èšç±»ç»“æœä¸­è·‘è½¦æ ·æœ¬ä¸çœŸå®è·‘è½¦æ ·æœ¬å¯¹æ¯”å›¾</span></span>
<span id="cb78-45"><a href="unsupervised-learning.html#cb78-45"></a>myggplot &lt;-<span class="st"> </span><span class="cf">function</span>(mydf,myxcol,myycol,myfill) {</span>
<span id="cb78-46"><a href="unsupervised-learning.html#cb78-46"></a>   ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="dt">data=</span>mydf,<span class="kw">aes</span>(<span class="dt">x =</span> {{myxcol}},</span>
<span id="cb78-47"><a href="unsupervised-learning.html#cb78-47"></a>                                 <span class="dt">y =</span> {{myycol}},</span>
<span id="cb78-48"><a href="unsupervised-learning.html#cb78-48"></a>                                 <span class="dt">fill =</span> {{myfill}}))<span class="op">+</span></span>
<span id="cb78-49"><a href="unsupervised-learning.html#cb78-49"></a><span class="st">      </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)<span class="op">+</span></span>
<span id="cb78-50"><a href="unsupervised-learning.html#cb78-50"></a><span class="st">      </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> value),</span>
<span id="cb78-51"><a href="unsupervised-learning.html#cb78-51"></a>                <span class="dt">position =</span> <span class="kw">position_dodge</span>((<span class="dv">1</span>)),</span>
<span id="cb78-52"><a href="unsupervised-learning.html#cb78-52"></a>                <span class="dt">size =</span> <span class="dv">3</span>,</span>
<span id="cb78-53"><a href="unsupervised-learning.html#cb78-53"></a>                <span class="dt">vjust =</span> <span class="fl">-0.5</span>)<span class="op">+</span></span>
<span id="cb78-54"><a href="unsupervised-learning.html#cb78-54"></a><span class="st">      </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb78-55"><a href="unsupervised-learning.html#cb78-55"></a>            <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb78-56"><a href="unsupervised-learning.html#cb78-56"></a>            <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb78-57"><a href="unsupervised-learning.html#cb78-57"></a>            <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb78-58"><a href="unsupervised-learning.html#cb78-58"></a>            <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>())<span class="op">+</span></span>
<span id="cb78-59"><a href="unsupervised-learning.html#cb78-59"></a><span class="st">      </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;number&quot;</span>)<span class="op">+</span></span>
<span id="cb78-60"><a href="unsupervised-learning.html#cb78-60"></a><span class="st">      </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">250</span>)</span>
<span id="cb78-61"><a href="unsupervised-learning.html#cb78-61"></a>   </span>
<span id="cb78-62"><a href="unsupervised-learning.html#cb78-62"></a>}</span>
<span id="cb78-63"><a href="unsupervised-learning.html#cb78-63"></a><span class="co">#ç»„åˆå›¾å½¢</span></span>
<span id="cb78-64"><a href="unsupervised-learning.html#cb78-64"></a><span class="kw">multiplot</span>(<span class="kw">myggplot</span>(k_means,cluster,value,k_means),</span>
<span id="cb78-65"><a href="unsupervised-learning.html#cb78-65"></a>          <span class="kw">myggplot</span>(k_medoids,cluster,value,k_medoids),</span>
<span id="cb78-66"><a href="unsupervised-learning.html#cb78-66"></a>          <span class="kw">myggplot</span>(GMMs,cluster,value,GMMs))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:cluster-results"></span>
<img src="plots/5/cluster.png" alt="èšç±»æ¯”è¾ƒ" width="60%"  />
<p class="caption">
Figure 5.11: èšç±»æ¯”è¾ƒ
</p>
</div>
</div>
<div id="t-sne" class="section level2">
<h2><span class="header-section-number">5.8</span> t-SNE</h2>
<p><strong>ç®€ä»‹</strong></p>
<p><strong>tåˆ†å¸ƒ-éšæœºé‚»è¿‘åµŒå…¥</strong>(t-SNE, t-distributed stochastic neighbor embedding)ç”± Laurens van der Maatenå’ŒGeoffrey Hintonåœ¨2008å¹´æå‡ºã€‚t-SNEæœ¬è´¨æ˜¯ä¸€ç§åµŒå…¥æ¨¡å‹ï¼Œèƒ½å¤Ÿå°†é«˜ç»´ç©ºé—´ä¸­çš„æ•°æ®æ˜ å°„åˆ°ä½ç»´ç©ºé—´ä¸­ï¼Œå¹¶ä¿ç•™æ•°æ®é›†çš„å±€éƒ¨ç‰¹æ€§ã€‚</p>
<p><strong>åŸºæœ¬åŸç†</strong></p>
<p>t-SNEå°†æ•°æ®ç‚¹ä¹‹é—´çš„<strong>ç›¸ä¼¼åº¦è½¬åŒ–ä¸ºæ¡ä»¶æ¦‚ç‡</strong>ï¼Œ<strong>åŸå§‹ç©ºé—´</strong>ä¸­æ•°æ®ç‚¹çš„ç›¸ä¼¼åº¦ç”±<strong>é«˜æ–¯è”åˆåˆ†å¸ƒ</strong>è¡¨ç¤ºï¼Œ<strong>åµŒå…¥ç©ºé—´</strong>ä¸­æ•°æ®ç‚¹çš„ç›¸ä¼¼åº¦ç”±<strong>tåˆ†å¸ƒ</strong>è¡¨ç¤ºã€‚</p>
<p>å°†åŸå§‹ç©ºé—´å’ŒåµŒå…¥ç©ºé—´çš„è”åˆæ¦‚ç‡åˆ†å¸ƒçš„<strong>KLæ•£åº¦</strong>ä½œä¸ºæŸå¤±å‡½æ•°(loss function)ï¼Œè¯„ä¼°åµŒå…¥æ•ˆæœçš„å¥½åã€‚é€šè¿‡<strong>æ¢¯åº¦ä¸‹é™ç®—æ³•</strong>æœ€å°åŒ–æŸå¤±å‡½æ•°ï¼Œæœ€ç»ˆè·å¾—æ”¶æ•›ç»“æœã€‚</p>
<p><strong>å…·ä½“è¿‡ç¨‹</strong></p>
<ol style="list-style-type: decimal">
<li><p><strong>åŸå§‹ç©ºé—´</strong><br />
æ„å»ºä¸€ä¸ªé«˜ç»´å¯¹è±¡é—´çš„æ¦‚ç‡åˆ†å¸ƒï¼Œä½¿å¾—ç›¸ä¼¼çš„å¯¹è±¡æœ‰æ›´é«˜çš„æ¦‚ç‡è¢«é€‰æ‹©ï¼Œè€Œä¸ç›¸ä¼¼çš„å¯¹è±¡æœ‰è¾ƒä½çš„æ¦‚ç‡è¢«é€‰æ‹©ã€‚<span class="math inline">\(q\)</span>ç»´ç©ºé—´ä¸­ç»™å®šä¸€ç»„æ•°æ®<span class="math inline">\(x_1,â€¦,x_n\)</span>ã€‚<br />
å®šä¹‰æ¡ä»¶æ¦‚ç‡ï¼š
<span class="math display">\[
q_{j|i}=\frac{exp\left\{-\frac{1}{2\sigma_i^2}||x_i-x_j||_2^2\right\}}{\sum_{k\ne i}exp\left\{-\frac{1}{2\sigma_i^2}||x_i-x_j||_2^2\right\}},\ for\ i\ne j
\]</span>
å®šä¹‰è”åˆæ¦‚ç‡åˆ†å¸ƒï¼š
<span class="math display">\[
q_{i,j}=\frac{1}{2n}(q_{j|i}+q_{i|j}),\ for\ i\ne j
\]</span>
æ­¤å¼æ—¢ä¿è¯äº†å¯¹ç§°æ€§ï¼Œåˆä½¿å¾—<span class="math inline">\(\sum_jq_{i,j}&gt;\frac{1}{2n}\)</span>for all <span class="math inline">\(i\)</span><br />
<strong>å›°æƒ‘åº¦(Perplexity)</strong><br />
<span class="math inline">\(\sigma_i\)</span>çš„é€‰æ‹©å¿…é¡»æ»¡è¶³ï¼šåœ¨æ•°æ®å¯†é›†çš„åœ°æ–¹è¦å°ï¼Œæ•°æ®ç¨€ç–çš„åœ°æ–¹è¦å¤§ã€‚<br />
å¯¹äº<span class="math inline">\(\sigma_i\)</span>ï¼Œä¸€ä¸ªå¥½çš„åˆ†é…åº”ä½¿å¾—å›°æƒ‘åº¦ä¸ºå¸¸æ•°ã€‚
<span class="math display">\[
Perp(q_{.|i})=exp\left\{H(q_{.|i})\right\}=exp\left\{-\sum_{j\ne i}q_{j|i}log_2(q_{j|i})\right\} 
\]</span>
å›°æƒ‘åº¦å¯ç†è§£ä¸ºå¯¹æ¯ä¸ªç‚¹é‚»å±…æ•°é‡çš„çŒœæµ‹ï¼Œå¯¹æœ€ç»ˆæˆå›¾æœ‰ç€å¤æ‚çš„å½±å“ã€‚ä½å›°æƒ‘åº¦å¯¹åº”çš„æ˜¯å±€éƒ¨è§†è§’ï¼›é«˜å›°æƒ‘åº¦å¯¹åº”çš„æ˜¯å…¨å±€è§†è§’ã€‚</p></li>
<li><p><strong>åµŒå…¥ç©ºé—´</strong><br />
åœ¨<span class="math inline">\(p\)</span>ç»´ç©ºé—´ä¸­(<span class="math inline">\(p&lt;q\)</span>)æ‰¾åˆ°ä¸€ç»„æ•°æ®ç‚¹<span class="math inline">\(y_1,â€¦,y_n\)</span>ï¼Œä½¿å¾—è¿™ç»„æ•°æ®ç‚¹æ„å»ºçš„è”åˆæ¦‚ç‡åˆ†å¸ƒ<span class="math inline">\(p\)</span>å°½å¯èƒ½åœ°ä¸é«˜ç»´ç©ºé—´ä¸­çš„è”åˆæ¦‚ç‡åˆ†å¸ƒ<span class="math inline">\(q\)</span>ç›¸ä¼¼ã€‚
<span class="math display">\[
p_{i,j}=\frac{(1+||y_i-y_j||_2^2)^{-1}}{\sum_{k\ne l}(1+||y_k-y_l||_2^2)^{-1}},\ for\ i\ne j
\]</span>
<strong>t(1)åˆ†å¸ƒçš„é€‰æ‹©</strong>ï¼šè§£å†³æ‹¥æŒ¤é—®é¢˜ï¼ˆé«˜ç»´ç©ºé—´ä¸­åˆ†ç¦»çš„ç°‡ï¼Œåœ¨ä½ç»´ä¸­è¢«åˆ†çš„ä¸æ˜æ˜¾ï¼‰</p>
<div class="figure" style="text-align: center"><span id="fig:tdist"></span>
<img src="plots/5/t-distribution.png" alt="t-distribution" width="60%"  />
<p class="caption">
Figure 5.12: t-distribution
</p>
</div>
<p>å›¾<a href="unsupervised-learning.html#fig:tdist">5.12</a>å±•ç¤ºäº†ä¸åŒè‡ªç”±åº¦ä¸‹çš„tåˆ†å¸ƒçš„å¯†åº¦å‡½æ•°å›¾åƒï¼Œå¯ä»¥çœ‹å‡ºï¼Œè‡ªç”±åº¦è¶Šå°ï¼Œtåˆ†å¸ƒçš„å°¾éƒ¨è¶Šåšã€‚
<span class="math display">\[
p_{i,j}\approx||y_i-y_j||^{-2}_2\ for\ ||y_i-y_j||_2\rightarrow\infty 
\]</span>
é™ç»´çš„æ•ˆæœç”¨ä¸¤åˆ†å¸ƒé—´çš„KLæ•£åº¦(Kullback-Leibler divergences)åº¦é‡
<span class="math display">\[
D_{KL}(q||p)=\sum_{j=1}^Jq_jlog\frac{q_j}{p_j}
\]</span></p></li>
</ol>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="unsupervised-learning.html#cb79-1"></a><span class="kw">library</span>(tsne)</span>
<span id="cb79-2"><a href="unsupervised-learning.html#cb79-2"></a>perp =<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>) <span class="co">#å›°æƒ‘åº¦</span></span>
<span id="cb79-3"><a href="unsupervised-learning.html#cb79-3"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb79-4"><a href="unsupervised-learning.html#cb79-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>){</span>
<span id="cb79-5"><a href="unsupervised-learning.html#cb79-5"></a>    <span class="kw">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb79-6"><a href="unsupervised-learning.html#cb79-6"></a>    tsne =<span class="st"> </span><span class="kw">tsne</span>(X, <span class="dt">k=</span><span class="dv">2</span>, <span class="dt">initial_dim=</span><span class="kw">ncol</span>(X), <span class="dt">perplexity=</span>perp[i])</span>
<span id="cb79-7"><a href="unsupervised-learning.html#cb79-7"></a>    tsne1 =<span class="st"> </span>tsne[,<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>)]</span>
<span id="cb79-8"><a href="unsupervised-learning.html#cb79-8"></a>    <span class="kw">plot</span>(tsne1,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>,</span>
<span id="cb79-9"><a href="unsupervised-learning.html#cb79-9"></a>         <span class="dt">ylab=</span><span class="st">&quot;component 1&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;component 2&quot;</span>,</span>
<span id="cb79-10"><a href="unsupervised-learning.html#cb79-10"></a>         <span class="dt">main=</span><span class="kw">list</span>(<span class="kw">paste</span>(<span class="st">&quot;t-SNE with perplexity &quot;</span>, perp[i], <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)))</span>
<span id="cb79-11"><a href="unsupervised-learning.html#cb79-11"></a>    <span class="kw">points</span>(tsne1[<span class="kw">which</span>(d.data<span class="op">$</span>tau<span class="op">&lt;</span><span class="dv">21</span>),], <span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb79-12"><a href="unsupervised-learning.html#cb79-12"></a>    <span class="kw">points</span>(tsne1[<span class="kw">which</span>(d.data<span class="op">$</span>tau<span class="op">&lt;</span><span class="dv">17</span>),], <span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb79-13"><a href="unsupervised-learning.html#cb79-13"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:t-SNE"></span>
<img src="plots/5/t-SNE.png" alt="t-SNE" width="80%"  />
<p class="caption">
Figure 5.13: t-SNE
</p>
</div>
<p>å›¾<a href="unsupervised-learning.html#fig:t-SNE">5.13</a>å±•ç¤ºäº†å›°æƒ‘åº¦ï¼ˆ10-60ï¼‰å¯¹é™ç»´ç»“æœçš„å½±å“ï¼Œå¯ä»¥çœ‹å‡ºï¼Œå›°æƒ‘åº¦ä¸º30æ—¶ï¼Œé™ç»´çš„æ•ˆæœæœ€ä½³ã€‚</p>
</div>
<div id="umap" class="section level2">
<h2><span class="header-section-number">5.9</span> UMAP</h2>
<p><strong>ç®€ä»‹</strong></p>
<strong>ç»Ÿä¸€æµå½¢é€¼è¿‘ä¸æŠ•å½±</strong>(UMAP, Uniform Manifold Approximation and Projection)æ˜¯å»ºç«‹åœ¨é»æ›¼å‡ ä½•å’Œä»£æ•°æ‹“æ‰‘ç†è®ºæ¡†æ¶ä¸Šçš„æ–°çš„é™ç»´<strong>æµå½¢å­¦ä¹ æŠ€æœ¯</strong>ã€‚åœ¨å¯è§†åŒ–è´¨é‡æ–¹é¢ï¼ŒUMAPç®—æ³•ä¸t-SNEå…·æœ‰ç«äº‰ä¼˜åŠ¿ï¼Œä½†æ˜¯å®ƒä¿ç•™äº†æ›´å¤šå…¨å±€ç»“æ„ã€å…·æœ‰ä¼˜è¶Šçš„è¿è¡Œæ€§èƒ½ã€æ›´å¥½çš„å¯æ‰©å±•æ€§ã€‚
<div class="figure" style="text-align: center"><span id="fig:manifold"></span>
<img src="plots/5/manifold.png" alt="manifold" width="60%"  />
<p class="caption">
Figure 5.14: manifold
</p>
</div>
<p>å›¾<a href="unsupervised-learning.html#fig:manifold">5.14</a>ä¸­ä¸¤ä¸ªé»‘ç‚¹ï¼Œè‹¥è€ƒè™‘ç›´çº¿è·ç¦»ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªé»‘ç‚¹ä¹‹é—´è·ç¦»å¾ˆç›¸è¿‘ï¼›å¦‚æœæ”¾åˆ°æµå½¢å­¦ä¸Šï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªç‚¹è·ç¦»å°±å¾—æ²¿ç€å›¾ä¸­æ›²çº¿ç»•ä¸¤åœˆã€‚</p>
<p><strong>åŸºæœ¬åŸç†</strong></p>
<ol style="list-style-type: decimal">
<li><p>è®¡ç®—<strong>é«˜ç»´</strong>çš„<strong>æµå½¢ç»“æ„ç‰¹å¾</strong>ï¼Œç¡®å®šé«˜ç»´ç©ºé—´ä¸­å„ä¸ªç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œä»è€Œæ„é€ é«˜ç»´çš„æ•°æ®åˆ†å¸ƒç»“æ„ã€‚</p></li>
<li><p>å°†å®ƒä»¬<strong>æŠ•å½±åˆ°ä½ç»´ç©ºé—´</strong>ï¼Œæ ¹æ®é«˜ç»´ç©ºé—´ç‚¹ä¸ç‚¹ä¹‹é—´çš„ç›¸å¯¹å…³ç³»ï¼Œæå–ç‰¹å¾å€¼ï¼Œåœ¨ä½ç»´ç©ºé—´ä¸­<strong>é‡æ„</strong>è¿™ç§è·ç¦»å…³ç³»ï¼Œå¹¶è®¡ç®—ä½ç»´ç©ºé—´ä¸­å„ä¸ªç‚¹ä¹‹é—´çš„è·ç¦»ã€‚</p></li>
<li><p>ä½¿ç”¨<strong>éšæœºæ¢¯åº¦ä¸‹é™</strong>æ¥æœ€å°åŒ–è¿™äº›è·ç¦»ä¹‹é—´çš„å·®å¼‚ã€‚</p></li>
</ol>
<p><strong>å…·ä½“è¿‡ç¨‹</strong></p>
<ol style="list-style-type: decimal">
<li><p>æ„å»º<strong>é«˜ç»´ç©ºé—´</strong>çš„æ¨¡ç³Šæ‹“æ‰‘è¡¨ç¤º<br />
<span class="math inline">\(q\)</span>ç»´ç©ºé—´ä¸­ç»™å®šä¸€ç»„æ•°æ®<span class="math inline">\(x_1,â€¦,x_n\)</span>ã€‚å®šä¹‰ï¼š
<span class="math display">\[
d:dissimilarity\ measure\\
X_i=\left\{x_{i_1},â€¦,x_{i_k}\right\}:k\ nearest\ neighbors\ of\ x_i
\]</span>
å¯¹äºæ¯ä¸ª<span class="math inline">\(x_i\)</span>ï¼Œç¡®å®š<span class="math inline">\(\rho_i\)</span>å’Œ<span class="math inline">\(\sigma_i\)</span>
<span class="math display">\[
\rho_i=min\ d(x_i,x_{i_j}),1\le j\le k\\
\sum_{j=1}^kexp\left\{âˆ’\frac{d(x_i,x_{i_j})-\rho_i}{\sigma_i}\right\} =log_2k
\]</span>
<span class="math inline">\(\rho_i\)</span>æ§åˆ¶åµŒå…¥çš„ç´§å¯†ç¨‹åº¦ï¼Œå€¼è¶Šå°ç‚¹è¶Šèšé›†ï¼›<span class="math inline">\(\sigma_i\)</span>æ§åˆ¶æœ‰æ•ˆçš„åµŒå…¥é™ç»´èŒƒå›´ã€‚<br />
åˆ†å¸ƒè®¡ç®—ï¼š
<span class="math display">\[
q_{i|j}=exp\left\{âˆ’\frac{d(x_i,x_{i_j})-\rho_i}{\sigma_i}\right\}\\
q_{i,j}=q_{i|j}+q_{j|i}-q_{i|j}q_{j|i}
\]</span></p></li>
<li><p>ç®€å•åœ°ä¼˜åŒ–ä½ç»´è¡¨ç¤ºï¼Œä½¿å…¶å…·æœ‰å°½å¯èƒ½æ¥è¿‘çš„æ¨¡ç³Šæ‹“æ‰‘è¡¨ç¤ºï¼Œå¹¶ç”¨äº¤å‰ç†µæ¥åº¦é‡ã€‚<br />
ä½ç»´ç©ºé—´çš„åˆ†å¸ƒ<br />
<span class="math display">\[
p_{ij}=(1+a(y_i-y_j)^{2b})^{âˆ’1}
\]</span>
where <span class="math inline">\(a\approx1.93\)</span> and <span class="math inline">\(b\approx0.79\)</span> for default UMAP hyperparameters<br />
äº¤å‰ç†µä½œä¸ºä»£ä»·å‡½æ•°<br />
<span class="math display">\[
CE(X,Y)=\sum_i\sum_j\left\{q_{ij}(X)ln\frac{q_{ij}(X)}{p_{ij}(Y)}+(1-q_{ij}(X))ln\frac{1-q_{ij}(X)}{1-p_{ij}(Y)}\right\}
\]</span></p></li>
</ol>
<p><strong>å‚æ•°è¯´æ˜</strong></p>
<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>umap configuration parameters</th>
<th>value</th>
<th>note</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>n_neighbors</strong></td>
<td><strong>15</strong></td>
<td><strong>ç¡®å®šç›¸é‚»ç‚¹çš„æ•°é‡ï¼Œé€šå¸¸å–2-100</strong></td>
</tr>
<tr class="even">
<td><strong>n_components</strong></td>
<td><strong>2</strong></td>
<td><strong>é™ç»´çš„ç»´æ•°ï¼Œé»˜è®¤æ˜¯2</strong></td>
</tr>
<tr class="odd">
<td><strong>metric</strong></td>
<td><strong>euclidean</strong></td>
<td><strong>è·ç¦»çš„è®¡ç®—æ–¹æ³•ï¼Œå¯é€‰ï¼šeuclidean,manhattan,chebyshev,minkowski,correlation,hammingç­‰</strong></td>
</tr>
<tr class="even">
<td><strong>n_epochs</strong></td>
<td><strong>200</strong></td>
<td><strong>æ¨¡å‹è®­ç»ƒè¿­ä»£æ¬¡æ•°ã€‚æ•°æ®é‡å¤§æ—¶200ï¼Œå°æ—¶500</strong></td>
</tr>
<tr class="odd">
<td>input</td>
<td>data</td>
<td>æ•°æ®ç±»å‹ï¼Œå¦‚æœæ˜¯dataå°±ä¼šæŒ‰ç…§æ•°æ®è®¡ç®—ï¼›å¦‚æœæ˜¯distå°±ä¼šæŒ‰è·ç¦»çŸ©é˜µè®¡ç®—</td>
</tr>
<tr class="even">
<td>init</td>
<td>spectral</td>
<td>åˆå§‹åŒ–ï¼Œæœ‰ä¸‰ç§æ–¹å¼ï¼šspectral,random,è‡ªå®šä¹‰</td>
</tr>
<tr class="odd">
<td><strong>min_dist</strong></td>
<td><strong>0.1</strong></td>
<td><strong>æ§åˆ¶åµŒå…¥çš„ç´§å¯†ç¨‹åº¦ï¼Œå€¼è¶Šå°ç‚¹è¶Šèšé›†ï¼Œé»˜è®¤0.1</strong></td>
</tr>
<tr class="even">
<td>set_op_mix_ratio</td>
<td>1</td>
<td>é™ç»´è¿‡ç¨‹ä¸­ç‰¹å¾çš„ç»“åˆæ–¹å¼ï¼Œå–0-1ã€‚0ä»£è¡¨å–äº¤é›†ï¼Œ1ä»£è¡¨å–åˆé›†ï¼›ä¸­é—´å°±æ˜¯æ¯”ä¾‹</td>
</tr>
<tr class="odd">
<td>local_connectivity</td>
<td>1</td>
<td>å±€éƒ¨è¿æ¥çš„ç‚¹ä¹‹é—´å€¼ï¼Œé»˜è®¤1ï¼Œå…¶å€¼è¶Šå¤§å±€éƒ¨è¿æ¥è¶Šå¤šï¼Œå¯¼è‡´çš„ç»“æœå°±æ˜¯è¶…è¶Šå›ºæœ‰çš„æµå½¢ç»´æ•°å‡ºç°æ”¹å˜</td>
</tr>
<tr class="even">
<td>bandwidth</td>
<td>1</td>
<td>ç”¨äºæ„é€ å­é›†å‚æ•°</td>
</tr>
<tr class="odd">
<td>alpha</td>
<td>1</td>
<td>å­¦ä¹ ç‡</td>
</tr>
<tr class="even">
<td>gamma</td>
<td>1</td>
<td>å¸ƒå±€æœ€ä¼˜çš„å­¦ä¹ ç‡</td>
</tr>
<tr class="odd">
<td>negative_sample_rate</td>
<td>5</td>
<td>æ¯ä¸€ä¸ªé˜³æ€§æ ·æœ¬å¯¼è‡´çš„é˜´æ€§ç‡ã€‚å…¶å€¼è¶Šå¤§å¯¼è‡´é«˜çš„ä¼˜åŒ–ä¹Ÿå°±æ˜¯è¿‡æ‹Ÿåˆï¼Œé¢„æµ‹å‡†ç¡®åº¦ä¸‹é™ã€‚é»˜è®¤æ˜¯5</td>
</tr>
<tr class="even">
<td>a</td>
<td>NA</td>
<td></td>
</tr>
<tr class="odd">
<td>b</td>
<td>NA</td>
<td></td>
</tr>
<tr class="even">
<td><strong>spread</strong></td>
<td><strong>1</strong></td>
<td><strong>æ§åˆ¶æœ‰æ•ˆçš„åµŒå…¥é™ç»´èŒƒå›´ï¼Œä¸min_distè”åˆä½¿ç”¨</strong></td>
</tr>
<tr class="odd">
<td><strong>random_state</strong></td>
<td><strong>NA</strong></td>
<td><strong>éšæœºç§å­ï¼Œç¡®ä¿æ¨¡å‹çš„å¯é‡å¤æ€§</strong></td>
</tr>
<tr class="even">
<td>transform_state</td>
<td>NA</td>
<td>ç”¨äºæ•°å€¼è½¬æ¢æ“ä½œã€‚é»˜è®¤å€¼42</td>
</tr>
<tr class="odd">
<td>knn</td>
<td>NA</td>
<td></td>
</tr>
<tr class="even">
<td>knn_repeats</td>
<td>1</td>
<td></td>
</tr>
<tr class="odd">
<td>verbose</td>
<td>FALSE</td>
<td>æ§åˆ¶å·¥ä½œæ—¥å¿—ï¼Œé˜²æ­¢å­˜å‚¨è¿‡å¤š</td>
</tr>
<tr class="even">
<td>umap_learn_args</td>
<td>NA</td>
<td>è°ƒç”¨pythonåŸºäºumap-learnè®­ç»ƒå¥½çš„å‚æ•°</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="unsupervised-learning.html#cb80-1"></a><span class="kw">library</span>(umap)</span>
<span id="cb80-2"><a href="unsupervised-learning.html#cb80-2"></a>min_dist =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="fl">0.9</span>)</span>
<span id="cb80-3"><a href="unsupervised-learning.html#cb80-3"></a>k =<span class="st"> </span><span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">100</span>)</span>
<span id="cb80-4"><a href="unsupervised-learning.html#cb80-4"></a>sign =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>),<span class="dv">4</span>,<span class="dv">2</span>,<span class="dt">byrow =</span> F)</span>
<span id="cb80-5"><a href="unsupervised-learning.html#cb80-5"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>))</span>
<span id="cb80-6"><a href="unsupervised-learning.html#cb80-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){</span>
<span id="cb80-7"><a href="unsupervised-learning.html#cb80-7"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</span>
<span id="cb80-8"><a href="unsupervised-learning.html#cb80-8"></a>        umap.param =<span class="st"> </span>umap.defaults</span>
<span id="cb80-9"><a href="unsupervised-learning.html#cb80-9"></a>        umap.param<span class="op">$</span>n_components =<span class="st"> </span><span class="dv">2</span></span>
<span id="cb80-10"><a href="unsupervised-learning.html#cb80-10"></a>        umap.param<span class="op">$</span>random_state =<span class="st"> </span><span class="dv">100</span></span>
<span id="cb80-11"><a href="unsupervised-learning.html#cb80-11"></a>        umap.param<span class="op">$</span>min_dist =<span class="st"> </span>min_dist[i]</span>
<span id="cb80-12"><a href="unsupervised-learning.html#cb80-12"></a>        umap.param<span class="op">$</span>n_neighbors =<span class="st"> </span>k[j]</span>
<span id="cb80-13"><a href="unsupervised-learning.html#cb80-13"></a>        umap =<span class="st"> </span><span class="kw">umap</span>(X, <span class="dt">config=</span>umap.param, <span class="dt">method=</span><span class="st">&quot;naive&quot;</span>)</span>
<span id="cb80-14"><a href="unsupervised-learning.html#cb80-14"></a>        umap1 =<span class="st"> </span><span class="kw">matrix</span>()</span>
<span id="cb80-15"><a href="unsupervised-learning.html#cb80-15"></a>        umap<span class="op">$</span>layout[,<span class="dv">1</span>] =<span class="st"> </span>sign[j,<span class="dv">1</span>]<span class="op">*</span>umap<span class="op">$</span>layout[,<span class="dv">1</span>]</span>
<span id="cb80-16"><a href="unsupervised-learning.html#cb80-16"></a>        umap<span class="op">$</span>layout[,<span class="dv">2</span>] =<span class="st"> </span>sign[j,<span class="dv">2</span>]<span class="op">*</span>umap<span class="op">$</span>layout[,<span class="dv">2</span>]</span>
<span id="cb80-17"><a href="unsupervised-learning.html#cb80-17"></a>        umap1 =<span class="st"> </span>umap<span class="op">$</span>layout[,<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>)]</span>
<span id="cb80-18"><a href="unsupervised-learning.html#cb80-18"></a>        <span class="kw">plot</span>(umap1,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>,</span>
<span id="cb80-19"><a href="unsupervised-learning.html#cb80-19"></a>             <span class="dt">ylab=</span><span class="st">&quot;component 1&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;component 2&quot;</span>,</span>
<span id="cb80-20"><a href="unsupervised-learning.html#cb80-20"></a>             <span class="dt">main=</span><span class="kw">list</span>(<span class="kw">paste</span>(<span class="st">&quot;UMAP (k=&quot;</span>,k[j],<span class="st">&quot;, min_dist= &quot;</span>,min_dist[i], <span class="st">&quot;)&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)))</span>
<span id="cb80-21"><a href="unsupervised-learning.html#cb80-21"></a>        <span class="kw">points</span>(umap1[<span class="kw">which</span>(d.data<span class="op">$</span>tau<span class="op">&lt;</span><span class="dv">21</span>),], <span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb80-22"><a href="unsupervised-learning.html#cb80-22"></a>        <span class="kw">points</span>(umap1[<span class="kw">which</span>(d.data<span class="op">$</span>tau<span class="op">&lt;</span><span class="dv">17</span>),], <span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb80-23"><a href="unsupervised-learning.html#cb80-23"></a>    }</span>
<span id="cb80-24"><a href="unsupervised-learning.html#cb80-24"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:UMAP"></span>
<img src="plots/5/UMAP.png" alt="UMAP" width="80%"  />
<p class="caption">
Figure 5.15: UMAP
</p>
</div>
<p>å›¾<a href="unsupervised-learning.html#fig:UMAP">5.15</a>å±•ç¤ºäº†é™ç»´ç»“æœä»¥åŠä¸¤å‚æ•°<code>k</code>å’Œ<code>min_dist</code>å¯¹é™ç»´ç»“æœçš„å½±å“<br />
- ç«–çœ‹ï¼š<code>min_dist</code>è¶Šå¤§ï¼Œå›¾å½¢ä¸­çš„ç‚¹åˆ†æ•£åœ°è¶Šå‡åŒ€<br />
- æ¨ªçœ‹ï¼š<code>k</code>è¶Šå°ï¼Œæ•°æ®çš„æµè¡Œç»“æ„æ˜¾ç¤ºåœ°è¶Šæ˜æ˜¾</p>
</div>
<div id="som" class="section level2">
<h2><span class="header-section-number">5.10</span> SOM</h2>
<p><strong>è‡ªç»„ç»‡æ˜ å°„</strong>(Self-organizing map, SOM)æ˜¯ä¸€ç§ç«äº‰å‹ç¥ç»ç½‘ç»œï¼Œç”±è¾“å…¥å±‚å’Œç«äº‰å±‚ï¼ˆå¸¸è§2ç»´ï¼‰æ„æˆã€‚</p>
å›¾<a href="unsupervised-learning.html#fig:som-ill">5.16</a>å±•ç¤ºäº†SOMçš„ç»“æ„ã€‚
<div class="figure" style="text-align: center"><span id="fig:som-ill"></span>
<img src="plots/5/som.png" alt="SOM" width="60%"  />
<p class="caption">
Figure 5.16: SOM
</p>
</div>
<ul>
<li><p><strong>è¾“å…¥å±‚</strong>ç¥ç»å…ƒçš„æ•°é‡ç”±è¾“å…¥å‘é‡çš„ç»´åº¦å†³å®šï¼Œä¸€ä¸ªç¥ç»å…ƒå¯¹åº”ä¸€ä¸ªç‰¹å¾</p></li>
<li><p><strong>ç«äº‰å±‚</strong>çš„å¸¸è§ç»“æ„ï¼šçŸ©å½¢(Rectangular)ã€å…­è¾¹å½¢(Hexagonal)ï¼Œå‚è§å›¾<a href="unsupervised-learning.html#fig:SOM-com">5.17</a>ã€‚</p>
<div class="figure" style="text-align: center"><span id="fig:SOM-com"></span>
<img src="plots/5/som-com.png" alt="SOM-com" width="80%"  />
<p class="caption">
Figure 5.17: SOM-com
</p>
</div>
<p>ç«äº‰å±‚ç¥ç»å…ƒçš„æ•°é‡å†³å®šäº†æœ€ç»ˆæ¨¡å‹çš„ç²’åº¦ä¸è§„æ¨¡ï¼Œå¯¹æœ€ç»ˆæ¨¡å‹çš„å‡†ç¡®æ€§ä¸æ³›åŒ–èƒ½åŠ›å½±å“å¾ˆå¤§ã€‚<br />
ç»éªŒå…¬å¼ï¼š<span class="math inline">\(N\ge5\sqrt{m}\)</span>ï¼Œ<span class="math inline">\(m\)</span>ä¸ºè®­ç»ƒæ ·æœ¬æ•°</p></li>
</ul>
<p><strong>åŸºæœ¬åŸç†</strong></p>
<p>è¿ç”¨ç«äº‰å­¦ä¹ (competitive learning)ç­–ç•¥ï¼Œç«äº‰å±‚å„ç¥ç»å…ƒç«äº‰å¯¹è¾“å…¥å±‚å“åº”çš„æœºä¼šï¼Œæœ€åä»…æœ‰ä¸€ä¸ªç¥ç»å…ƒè·èƒœï¼Œä»£è¡¨å¯¹è¾“å…¥å±‚çš„åˆ†ç±»ã€‚å¦‚æ­¤è¿­ä»£ï¼Œé€æ­¥ä¼˜åŒ–ç½‘ç»œã€‚</p>
<p><strong>å…·ä½“è¿‡ç¨‹</strong></p>
<ol style="list-style-type: decimal">
<li><p><strong>åˆå§‹åŒ–</strong>ï¼šåˆå§‹åŒ–è¿æ¥æƒé‡<span class="math inline">\(\omega_{j}^{(0)}=\left(\omega_{j 1}, \ldots, \omega_{j n}\right), j=1, \ldots, N\)</span></p></li>
<li><p><strong>ç«äº‰</strong>ï¼šå¯¹äºè¾“å…¥æ ·æœ¬<span class="math inline">\(x_i\)</span>ï¼Œéå†ç«äº‰å±‚ä¸­æ¯ä¸€ä¸ªç¥ç»å…ƒï¼Œè®¡ç®—<span class="math inline">\(x_i\)</span>ä¸æ¯ä¸ªç¥ç»å…ƒçš„è¿æ¥æƒé‡<span class="math inline">\(\omega_j\)</span>ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼ˆé€šå¸¸ä½¿ç”¨æ¬§å¼è·ç¦»æˆ–å¹³æ–¹æ¬§å¼è·ç¦»ï¼‰ã€‚è·ç¦»æœ€å°çš„ç¥ç»å…ƒèŠ‚ç‚¹èƒœå‡ºï¼Œç§°ä¸ºBMN(best matching neuron)</p></li>
</ol>
<p><span class="math display">\[
j^{*}=j^{*}(i)=\underset{j \in \mathcal{J}}{\arg \min } d\left(\boldsymbol{w}_{j}, \boldsymbol{x}_{i}\right)
\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li><p><strong>åˆä½œ</strong>ï¼šè·èƒœç¥ç»å…ƒå†³å®šäº†å…´å¥‹ç¥ç»å…ƒæ‹“æ‰‘é‚»åŸŸçš„ç©ºé—´ä½ç½®ï¼Œä»è€Œä¸ºç›¸é‚»ç¥ç»å…ƒä¹‹é—´çš„åˆä½œæä¾›äº†åŸºç¡€ã€‚
ç¥ç»ç”Ÿç‰©å­¦çš„ç ”ç©¶è¡¨æ˜ï¼Œä¸€ç»„å…´å¥‹ç¥ç»å…ƒå†…å­˜åœ¨æ¨ªå‘çš„ç›¸äº’ä½œç”¨ã€‚å› æ­¤å½“ä¸€ä¸ªç¥ç»å…ƒè¢«æ¿€æ´»æ—¶ï¼Œè¿‘é‚»èŠ‚ç‚¹å¾€å¾€æ¯”è¿œç¦»çš„èŠ‚ç‚¹æ›´å…´å¥‹ã€‚å®šä¹‰é‚»åŸŸå‡½æ•°<span class="math inline">\(\theta\)</span>ï¼Œè¡¨ç¤ºè·èƒœç¥ç»å…ƒå¯¹è¿‘é‚»ç¥ç»å…ƒçš„å½±å“å¼ºå¼±ï¼Œä¹Ÿå³ä¼˜èƒœé‚»åŸŸä¸­æ¯ä¸ªç¥ç»å…ƒçš„æ›´æ–°å¹…åº¦ã€‚å¸¸è§çš„é€‰æ‹©æ˜¯é«˜æ–¯å‡½æ•°ï¼š
<span class="math display">\[
\theta\left(j^{*}(i), j ; t\right)=\exp \left\{-\frac{1}{2 \sigma(t)^{2}}\left\|j-j^{*}(i)\right\|_{2}^{2} / J^{2}\right\}
\]</span>
é‚»åŸŸåŠå¾„<span class="math inline">\(\sigma(t)\)</span>éšç€æ—¶é—´çš„æ¨ç§»è€Œå‡å°‘ã€‚<br />
è¶Šé è¿‘ä¼˜èƒœç¥ç»å…ƒï¼Œæ›´æ–°å¹…åº¦è¶Šå¤§ï¼›è¶Šè¿œç¦»ä¼˜èƒœç¥ç»å…ƒï¼Œæ›´æ–°å¹…åº¦è¶Šå°</p></li>
<li><p><strong>é€‚åº”/å­¦ä¹ </strong>ï¼šæ›´æ–°ä¼˜èƒœé‚»åŸŸå†…ç¥ç»å…ƒçš„è¿æ¥æƒé‡
<span class="math display">\[
\boldsymbol{w}_{j}^{(t)}=\boldsymbol{w}_{j}^{(t-1)}+\theta\left(j^{*}(i), j ; t\right) \alpha(t)\left(\boldsymbol{x}_{i}-\boldsymbol{w}_{j}^{(t-1)}\right)
\]</span>
å­¦ä¹ ç‡<span class="math inline">\(\alpha(t)\)</span>éšç€æ—¶é—´çš„æ¨ç§»è€Œå‡å°‘ã€‚</p></li>
<li><p><strong>è¿­ä»£</strong>ï¼šè¿”å›ç¬¬äºŒæ­¥ï¼Œè¿­ä»£è‡³æ”¶æ•›æˆ–è¾¾åˆ°è®¾å®šæ¬¡æ•°</p></li>
</ol>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="unsupervised-learning.html#cb81-1"></a><span class="kw">library</span>(kohonen)</span>
<span id="cb81-2"><a href="unsupervised-learning.html#cb81-2"></a>p =<span class="st"> </span><span class="kw">ceiling</span>(<span class="kw">sqrt</span>(<span class="dv">5</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="kw">nrow</span>(X)))) <span class="co">#æ ¹æ®ç»éªŒå…¬å¼ç¡®å®šæ­£æ–¹å½¢çš„è¾¹é•¿</span></span>
<span id="cb81-3"><a href="unsupervised-learning.html#cb81-3"></a><span class="kw">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb81-4"><a href="unsupervised-learning.html#cb81-4"></a>som1 =<span class="st"> </span><span class="kw">som</span>(<span class="kw">as.matrix</span>(X),<span class="dt">grid=</span><span class="kw">somgrid</span>(<span class="dt">xdim=</span>p,<span class="dt">ydim=</span>p,<span class="dt">topo=</span><span class="st">&quot;rectangular&quot;</span>),<span class="dt">rlen=</span><span class="dv">500</span>,<span class="dt">dist.fcts=</span><span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb81-5"><a href="unsupervised-learning.html#cb81-5"></a><span class="kw">summary</span>(som1)</span>
<span id="cb81-6"><a href="unsupervised-learning.html#cb81-6"></a><span class="kw">head</span>(som1<span class="op">$</span>unit.classif,<span class="dv">100</span>) <span class="co">#å„æ•°æ®ç‚¹çš„è·èƒœç¥ç»å…ƒ</span></span>
<span id="cb81-7"><a href="unsupervised-learning.html#cb81-7"></a><span class="kw">tail</span>(som1<span class="op">$</span>codes[[<span class="dv">1</span>]]) <span class="co">#è¿æ¥æƒé‡å‘é‡</span></span>
<span id="cb81-8"><a href="unsupervised-learning.html#cb81-8"></a><span class="kw">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb81-9"><a href="unsupervised-learning.html#cb81-9"></a>som2 =<span class="st"> </span><span class="kw">som</span>(<span class="kw">as.matrix</span>(X),<span class="dt">grid=</span><span class="kw">somgrid</span>(<span class="dt">xdim=</span>p,<span class="dt">ydim=</span>p,<span class="dt">topo=</span><span class="st">&quot;hexagonal&quot;</span>),<span class="dt">rlen=</span><span class="dv">500</span>,<span class="dt">dist.fcts=</span><span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb81-10"><a href="unsupervised-learning.html#cb81-10"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb81-11"><a href="unsupervised-learning.html#cb81-11"></a><span class="kw">plot</span>(som1,<span class="kw">c</span>(<span class="st">&quot;changes&quot;</span>))</span>
<span id="cb81-12"><a href="unsupervised-learning.html#cb81-12"></a><span class="kw">plot</span>(som1,<span class="kw">c</span>(<span class="st">&quot;counts&quot;</span>), <span class="dt">main=</span><span class="st">&quot;allocation counts to neurons&quot;</span>)</span>
<span id="cb81-13"><a href="unsupervised-learning.html#cb81-13"></a>d.data<span class="op">$</span>tau2 =<span class="st"> </span>d.data<span class="op">$</span>sports_car<span class="op">+</span><span class="kw">as.integer</span>(d.data<span class="op">$</span>tau<span class="op">&lt;</span><span class="dv">21</span>)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb81-14"><a href="unsupervised-learning.html#cb81-14"></a><span class="kw">plot</span>(som1,<span class="kw">c</span>(<span class="st">&quot;mapping&quot;</span>),<span class="dt">classif=</span><span class="kw">predict</span>(som1),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;red&quot;</span>)[d.data<span class="op">$</span>tau2], <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">main=</span><span class="st">&quot;allocation of cases to neurons&quot;</span>)</span>
<span id="cb81-15"><a href="unsupervised-learning.html#cb81-15"></a><span class="kw">plot</span>(som2,<span class="kw">c</span>(<span class="st">&quot;changes&quot;</span>))</span>
<span id="cb81-16"><a href="unsupervised-learning.html#cb81-16"></a><span class="kw">plot</span>(som2,<span class="kw">c</span>(<span class="st">&quot;counts&quot;</span>), <span class="dt">main=</span><span class="st">&quot;allocation counts to neurons&quot;</span>)</span>
<span id="cb81-17"><a href="unsupervised-learning.html#cb81-17"></a>d.data<span class="op">$</span>tau2 =<span class="st"> </span>d.data<span class="op">$</span>sports_car<span class="op">+</span><span class="kw">as.integer</span>(d.data<span class="op">$</span>tau<span class="op">&lt;</span><span class="dv">21</span>)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb81-18"><a href="unsupervised-learning.html#cb81-18"></a><span class="kw">plot</span>(som2,<span class="kw">c</span>(<span class="st">&quot;mapping&quot;</span>),<span class="dt">classif=</span><span class="kw">predict</span>(som2),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;red&quot;</span>)[d.data<span class="op">$</span>tau2], <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">main=</span><span class="st">&quot;allocation of cases to neurons&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:SOM"></span>
<img src="plots/5/som2.png" alt="SOM" width="80%"  />
<p class="caption">
Figure 5.18: SOM
</p>
</div>
<p>å›¾<a href="unsupervised-learning.html#fig:SOM">5.18</a>çš„ç¬¬ä¸€è¡Œå±•ç¤ºçš„æ˜¯çŸ©å½¢ç«äº‰å±‚è¾“å‡ºçš„é™ç»´ç»“æœï¼Œç¬¬äºŒè¡Œå±•ç¤ºçš„æ˜¯å…­è¾¹å½¢ç«äº‰å±‚è¾“å‡ºçš„é™ç»´ç»“æœï¼Œsports carsï¼ˆçº¢è‰²ï¼‰å¯ä»¥è¢«è¾ƒä¸ºæ˜æ˜¾åœ°åŒºåˆ†å¼€æ¥ã€‚</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="boosting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="rnn.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": "github"
},
"fontsettings": {
"theme": "sepia",
"family": "serif",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "fixed"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
